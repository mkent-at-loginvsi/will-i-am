"use strict";(self.webpackChunkAutomationMachine=self.webpackChunkAutomationMachine||[]).push([[990],{16990:(Ho,ge,c)=>{c.r(ge),c.d(ge,{ImageManagementModule:()=>Lo});var u=c(36895),Ve=c(151),Le=c(59890),Ee=c(82038),l=c(24006),b=c(14353),I=c(42654),v=c(90414),e=c(94650),Z=c(33615),H=c(37777),ne=c(3848);const Ye=["imageDetailsTabs"];function He(i,a){if(1&i&&(e.TgZ(0,"a",7,8),e._uU(2),e.qZA()),2&i){const t=a.$implicit,n=e.MAs(1),o=e.oxw(2);e.Q6J("routerLink",t.path)("active",n.isActive&&null==o.recipeId)("disabled",null==o.selectedEnvironment),e.xp6(2),e.Oqu(t.name)}}function We(i,a){if(1&i&&e.YNc(0,He,3,4,"a",6),2&i){const t=e.oxw();e.Q6J("ngForOf",t.tabLinks)}}function je(i,a){if(1&i&&(e.TgZ(0,"a",9),e._uU(1,"Recipe Details"),e.qZA()),2&i){const t=e.oxw();e.Q6J("routerLink",t.imageSubject.getRecipeUrl(t.recipeId))("active",!0)}}let ze=(()=>{class i{constructor(t,n,o){this.imageSubject=t,this.router=n,this.dataRepository=o,this.displayedColumns=["name","description","actions"],this.TABS={RECIPE:0,DEPLOYMENT:1,CONFIGURATION:2},this.subscription=new I.w,this.tabLinks=[{name:"Recipes",path:v.l.recipesUrl},{name:"Build Logs",path:v.l.buildsUrl},{name:"Setup",path:v.l.configurationUrl}],this.activeTabIndex=this.TABS.RECIPE,this.isLoading=!1,this.activeRoute=this.router.url}ngOnInit(){this.subscription.add(this.imageSubject.isAdConfigurationUnsaved.subscribe(n=>{this.isAdConfigurationDirty=n})),this.subscription.add(this.imageSubject.isVCenterConfigurationUnsaved.subscribe(n=>{this.isVCenterConfigurationDirty=n}));const t=this.router.events.subscribe(n=>{n instanceof b.m2&&(this.activeRoute=this.router.url)});this.subscription.add(t),this.selectedEnvironmentName="Environment is not selected",this.subscription.add(this.dataRepository.currentEnvironmentSubject.subscribe(n=>{this.selectedEnvironment=n,this.selectedEnvironmentName=n?n.name:"Environment is not selected",this.fetchCollections()})),this.subscription.add(this.imageSubject.imageCreated.subscribe(n=>{n&&null!=this.selectedEnvironment&&this.imageSubject.fetchCollections(this.selectedEnvironment.id)}))}fetchCollections(){null!=this.selectedEnvironment&&(this.isLoading=!0,this.imageSubject.fetchCollectionsIfNeeded())}ngOnDestroy(){this.subscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Z.Y),e.Y36(b.F0),e.Y36(H.Y))},i.\u0275cmp=e.Xpm({type:i,selectors:[["image-management"]],viewQuery:function(t,n){if(1&t&&e.Gf(Ye,5),2&t){let o;e.iGM(o=e.CRH())&&(n.imageDetailsTabs=o.first)}},decls:8,vars:4,consts:[["body",""],[1,"container"],[1,"col-lg-11","offset-lg-1"],["mat-tab-nav-bar","",1,"recipe-tabs"],[3,"ngIf"],["mat-tab-link","","routerLinkActive","",3,"routerLink","active",4,"ngIf"],["mat-tab-link","","routerLinkActive","",3,"routerLink","active","disabled",4,"ngFor","ngForOf"],["mat-tab-link","","routerLinkActive","",3,"routerLink","active","disabled"],["rla","routerLinkActive"],["mat-tab-link","","routerLinkActive","",3,"routerLink","active"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"nav",3),e.YNc(4,We,1,1,"ng-template",4),e.YNc(5,je,2,2,"a",5),e.qZA(),e.TgZ(6,"div"),e._UZ(7,"router-outlet"),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(4),e.Q6J("ngIf",null==n.recipeId),e.xp6(1),e.Q6J("ngIf",null!=n.recipeId),e.xp6(1),e.ekj("content-margin-top","/image-management/setup"===n.activeRoute))},directives:[ne.BU,u.O5,u.sg,b.yS,ne.Nj,b.Od,b.lC],styles:["[_nghost-%COMP%]{padding:0!important}nav.recipe-tabs[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-transform:uppercase}nav.recipe-tabs[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:none;color:#424242}.content-margin-top[_ngcontent-%COMP%]{margin-top:2rem}"]}),i})();var he=c(76970),ie=c(18748),_=c(12320),O=c(69096),Ce=c(41746),p=c(8929),V=c(92198),fe=c(24850),_e=c(38909),Be=c(46493),$e=c(56993),Ge=c(47580),Ke=c(22281),ce=c(64927);class Xe{constructor(){this.recipeSelection=new Ge.B,this.virtualMachine=new et,this.targetPlatform=new Be.K,this.credentials=new tt,this.imageCapture=new $e._,this.windowsUpdatesConfiguration=new Ke.J,this.packageList=[],this.layerList=[],this.imageSchedulingConfiguration=new ce.i}}class et{}class tt{}var A=c(46261),ve=c(90033);class nt{constructor(){this.name="",this.nameFormControl=new l.NI(this.name,[],[]),this.description="",this.descriptionFormControl=new l.NI(this.description,l.kI.compose([]))}setValidators(){this.nameFormControl.clearValidators(),this.nameFormControl.setValidators([l.kI.required])}resetDirty(){this.nameFormControl.reset(this.name),this.descriptionFormControl.reset(this.description)}get isValid(){return this.nameFormControl.valid}get isDirty(){return this.nameFormControl.dirty||this.descriptionFormControl.dirty}}var W=c(59008),C=c(37084),S=c(27969);function it(i,a){if(1&i&&e._UZ(0,"am-icon",3),2&i){const t=e.oxw();e.Q6J("iconClasses",t.icons.CARET_DOWN)}}function ot(i,a){if(1&i&&e._UZ(0,"am-icon",3),2&i){const t=e.oxw();e.Q6J("iconClasses",t.icons.CARET_RIGHT)}}function at(i,a){1&i&&e._UZ(0,"span")}let q=(()=>{class i{constructor(){this.icons=_.R.icons.fontAwesome}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["am-caret"]],inputs:{expanded:"expanded"},decls:5,vars:3,consts:[["expandedPanel",""],["collapsedPanel",""],[4,"ngIf","ngIfThen","ngIfElse"],[1,"caret",3,"iconClasses"]],template:function(t,n){if(1&t&&(e.YNc(0,it,1,1,"ng-template",null,0,e.W1O),e.YNc(2,ot,1,1,"ng-template",null,1,e.W1O),e.YNc(4,at,1,0,"span",2)),2&t){const o=e.MAs(1),r=e.MAs(3);e.xp6(4),e.Q6J("ngIf",n.expanded)("ngIfThen",o)("ngIfElse",r)}},directives:[S.b,u.O5],styles:["[_nghost-%COMP%]{display:inline-block}"]}),i})();var D=c(4859),k=c(10266),g=c(59549),P=c(44144);function rt(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(o){return e.CHM(t),e.oxw().onDeployClick(o)}),e._UZ(1,"am-icon",18),e.qZA()}if(2&i){const t=e.oxw();e.s9C("title",t.isConfigOk?null:"Missing configuration details"),e.Q6J("matTooltip","Build image")("disabled",t.recipeIsDirty||!t.isConfigOk),e.xp6(1),e.Q6J("iconClasses",t.icons.INBOX_OUT)}}function st(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Recipe name already taken "),e.qZA())}function lt(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Name is required "),e.qZA())}let Me=(()=>{class i{constructor(t){this.imageSubject=t,this.kickOffDeploy=new e.vpe,this.icons=_.R.icons.fontAwesome,this.expandOnLoad=!0,this.subscription=new I.w,this.model=new ve.e,this.viewModel=new nt}ngOnInit(){this.subscription.add(this.imageSubject.configurationLoaded.subscribe(t=>{null!=t&&t!==this.imageSubject.emptyGlobalConfiguration&&(this.isConfigOk=this.imageSubject.checkInitialConfiguration(t,!0))})),this.subscription.add(this.imageSubject.imageSelected.subscribe(t=>{t&&(this.modelClone=W.G.cloneDeep(t),this.mapModelToForm(t),this.modelClone.recipeSelection=t.recipeSelection,this.viewModel.setValidators(),this.viewModel.resetDirty(),this.mapFormControlValuesToDataModel())}))}ngAfterViewInit(){this.subscription.add(this.viewModel.nameFormControl.valueChanges.subscribe(()=>this.onInputChange())),this.subscription.add(this.viewModel.descriptionFormControl.valueChanges.subscribe(()=>this.onInputChange()))}mapModelToForm(t){this.viewModel.nameFormControl.setValue(t.recipeSelection.name),this.viewModel.name=t.recipeSelection.name,this.viewModel.descriptionFormControl.setValue(t.recipeSelection.description),this.viewModel.description=t.recipeSelection.description}mapFormControlValuesToDataModel(){if(null==this.modelClone||null==this.modelClone.recipeSelection||null==this.modelClone.recipeSelection.getRecipeId)return;const t=new ve.e;t.recipeSelection.setRecipeId(this.modelClone.recipeSelection.getRecipeId()),t.recipeSelection.name=this.viewModel.nameFormControl.value,t.recipeSelection.description=this.viewModel.descriptionFormControl.value,t.recipeSelection.isNew=this.modelClone.recipeSelection.isNew,this.model=t}get description(){return null!=this.modelClone&&null!=this.modelClone.recipeSelection&&null!=this.modelClone.recipeSelection.getRecipeId?this.modelClone.recipeSelection.getRecipeId()===O.c.Empty?"New Recipe":this.modelClone.recipeSelection.name:""}onDeployClick(t=null){t&&t.stopPropagation();const n=new _e.S;n.id=this.modelClone.recipeSelection.getRecipeId(),n.name=this.modelClone.recipeSelection.name,this.deploy({recipe:n,evt:null})}deploy(t){this.kickOffDeploy.emit(t)}onInputChange(){null==this.modelClone||null==this.modelClone.recipeSelection||null==this.modelClone.recipeSelection.getRecipeId||this.mapFormControlValuesToDataModel()}get allowSave(){return this.viewModel.isDirty&&this.viewModel.isValid}revertChanges(){this.mapModelToForm(this.modelClone),this.viewModel.resetDirty()}ngOnDestroy(){this.subscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Z.Y))},i.\u0275cmp=e.Xpm({type:i,selectors:[["recipe-head"]],inputs:{recipeIsDirty:"recipeIsDirty"},outputs:{kickOffDeploy:"kickOffDeploy"},decls:27,vars:10,consts:[["hideToggle","",1,"mat-elevation-z0",3,"expanded"],["panel",""],[1,"panel-header"],[3,"expanded"],[1,"mb-0","title"],[1,"title"],[1,"description"],[1,"action"],["mat-raised-button","","color","primary","tabindex","-1",3,"title","matTooltip","disabled","click",4,"ngIf"],[1,"container","striped",2,"background","#FFF"],[1,"row","mt-0","pointer","read-only","align-items-center","bt-1"],[1,"col-lg-3","pt-3","pb-3","br-1"],[1,"col","pt-0","pb-0"],[1,"full-width",3,"floatLabel"],["name","name","matInput","","placeholder","Name",3,"formControl"],[4,"ngIf"],["matInput","","name","Description","placeholder","Description",3,"formControl"],["mat-raised-button","","color","primary","tabindex","-1",3,"title","matTooltip","disabled","click"],[3,"iconClasses"]],template:function(t,n){if(1&t&&(e.TgZ(0,"mat-expansion-panel",0,1),e.TgZ(2,"mat-expansion-panel-header"),e.TgZ(3,"div",2),e._UZ(4,"am-caret",3),e.TgZ(5,"h4",4),e.TgZ(6,"span",5),e._uU(7,"INFO "),e.qZA(),e.TgZ(8,"span",6),e._uU(9),e.qZA(),e.qZA(),e.TgZ(10,"div",7),e.YNc(11,rt,2,4,"button",8),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"div",9),e.TgZ(13,"div",10),e.TgZ(14,"div",11),e._uU(15," Name "),e.qZA(),e.TgZ(16,"div",12),e.TgZ(17,"mat-form-field",13),e._UZ(18,"input",14),e.YNc(19,st,2,0,"mat-error",15),e.YNc(20,lt,2,0,"mat-error",15),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"div",10),e.TgZ(22,"div",11),e._uU(23," Description "),e.qZA(),e.TgZ(24,"div",12),e.TgZ(25,"mat-form-field",13),e._UZ(26,"input",16),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t){const o=e.MAs(1);e.Q6J("expanded",n.expandOnLoad),e.xp6(4),e.Q6J("expanded",o.expanded),e.xp6(5),e.Oqu(n.description),e.xp6(2),e.Q6J("ngIf",n.modelClone&&!n.modelClone.recipeSelection.isNew),e.xp6(6),e.Q6J("floatLabel","never"),e.xp6(1),e.Q6J("formControl",n.viewModel.nameFormControl),e.xp6(1),e.Q6J("ngIf",n.viewModel.nameFormControl.hasError("unique")),e.xp6(1),e.Q6J("ngIf",n.viewModel.nameFormControl.hasError("required")),e.xp6(5),e.Q6J("floatLabel","never"),e.xp6(1),e.Q6J("formControl",n.viewModel.descriptionFormControl)}},directives:[C.ib,C.yz,q,u.O5,D.lW,k.gM,S.b,g.KE,P.Nt,l.Fj,l.JJ,l.oH,g.TO],styles:["mat-expansion-panel[_ngcontent-%COMP%]{border-radius:0;border-width:0 0 1px 0;border-style:solid;border-color:#0000001f;width:100%}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]{display:inline;padding:0}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]{height:60px;width:100%;padding:0 15px 0 0;display:flex;align-items:center;cursor:pointer}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   am-caret[_ngcontent-%COMP%]{color:#9b9b9b;height:100%;padding:0 8px 0 10px;display:flex;align-items:center;cursor:pointer}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   h4.title[_ngcontent-%COMP%]{font-size:15px;text-transform:uppercase}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:12px;font-weight:300;color:#616161;text-transform:none}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{display:inline-block;font-size:12px;margin-left:auto}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .mat-raised-button[_ngcontent-%COMP%]{margin-left:12px;padding:2px;line-height:19px;min-width:23px;height:23px;outline:none}mat-expansion-panel[_ngcontent-%COMP%]   .bt-1[_ngcontent-%COMP%]{border-top:1px solid rgba(0,0,0,.125)}"]}),i})();class ct{constructor(){this.virtualMachineNameFormControl=new l.NI(this.virtualMachineName),this.cpuSocketsFormControl=new l.NI(this.cpuSockets),this.memoryFormControl=new l.NI(this.memory),this.templateFormControl=new l.NI(this.template),this.hostFormControl=new l.NI(this.host),this.storageFormControl=new l.NI(this.storage),this.networkFormControl=new l.NI(this.network),this.createFromOptionFormControl=new l.NI(this.createFromOption),this.virtualDiskFormControl=new l.NI(this.virtualDisk),this.guestOperatingSystemFormControl=new l.NI(this.guestOperatingSystem),this.guestOsFirmwareFormControl=new l.NI(this.guestOsFirmware),this.efiSecureBootFormControl=new l.NI(this.efiSecureBootEnabled)}resetDirty(){this.virtualMachineNameFormControl.reset(this.virtualMachineName),this.cpuSocketsFormControl.reset(this.cpuSockets),this.hostFormControl.reset(this.host),this.memoryFormControl.reset(this.memory),this.storageFormControl.reset(this.storage),this.networkFormControl.reset(this.network),this.createFromOptionFormControl.reset(this.createFromOption),this.virtualDiskFormControl.reset(this.virtualDisk),this.guestOperatingSystemFormControl.reset(this.guestOperatingSystem),this.templateFormControl.reset(this.template)}get isValid(){return(this.virtualMachineNameFormControl.valid||null==this.virtualMachineNameFormControl.value)&&(this.cpuSocketsFormControl.valid||null==this.cpuSocketsFormControl.value)&&(this.memoryFormControl.valid||null==this.memoryFormControl.value)}get isDirty(){return this.virtualMachineNameFormControl.dirty||this.cpuSocketsFormControl.dirty||this.memoryFormControl.dirty||this.templateFormControl.dirty||this.hostFormControl.dirty||this.storageFormControl.dirty||this.networkFormControl.dirty||this.createFromOptionFormControl.dirty||this.virtualDiskFormControl.dirty||this.guestOperatingSystemFormControl.dirty||this.guestOsFirmwareFormControl.dirty||this.efiSecureBootFormControl.dirty}}var oe=(()=>{return(i=oe||(oe={})).Template="Template",i.VirtualDisk="Virtual disk",oe;var i})(),ae=(()=>{return(i=ae||(ae={})).windows8Server64Guest="Microsoft Windows Server 2012 (64-bit)",i.windows9Server64Guest="Microsoft Windows Server 2016 or later (64-bit)",ae;var i})(),L=c(7713),we=c(55894),j=c(84385),z=c(3238);function dt(i,a){if(1&i&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" Virtual machine name should contain more than ",t.viewModel.virtualMachineNameFormControl.errors.minlength.requiredLength," characters ")}}function mt(i,a){if(1&i&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" Virtual machine name should not exceed ",t.viewModel.virtualMachineNameFormControl.errors.maxlength.requiredLength," characters ")}}function pt(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Virtual machine name is invalid "),e.qZA())}function ut(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Virtual machine name is required "),e.qZA())}function gt(i,a){if(1&i&&(e.TgZ(0,"mat-option",19),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function ht(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Cpu sockets minimum value is 1 "),e.qZA())}function Ct(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Not a number "),e.qZA())}function ft(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Cpu sockets value is required "),e.qZA())}function _t(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Memory minimum value is 256 "),e.qZA())}function vt(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Not a number "),e.qZA())}function Mt(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Memory value is required "),e.qZA())}function wt(i,a){if(1&i&&(e.TgZ(0,"mat-option",19),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function Zt(i,a){if(1&i&&(e.TgZ(0,"mat-option",19),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function Tt(i,a){if(1&i&&(e.TgZ(0,"mat-option",19),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function yt(i,a){if(1&i&&(e.TgZ(0,"mat-option",19),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function xt(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",8),e.TgZ(1,"div",9),e._uU(2," Virtual disk "),e.qZA(),e.TgZ(3,"div",10),e.TgZ(4,"mat-select",16),e.NdJ("selectionChange",function(o){return e.CHM(t),e.oxw().onVirtualDiskChanged.next(o)}),e.TgZ(5,"mat-option"),e._uU(6),e.qZA(),e.YNc(7,yt,2,2,"mat-option",17),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(4),e.s9C("placeholder",t.viewModel.defaultVirtualDisk),e.Q6J("formControl",t.viewModel.virtualDiskFormControl),e.xp6(2),e.hij("Default: ",t.viewModel.defaultVirtualDisk,""),e.xp6(1),e.Q6J("ngForOf",t.viewModel.virtualDisks)}}function bt(i,a){if(1&i&&(e.TgZ(0,"mat-option",19),e._uU(1),e.qZA()),2&i){const t=a.$implicit,n=e.oxw(2);e.Q6J("value",t),e.xp6(1),e.hij(" ",n.guestOperatingSystemEnum[t]," ")}}function At(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",8),e.TgZ(1,"div",9),e._uU(2," Guest OS "),e.qZA(),e.TgZ(3,"div",10),e.TgZ(4,"mat-select",16),e.NdJ("selectionChange",function(o){return e.CHM(t),e.oxw().onGuestOperatingSystemChanged.next(o)}),e.TgZ(5,"mat-option"),e._uU(6),e.qZA(),e.YNc(7,bt,2,2,"mat-option",17),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(4),e.s9C("placeholder",t.guestOperatingSystemEnum[t.viewModel.defaultGuestOperatingSystem]),e.Q6J("formControl",t.viewModel.guestOperatingSystemFormControl),e.xp6(2),e.hij("Default: ",t.guestOperatingSystemEnum[t.viewModel.defaultGuestOperatingSystem],""),e.xp6(1),e.Q6J("ngForOf",t.viewModel.guestOperatingSystems)}}function St(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",8),e.TgZ(1,"div",9),e._uU(2," Guest OS firmware "),e.qZA(),e.TgZ(3,"div",10),e.TgZ(4,"mat-select",16),e.NdJ("selectionChange",function(){return e.CHM(t),e.oxw().onInputChange()}),e.TgZ(5,"mat-option"),e._uU(6),e.qZA(),e.TgZ(7,"mat-option",20),e._uU(8,"BIOS"),e.qZA(),e.TgZ(9,"mat-option",21),e._uU(10,"EFI"),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(4),e.s9C("placeholder",t.viewModel.defaultGuestOsFirmware),e.Q6J("formControl",t.viewModel.guestOsFirmwareFormControl),e.xp6(2),e.hij("Default: ",t.viewModel.defaultGuestOsFirmware,"")}}function Dt(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",8),e.TgZ(1,"div",9),e._uU(2," Enable EFI secure boot "),e.qZA(),e.TgZ(3,"div",10),e.TgZ(4,"mat-select",16),e.NdJ("selectionChange",function(){return e.CHM(t),e.oxw().onInputChange()}),e.TgZ(5,"mat-option",19),e._uU(6),e.qZA(),e.TgZ(7,"mat-option",19),e._uU(8,"Yes"),e.qZA(),e.TgZ(9,"mat-option",19),e._uU(10,"No"),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(4),e.Q6J("formControl",t.viewModel.efiSecureBootFormControl)("placeholder",t.viewModel.defaultEfiSecureBootEnabled?"Yes":"No"),e.xp6(1),e.Q6J("value",null),e.xp6(1),e.hij("Default: ",t.viewModel.defaultEfiSecureBootEnabled?"Yes":"No",""),e.xp6(1),e.Q6J("value",!0),e.xp6(2),e.Q6J("value",!1)}}function It(i,a){if(1&i&&(e.TgZ(0,"mat-option",19),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function kt(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",8),e.TgZ(1,"div",9),e._uU(2," Template "),e.qZA(),e.TgZ(3,"div",10),e.TgZ(4,"mat-select",16),e.NdJ("selectionChange",function(o){return e.CHM(t),e.oxw().onTemplateChanged.next(o)}),e.TgZ(5,"mat-option"),e._uU(6),e.qZA(),e.YNc(7,It,2,2,"mat-option",17),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(4),e.s9C("placeholder",t.viewModel.defaultTemplate),e.Q6J("formControl",t.viewModel.templateFormControl),e.xp6(2),e.hij("Default: ",t.viewModel.defaultTemplate,""),e.xp6(1),e.Q6J("ngForOf",t.viewModel.templates)}}let Ze=(()=>{class i{constructor(t,n){this.imageSubject=t,this.hypervisorResourcesService=n,this.icons=_.R.icons.fontAwesome,this.onHostChanged=new p.xQ,this.onStorageChanged=new p.xQ,this.onNetworkChanged=new p.xQ,this.onCreateFromOptionChanged=new p.xQ,this.onVirtualDiskChanged=new p.xQ,this.onGuestOperatingSystemChanged=new p.xQ,this.onTemplateChanged=new p.xQ,this.subscription=new I.w,this.createFromOptionEnum=oe,this.guestOperatingSystemEnum=ae,this.viewModel=new ct}ngOnInit(){this.subscription.add(this.hypervisorResourcesService.hypervisorResources.subscribe(t=>{null!=t&&(this.hypervisorResources=t,this.mapHypervisorResourcesToViewModel())})),this.subscription.add(this.imageSubject.imageSelected.subscribe(t=>{t&&(this.modelClone=W.G.cloneDeep(t),this.mapModelToForm(t),this.viewModel.resetDirty(),this.mapFormControlValuesToDataModel())}))}ngAfterViewInit(){this.subscription.add(this.onHostChanged.subscribe(t=>{this.viewModel.host=t.value,this.onInputChange()})),this.subscription.add(this.onTemplateChanged.subscribe(t=>{this.viewModel.template=t.value,this.onInputChange()})),this.subscription.add(this.onNetworkChanged.subscribe(t=>{this.viewModel.network=t.value,this.onInputChange()})),this.subscription.add(this.onCreateFromOptionChanged.subscribe(t=>{this.viewModel.createFromOption=t.value,this.onInputChange()})),this.subscription.add(this.onVirtualDiskChanged.subscribe(t=>{this.viewModel.virtualDisk=t.value,this.onInputChange()})),this.subscription.add(this.onGuestOperatingSystemChanged.subscribe(t=>{this.viewModel.guestOperatingSystem=t.value,this.onInputChange()})),this.subscription.add(this.onStorageChanged.subscribe(t=>{this.viewModel.storage=t.value,this.onInputChange()})),this.subscription.add(this.viewModel.virtualMachineNameFormControl.valueChanges.subscribe(t=>{t&&(this.viewModel.virtualMachineNameFormControl.setValidators(l.kI.compose([l.kI.required,l.kI.minLength(1),l.kI.maxLength(12),L.K.computerName()])),this.viewModel.virtualMachineNameFormControl.updateValueAndValidity({emitEvent:!1})),this.onInputChange()})),this.subscription.add(this.viewModel.cpuSocketsFormControl.valueChanges.subscribe(t=>{t&&(this.viewModel.cpuSocketsFormControl.setValidators(l.kI.compose([l.kI.required,L.K.minValueAllowed(1),L.K.numberInput()])),this.viewModel.cpuSocketsFormControl.updateValueAndValidity({emitEvent:!1})),this.onInputChange()})),this.subscription.add(this.viewModel.memoryFormControl.valueChanges.subscribe(t=>{t&&(this.viewModel.memoryFormControl.setValidators(l.kI.compose([l.kI.required,L.K.minValueAllowed(256),L.K.numberInput()])),this.viewModel.memoryFormControl.updateValueAndValidity({emitEvent:!1})),this.onInputChange()}))}resetToDefaultValue(t){t.setValue(null),t.markAsDirty(),t.clearValidators(),t.updateValueAndValidity({emitEvent:!1})}mapHypervisorResourcesToViewModel(){null!=this.hypervisorResources&&(this.viewModel.hosts=null==this.hypervisorResources.hosts?[]:[...this.hypervisorResources.hosts],this.viewModel.storages=null==this.hypervisorResources.storages?[]:[...this.hypervisorResources.storages],this.viewModel.networks=null==this.hypervisorResources.networks?[]:[...this.hypervisorResources.networks],this.viewModel.createFromOptions=null==this.hypervisorResources.createFromOptions?[]:[...this.hypervisorResources.createFromOptions],this.viewModel.virtualDisks=null==this.hypervisorResources.virtualDisks?[]:[...this.hypervisorResources.virtualDisks],this.viewModel.guestOperatingSystems=null==this.hypervisorResources.guestOperatingSystems?[]:[...this.hypervisorResources.guestOperatingSystems],this.viewModel.templates=null==this.hypervisorResources.templates?[]:[...this.hypervisorResources.templates])}mapModelToForm(t){this.viewModel.defaultVirtualMachineName=t.defaultVirtualMachineDetailsModel.vmName,this.viewModel.virtualMachineName=t.virtualMachineDetailsModel.vmName,this.viewModel.virtualMachineNameFormControl.setValue(this.viewModel.virtualMachineName),this.viewModel.defaultHost=t.defaultVirtualMachineDetailsModel.host,this.viewModel.host=t.virtualMachineDetailsModel.host,this.viewModel.hostFormControl.setValue(this.viewModel.host),this.viewModel.defaultNetwork=t.defaultVirtualMachineDetailsModel.network,this.viewModel.network=t.virtualMachineDetailsModel.network,this.viewModel.networkFormControl.setValue(this.viewModel.network),this.viewModel.defaultCreateFromOption=t.defaultVirtualMachineDetailsModel.createFromOption,this.viewModel.createFromOption=t.virtualMachineDetailsModel.createFromOption,this.viewModel.createFromOptionFormControl.setValue(this.viewModel.createFromOption),this.viewModel.defaultVirtualDisk=t.defaultVirtualMachineDetailsModel.virtualDisk,this.viewModel.virtualDisk=t.virtualMachineDetailsModel.virtualDisk,this.viewModel.virtualDiskFormControl.setValue(this.viewModel.virtualDisk),this.viewModel.defaultGuestOperatingSystem=t.defaultVirtualMachineDetailsModel.guestOperatingSystem,this.viewModel.guestOperatingSystem=t.virtualMachineDetailsModel.guestOperatingSystem,this.viewModel.guestOperatingSystemFormControl.setValue(this.viewModel.guestOperatingSystem),this.viewModel.defaultGuestOsFirmware=t.defaultVirtualMachineDetailsModel.guestOsFirmware,this.viewModel.guestOsFirmware=t.virtualMachineDetailsModel.guestOsFirmware,this.viewModel.guestOsFirmwareFormControl.setValue(this.viewModel.guestOsFirmware),this.viewModel.defaultEfiSecureBootEnabled=t.defaultVirtualMachineDetailsModel.efiSecureBootEnabled,this.viewModel.efiSecureBootEnabled=t.virtualMachineDetailsModel.efiSecureBootEnabled,this.viewModel.efiSecureBootFormControl.setValue(this.viewModel.efiSecureBootEnabled),this.viewModel.defaultTemplate=t.defaultVirtualMachineDetailsModel.template,this.viewModel.template=t.virtualMachineDetailsModel.template,this.viewModel.templateFormControl.setValue(this.viewModel.template),this.viewModel.defaultMemory=t.defaultVirtualMachineDetailsModel.memory?.toString(),this.viewModel.memory=t.virtualMachineDetailsModel.memory?.toString(),this.viewModel.memoryFormControl.setValue(this.viewModel.memory),this.viewModel.defaultCpuSockets=t.defaultVirtualMachineDetailsModel.cpu?.toString(),this.viewModel.cpuSockets=t.virtualMachineDetailsModel.cpu?.toString(),this.viewModel.cpuSocketsFormControl.setValue(this.viewModel.cpuSockets),this.viewModel.defaultStorage=t.defaultVirtualMachineDetailsModel.storage,this.viewModel.storage=t.virtualMachineDetailsModel.storage,this.viewModel.storageFormControl.setValue(this.viewModel.storage)}mapFormControlValuesToDataModel(){null!=this.modelClone&&(this.model={virtualMachine:{host:this.viewModel.hostFormControl.value,cpu:this.viewModel.cpuSocketsFormControl.value,memory:this.viewModel.memoryFormControl.value,storage:this.viewModel.storageFormControl.value,network:this.viewModel.networkFormControl.value,createFromOption:this.viewModel.createFromOption,virtualDisk:this.viewModel.virtualDiskFormControl.value,guestOperatingSystem:this.viewModel.guestOperatingSystemFormControl.value,guestOsFirmware:this.viewModel.guestOsFirmwareFormControl.value,efiSecureBootEnabled:this.viewModel.efiSecureBootFormControl.value,template:this.viewModel.templateFormControl.value,vmName:this.viewModel.virtualMachineNameFormControl.value},targetPlatform:{username:this.modelClone.targetPlatform.username,password:this.modelClone.targetPlatform.password,collectionId:this.modelClone.targetPlatform.collectionId,environmentId:this.modelClone.targetPlatform.environmentId,url:this.modelClone.targetPlatform.url}})}onInputChange(){null!=this.modelClone&&this.mapFormControlValuesToDataModel()}get allowSave(){return this.viewModel.isDirty&&this.viewModel.isValid}revertChanges(){this.mapModelToForm(this.modelClone),this.viewModel.resetDirty()}ngOnDestroy(){this.subscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Z.Y),e.Y36(we.N))},i.\u0275cmp=e.Xpm({type:i,selectors:[["virtual-machine-details"]],decls:82,vars:47,consts:[["hideToggle","","form","","autocomplete","off",1,"mat-elevation-z0"],["panel",""],[1,"panel-header"],[3,"expanded"],[1,"mb-0","title"],[1,"title"],[1,"description"],[1,"container","striped",2,"background","#FFF"],[1,"row","mt-0","pointer","read-only","align-items-center","bt-1"],[1,"col-lg-3","pt-3","pb-3","br-1"],[1,"col","pt-0","pb-0"],[1,"full-width",3,"floatLabel"],["name","name","matInput","",3,"formControl","placeholder"],[4,"ngIf"],["mat-icon-button","","matSuffix","","matTooltip","Reset to default value",3,"disabled","click"],[3,"iconClasses"],[3,"formControl","placeholder","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["class","row mt-0 pointer read-only align-items-center bt-1",4,"ngIf"],[3,"value"],["value","BIOS"],["value","EFI"]],template:function(t,n){if(1&t&&(e.TgZ(0,"mat-expansion-panel",0,1),e.TgZ(2,"mat-expansion-panel-header"),e.TgZ(3,"div",2),e._UZ(4,"am-caret",3),e.TgZ(5,"h4",4),e.TgZ(6,"span",5),e._uU(7,"VIRTUAL MACHINE "),e.qZA(),e.TgZ(8,"span",6),e._uU(9,"Details"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(10,"div",7),e.TgZ(11,"div",8),e.TgZ(12,"div",9),e._uU(13," Virtual machine name "),e.qZA(),e.TgZ(14,"div",10),e.TgZ(15,"mat-form-field",11),e._UZ(16,"input",12),e.YNc(17,dt,2,1,"mat-error",13),e.YNc(18,mt,2,1,"mat-error",13),e.YNc(19,pt,2,0,"mat-error",13),e.YNc(20,ut,2,0,"mat-error",13),e.TgZ(21,"button",14),e.NdJ("click",function(){return n.resetToDefaultValue(n.viewModel.virtualMachineNameFormControl)}),e._UZ(22,"am-icon",15),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(23,"div",8),e.TgZ(24,"div",9),e._uU(25," VMware hostname "),e.qZA(),e.TgZ(26,"div",10),e.TgZ(27,"mat-select",16),e.NdJ("selectionChange",function(r){return n.onHostChanged.next(r)}),e.TgZ(28,"mat-option"),e._uU(29),e.qZA(),e.YNc(30,gt,2,2,"mat-option",17),e.qZA(),e.qZA(),e.qZA(),e.TgZ(31,"div",8),e.TgZ(32,"div",9),e._uU(33," CPU sockets "),e.qZA(),e.TgZ(34,"div",10),e.TgZ(35,"mat-form-field",11),e._UZ(36,"input",12),e.YNc(37,ht,2,0,"mat-error",13),e.YNc(38,Ct,2,0,"mat-error",13),e.YNc(39,ft,2,0,"mat-error",13),e.TgZ(40,"button",14),e.NdJ("click",function(){return n.resetToDefaultValue(n.viewModel.cpuSocketsFormControl)}),e._UZ(41,"am-icon",15),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(42,"div",8),e.TgZ(43,"div",9),e._uU(44," Memory "),e.qZA(),e.TgZ(45,"div",10),e.TgZ(46,"mat-form-field",11),e._UZ(47,"input",12),e.YNc(48,_t,2,0,"mat-error",13),e.YNc(49,vt,2,0,"mat-error",13),e.YNc(50,Mt,2,0,"mat-error",13),e.TgZ(51,"button",14),e.NdJ("click",function(){return n.resetToDefaultValue(n.viewModel.memoryFormControl)}),e._UZ(52,"am-icon",15),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(53,"div",8),e.TgZ(54,"div",9),e._uU(55," Datastore "),e.qZA(),e.TgZ(56,"div",10),e.TgZ(57,"mat-select",16),e.NdJ("selectionChange",function(r){return n.onStorageChanged.next(r)}),e.TgZ(58,"mat-option"),e._uU(59),e.qZA(),e.YNc(60,wt,2,2,"mat-option",17),e.qZA(),e.qZA(),e.qZA(),e.TgZ(61,"div",8),e.TgZ(62,"div",9),e._uU(63," Network "),e.qZA(),e.TgZ(64,"div",10),e.TgZ(65,"mat-select",16),e.NdJ("selectionChange",function(r){return n.onNetworkChanged.next(r)}),e.TgZ(66,"mat-option"),e._uU(67),e.qZA(),e.YNc(68,Zt,2,2,"mat-option",17),e.qZA(),e.qZA(),e.qZA(),e.TgZ(69,"div",8),e.TgZ(70,"div",9),e._uU(71," Create from "),e.qZA(),e.TgZ(72,"div",10),e.TgZ(73,"mat-select",16),e.NdJ("selectionChange",function(r){return n.onCreateFromOptionChanged.next(r)}),e.TgZ(74,"mat-option"),e._uU(75),e.qZA(),e.YNc(76,Tt,2,2,"mat-option",17),e.qZA(),e.qZA(),e.qZA(),e.YNc(77,xt,8,4,"div",18),e.YNc(78,At,8,4,"div",18),e.YNc(79,St,11,3,"div",18),e.YNc(80,Dt,11,6,"div",18),e.YNc(81,kt,8,4,"div",18),e.qZA(),e.qZA()),2&t){const o=e.MAs(1);e.xp6(4),e.Q6J("expanded",o.expanded),e.xp6(11),e.Q6J("floatLabel","never"),e.xp6(1),e.s9C("placeholder",null==n.viewModel.virtualMachineNameFormControl.value?n.viewModel.defaultVirtualMachineName:""),e.Q6J("formControl",n.viewModel.virtualMachineNameFormControl),e.xp6(1),e.Q6J("ngIf",n.viewModel.virtualMachineNameFormControl.hasError("minlength")),e.xp6(1),e.Q6J("ngIf",n.viewModel.virtualMachineNameFormControl.hasError("maxlength")),e.xp6(1),e.Q6J("ngIf",n.viewModel.virtualMachineNameFormControl.hasError("computerName")),e.xp6(1),e.Q6J("ngIf",n.viewModel.virtualMachineNameFormControl.hasError("required")),e.xp6(1),e.Q6J("disabled",null==n.viewModel.virtualMachineNameFormControl.value),e.xp6(1),e.Q6J("iconClasses",n.icons.UNDO),e.xp6(5),e.s9C("placeholder",n.viewModel.defaultHost),e.Q6J("formControl",n.viewModel.hostFormControl),e.xp6(2),e.hij("Default: ",n.viewModel.defaultHost,""),e.xp6(1),e.Q6J("ngForOf",n.viewModel.hosts),e.xp6(5),e.Q6J("floatLabel","never"),e.xp6(1),e.s9C("placeholder",null==n.viewModel.cpuSocketsFormControl.value?n.viewModel.defaultCpuSockets:""),e.Q6J("formControl",n.viewModel.cpuSocketsFormControl),e.xp6(1),e.Q6J("ngIf",n.viewModel.cpuSocketsFormControl.hasError("minValue")),e.xp6(1),e.Q6J("ngIf",n.viewModel.cpuSocketsFormControl.hasError("notNumber")),e.xp6(1),e.Q6J("ngIf",n.viewModel.cpuSocketsFormControl.hasError("required")),e.xp6(1),e.Q6J("disabled",null==n.viewModel.cpuSocketsFormControl.value),e.xp6(1),e.Q6J("iconClasses",n.icons.UNDO),e.xp6(5),e.Q6J("floatLabel","never"),e.xp6(1),e.s9C("placeholder",null==n.viewModel.memoryFormControl.value?n.viewModel.defaultMemory:""),e.Q6J("formControl",n.viewModel.memoryFormControl),e.xp6(1),e.Q6J("ngIf",n.viewModel.memoryFormControl.hasError("minValue")),e.xp6(1),e.Q6J("ngIf",n.viewModel.memoryFormControl.hasError("notNumber")),e.xp6(1),e.Q6J("ngIf",n.viewModel.memoryFormControl.hasError("required")),e.xp6(1),e.Q6J("disabled",null==n.viewModel.memoryFormControl.value),e.xp6(1),e.Q6J("iconClasses",n.icons.UNDO),e.xp6(5),e.s9C("placeholder",n.viewModel.defaultStorage),e.Q6J("formControl",n.viewModel.storageFormControl),e.xp6(2),e.hij("Default: ",n.viewModel.defaultStorage,""),e.xp6(1),e.Q6J("ngForOf",n.viewModel.storages),e.xp6(5),e.s9C("placeholder",n.viewModel.defaultNetwork),e.Q6J("formControl",n.viewModel.networkFormControl),e.xp6(2),e.hij("Default: ",n.viewModel.defaultNetwork,""),e.xp6(1),e.Q6J("ngForOf",n.viewModel.networks),e.xp6(5),e.s9C("placeholder",n.viewModel.defaultCreateFromOption),e.Q6J("formControl",n.viewModel.createFromOptionFormControl),e.xp6(2),e.hij("Default: ",n.viewModel.defaultCreateFromOption,""),e.xp6(1),e.Q6J("ngForOf",n.viewModel.createFromOptions),e.xp6(1),e.Q6J("ngIf",n.viewModel.createFromOption===n.createFromOptionEnum.VirtualDisk||null==n.viewModel.createFromOption&&n.viewModel.defaultCreateFromOption===n.createFromOptionEnum.VirtualDisk),e.xp6(1),e.Q6J("ngIf",n.viewModel.createFromOption===n.createFromOptionEnum.VirtualDisk||null==n.viewModel.createFromOption&&n.viewModel.defaultCreateFromOption===n.createFromOptionEnum.VirtualDisk),e.xp6(1),e.Q6J("ngIf",n.viewModel.createFromOption===n.createFromOptionEnum.VirtualDisk||null==n.viewModel.createFromOption&&n.viewModel.defaultCreateFromOption===n.createFromOptionEnum.VirtualDisk),e.xp6(1),e.Q6J("ngIf",n.viewModel.createFromOption===n.createFromOptionEnum.VirtualDisk||null==n.viewModel.createFromOption&&n.viewModel.defaultCreateFromOption===n.createFromOptionEnum.VirtualDisk),e.xp6(1),e.Q6J("ngIf",n.viewModel.createFromOption===n.createFromOptionEnum.Template||null==n.viewModel.createFromOption&&n.viewModel.defaultCreateFromOption===n.createFromOptionEnum.Template)}},directives:[C.ib,C.yz,q,g.KE,P.Nt,l.Fj,l.JJ,l.oH,u.O5,g.TO,D.lW,g.R9,k.gM,S.b,j.gD,z.ey,u.sg],styles:["mat-expansion-panel[_ngcontent-%COMP%]{border-radius:0;border-width:0 0 1px 0;border-style:solid;border-color:#0000001f;width:100%}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]{display:inline;padding:0}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]{height:60px;width:100%;padding:0 15px 0 0;display:flex;align-items:center;cursor:pointer}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   am-caret[_ngcontent-%COMP%]{color:#9b9b9b;height:100%;padding:0 8px 0 10px;display:flex;align-items:center;cursor:pointer}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   h4.title[_ngcontent-%COMP%]{font-size:15px;text-transform:uppercase}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:12px;font-weight:300;color:#616161;text-transform:none}mat-expansion-panel[_ngcontent-%COMP%]   .bt-1[_ngcontent-%COMP%]{border-top:1px solid rgba(0,0,0,.125)}"]}),i})();class Ft{constructor(){this.collectionOuPathFormControl=new l.NI(this.collectionOuPath),this.localAdminNameFormControl=new l.NI(this.localAdminName),this.localAdminPasswordFormControl=new l.NI(this.localAdminPassword),this.imgCaptureSealCommandFormControl=new l.NI(this.sealCommand),this.imgCaptureSealCommandArgsFormControl=new l.NI(this.sealCommandArgs),this.imgCaptureWaitForSealFormControl=new l.NI(this.waitForSealCommand),this.shutdownVmFormControl=new l.NI(this.shouldShutdownVm),this.snapshotVmFormControl=new l.NI(this.shouldCreateSnapshot),this.finalizationActionFormControl=new l.NI(this.finalizationAction)}resetDirty(){this.collectionOuPathFormControl.reset(this.collectionOuPath),this.localAdminNameFormControl.reset(this.localAdminName),this.localAdminPasswordFormControl.reset(this.localAdminPassword),this.imgCaptureSealCommandFormControl.reset(this.sealCommand),this.imgCaptureSealCommandArgsFormControl.reset(this.sealCommandArgs),this.imgCaptureWaitForSealFormControl.reset(this.waitForSealCommand),this.shutdownVmFormControl.reset(this.shouldShutdownVm),this.finalizationActionFormControl.reset(this.finalizationAction)}get isValid(){return(this.collectionOuPathFormControl.valid||null==this.collectionOuPathFormControl.value)&&(this.localAdminNameFormControl.valid||null==this.localAdminNameFormControl.value)&&(this.localAdminPasswordFormControl.valid||null==this.localAdminPasswordFormControl.value)}get isDirty(){return this.collectionOuPathFormControl.dirty||this.localAdminNameFormControl.dirty||this.localAdminPasswordFormControl.dirty||this.imgCaptureSealCommandFormControl.dirty||this.imgCaptureSealCommandArgsFormControl.dirty||this.imgCaptureWaitForSealFormControl.dirty||this.shutdownVmFormControl.dirty||this.snapshotVmFormControl.dirty||this.finalizationActionFormControl.dirty}}var U=(()=>{return(i=U||(U={}))[i.DoNothing=0]="DoNothing",i[i.StoreDisk=1]="StoreDisk",i[i.ConvertToTemplate=2]="ConvertToTemplate",U;var i})();class Ot{static convertEnumToString(a){switch(a){case U.DoNothing:return"Do nothing";case U.StoreDisk:return"Store disk";case U.ConvertToTemplate:return"Convert to template";default:return""}}}var Pt=c(66216),R=c(6184);function Nt(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Target OU is required "),e.qZA())}function qt(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Local admin name is required "),e.qZA())}function Ut(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Local admin password is required "),e.qZA())}function Rt(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Seal command is required "),e.qZA())}function Jt(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Seal command arguments is required "),e.qZA())}function Qt(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",7),e.TgZ(1,"div",8),e._uU(2," Shutdown VM after sealing "),e.qZA(),e.TgZ(3,"div",9),e.TgZ(4,"mat-select",21),e.NdJ("selectionChange",function(){return e.CHM(t),e.oxw().onInputChange()}),e.TgZ(5,"mat-option"),e._uU(6),e.qZA(),e.TgZ(7,"mat-option",22),e._uU(8,"Yes"),e.qZA(),e.TgZ(9,"mat-option",22),e._uU(10,"No"),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(4),e.s9C("placeholder",t.viewModel.defaultShouldShutdownVm?"Yes":"No"),e.Q6J("formControl",t.viewModel.shutdownVmFormControl),e.xp6(2),e.hij("Default: ",t.viewModel.defaultShouldShutdownVm?"Yes":"No",""),e.xp6(1),e.Q6J("value",!0),e.xp6(2),e.Q6J("value",!1)}}function Vt(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",7),e.TgZ(1,"div",8),e._uU(2," Snapshot VM after sealing "),e.qZA(),e.TgZ(3,"div",9),e.TgZ(4,"mat-select",21),e.NdJ("selectionChange",function(){return e.CHM(t),e.oxw().onInputChange()}),e.TgZ(5,"mat-option"),e._uU(6),e.qZA(),e.TgZ(7,"mat-option",22),e._uU(8,"Yes"),e.qZA(),e.TgZ(9,"mat-option",22),e._uU(10,"No"),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(4),e.s9C("placeholder",t.viewModel.defaultShouldCreateSnapshot?"Yes":"No"),e.Q6J("formControl",t.viewModel.snapshotVmFormControl),e.xp6(2),e.hij("Default: ",t.viewModel.defaultShouldCreateSnapshot?"Yes":"No",""),e.xp6(1),e.Q6J("value",!0),e.xp6(2),e.Q6J("value",!1)}}function Lt(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",7),e.TgZ(1,"div",8),e._uU(2," Image finalization action "),e.qZA(),e.TgZ(3,"div",9),e.TgZ(4,"mat-select",21),e.NdJ("selectionChange",function(){return e.CHM(t),e.oxw().onInputChange()}),e.TgZ(5,"mat-option"),e._uU(6),e.qZA(),e.TgZ(7,"mat-option",22),e._uU(8,"Do nothing"),e.qZA(),e.TgZ(9,"mat-option",22),e._uU(10,"Store disk"),e.qZA(),e.TgZ(11,"mat-option",22),e._uU(12,"Convert to template"),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(4),e.s9C("placeholder",t.convertFinalizationActionEnumToString(t.viewModel.defaultFinalizationAction)),e.Q6J("formControl",t.viewModel.finalizationActionFormControl),e.xp6(2),e.hij("Default: ",t.convertFinalizationActionEnumToString(t.viewModel.defaultFinalizationAction)," "),e.xp6(1),e.Q6J("value",t.ImageFinalizationActionType.DoNothing),e.xp6(2),e.Q6J("value",t.ImageFinalizationActionType.StoreDisk),e.xp6(2),e.Q6J("value",t.ImageFinalizationActionType.ConvertToTemplate)}}let Te=(()=>{class i{constructor(t,n){this.imageSubject=t,this.uiNotificationsService=n,this.icons=_.R.icons.fontAwesome,this.onCaptureOptionChanged=new p.xQ,this.onWaitForSealChanged=new p.xQ,this.onStoreDiskChanged=new p.xQ,this.subscription=new I.w,this.fakeLocalAdminPassword="password",this.ImageFinalizationActionType=U,this.convertFinalizationActionEnumToString=Ot.convertEnumToString,this.ouVerificationInProgress=!1,this.viewModel=new Ft}ngOnInit(){this.subscription.add(this.imageSubject.imageSelected.subscribe(t=>{t&&(this.modelClone=W.G.cloneDeep(t),this.mapModelToForm(t),this.viewModel.resetDirty(),this.mapFormControlValuesToDataModel())}))}ngAfterViewInit(){this.subscription.add(this.onWaitForSealChanged.subscribe(t=>{this.viewModel.waitForSealCommand=t.value,this.onInputChange()})),this.subscription.add(this.viewModel.collectionOuPathFormControl.valueChanges.subscribe(t=>{t&&(this.viewModel.collectionOuPathFormControl.setValidators(l.kI.required),this.viewModel.collectionOuPathFormControl.updateValueAndValidity({emitEvent:!1})),this.onInputChange()})),this.subscription.add(this.viewModel.localAdminNameFormControl.valueChanges.subscribe(t=>{t&&(this.viewModel.localAdminNameFormControl.setValidators(l.kI.required),this.viewModel.localAdminNameFormControl.updateValueAndValidity({emitEvent:!1})),this.onInputChange()})),this.subscription.add(this.viewModel.localAdminPasswordFormControl.valueChanges.subscribe(t=>{t&&(this.viewModel.localAdminPasswordFormControl.setValidators(l.kI.required),this.viewModel.localAdminPasswordFormControl.updateValueAndValidity({emitEvent:!1})),this.onInputChange()})),this.subscription.add(this.viewModel.imgCaptureSealCommandFormControl.valueChanges.subscribe(t=>{t&&(this.viewModel.imgCaptureSealCommandFormControl.setValidators(l.kI.required),this.viewModel.imgCaptureSealCommandFormControl.updateValueAndValidity({emitEvent:!1})),this.onInputChange()})),this.subscription.add(this.viewModel.imgCaptureSealCommandArgsFormControl.valueChanges.subscribe(t=>{t&&(this.viewModel.imgCaptureSealCommandArgsFormControl.setValidators(l.kI.required),this.viewModel.imgCaptureSealCommandArgsFormControl.updateValueAndValidity({emitEvent:!1})),this.onInputChange()}))}verifyCollectionOuPath(t){let n=Pt.h.getCurrentEnvironment().id;t?(this.ouVerificationInProgress=!0,this.subscription.add(this.imageSubject.getCollectionOuPathVerification(t,n).subscribe(o=>{o&&(o.pathExists?o.writingPermitted?this.uiNotificationsService.sendInfoMessage("Writing is permitted"):this.uiNotificationsService.sendWarningMessage("No writing permissions granted"):this.uiNotificationsService.sendWarningMessage("OU does not exist"))},o=>{this.ouVerificationInProgress=!1},()=>{this.ouVerificationInProgress=!1}))):this.uiNotificationsService.sendWarningMessage("No entered value")}resetToDefaultValue(t){t.setValue(null),t.markAsDirty(),t.clearValidators(),t.updateValueAndValidity({emitEvent:!1})}mapModelToForm(t){this.viewModel.defaultCollectionOuPath=t.defaultCollectionOuPath,this.viewModel.collectionOuPath=t.collectionOuPath,this.viewModel.collectionOuPathFormControl.setValue(this.viewModel.collectionOuPath),this.viewModel.defaultLocalAdminName=t.defaultLocalAdminAccount.userName,this.viewModel.localAdminName=t.localAdminAccount.userName,this.viewModel.localAdminNameFormControl.setValue(this.viewModel.localAdminName),this.viewModel.localAdminPassword=!0!==t.localAdminAccount.isPasswordSet?t.localAdminAccount.password:this.fakeLocalAdminPassword,this.viewModel.localAdminPasswordFormControl.setValue(this.viewModel.localAdminPassword),this.viewModel.defaultSealCommand=t.defaultImageCapture.sealCommand,this.viewModel.sealCommand=t.imageCapture.sealCommand,this.viewModel.imgCaptureSealCommandFormControl.setValue(this.viewModel.sealCommand),this.viewModel.defaultSealCommandArgs=t.defaultImageCapture.sealCommandArguments,this.viewModel.sealCommandArgs=t.imageCapture.sealCommandArguments,this.viewModel.imgCaptureSealCommandArgsFormControl.setValue(this.viewModel.sealCommandArgs),this.viewModel.defaultWaitForSealCommand=t.defaultImageCapture.waitForSealCmd,this.viewModel.waitForSealCommand=t.imageCapture.waitForSealCmd,this.viewModel.imgCaptureWaitForSealFormControl.setValue(this.viewModel.waitForSealCommand),this.viewModel.defaultShouldShutdownVm=t.defaultImageCapture.shouldShutdown,this.viewModel.shouldShutdownVm=t.imageCapture.shouldShutdown,this.viewModel.shutdownVmFormControl.setValue(this.viewModel.shouldShutdownVm),this.viewModel.defaultShouldCreateSnapshot=t.defaultImageCapture.shouldCreateSnapshot,this.viewModel.shouldCreateSnapshot=t.imageCapture.shouldCreateSnapshot,this.viewModel.snapshotVmFormControl.setValue(this.viewModel.shouldCreateSnapshot),this.viewModel.defaultFinalizationAction=t.defaultImageCapture.imageFinalizationAction,this.viewModel.finalizationAction=t.imageCapture.imageFinalizationAction,this.viewModel.finalizationActionFormControl.setValue(this.viewModel.finalizationAction),this.isLocalAdminPasswordSet=t.localAdminAccount.isPasswordSet}mapFormControlValuesToDataModel(){null!=this.modelClone&&(this.model={collectionOuPath:this.viewModel.collectionOuPathFormControl.value,credentials:{userName:this.viewModel.localAdminNameFormControl.value,password:this.viewModel.localAdminPasswordFormControl.value!==this.fakeLocalAdminPassword?this.viewModel.localAdminPasswordFormControl.value:""},imageCapture:{sealCommand:this.viewModel.imgCaptureSealCommandFormControl.value,sealCommandArguments:this.viewModel.imgCaptureSealCommandArgsFormControl.value,waitForSealCmd:this.viewModel.imgCaptureWaitForSealFormControl.value,shouldShutdown:this.viewModel.shutdownVmFormControl.value,shouldCreateSnapshot:this.viewModel.snapshotVmFormControl.value,imageFinalizationAction:this.viewModel.finalizationActionFormControl.value}})}onInputChange(){null!=this.modelClone&&this.mapFormControlValuesToDataModel()}setPasswordValue(t){null!=this.viewModel.localAdminPasswordFormControl.value&&this.viewModel.localAdminPasswordFormControl.setValue(!0===t?this.model.credentials.password!==this.fakeLocalAdminPassword?this.model.credentials.password:"":""===this.model.credentials.password&&this.isLocalAdminPasswordSet?this.fakeLocalAdminPassword:this.model.credentials?.password)}get allowSave(){return this.viewModel.isDirty&&this.viewModel.isValid}revertChanges(){this.mapModelToForm(this.modelClone),this.viewModel.resetDirty()}ngOnDestroy(){this.subscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Z.Y),e.Y36(R.w))},i.\u0275cmp=e.Xpm({type:i,selectors:[["recipe-configuration"]],decls:70,vars:41,consts:[["hideToggle","",1,"mat-elevation-z0"],["panel",""],[1,"panel-header"],[3,"expanded"],[1,"mb-0","title"],[1,"title"],[1,"container","striped",2,"background","#FFF"],[1,"row","mt-0","pointer","read-only","align-items-center","bt-1"],[1,"col-lg-3","pt-3","pb-3","br-1"],[1,"col","pt-0","pb-0"],[1,"full-width",3,"floatLabel"],["name","targetOu","matInput","",3,"formControl","placeholder"],[4,"ngIf"],["mat-icon-button","","matSuffix","","matTooltip","Check for writing permissions",3,"disabled","click"],[3,"iconClasses"],["mat-icon-button","","matSuffix","","matTooltip","Reset to default value",3,"disabled","click"],["name","localAdminName","matInput","",3,"formControl","placeholder"],["autocomplete","new-password",1,"full-width",3,"floatLabel"],["type","password","name","localAdminPassword","matInput","","autocomplete","new-password",3,"formControl","placeholder","focus","blur"],["name","sealCommand","matInput","",3,"formControl","placeholder"],["name","sealCommandArgs","matInput","",3,"formControl","placeholder"],[3,"formControl","placeholder","selectionChange"],[3,"value"],["class","row mt-0 pointer read-only align-items-center bt-1",4,"ngIf"]],template:function(t,n){if(1&t&&(e.TgZ(0,"mat-expansion-panel",0,1),e.TgZ(2,"mat-expansion-panel-header"),e.TgZ(3,"div",2),e._UZ(4,"am-caret",3),e.TgZ(5,"h4",4),e.TgZ(6,"span",5),e._uU(7,"CONFIGURATION "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"div",6),e.TgZ(9,"div",7),e.TgZ(10,"div",8),e._uU(11," Target OU "),e.qZA(),e.TgZ(12,"div",9),e.TgZ(13,"mat-form-field",10),e._UZ(14,"input",11),e.YNc(15,Nt,2,0,"mat-error",12),e.TgZ(16,"button",13),e.NdJ("click",function(){return n.verifyCollectionOuPath(n.viewModel.collectionOuPathFormControl.value)}),e._UZ(17,"am-icon",14),e.qZA(),e.TgZ(18,"button",15),e.NdJ("click",function(){return n.resetToDefaultValue(n.viewModel.collectionOuPathFormControl)}),e._UZ(19,"am-icon",14),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(20,"div",7),e.TgZ(21,"div",8),e._uU(22," Local admin name "),e.qZA(),e.TgZ(23,"div",9),e.TgZ(24,"mat-form-field",10),e._UZ(25,"input",16),e.YNc(26,qt,2,0,"mat-error",12),e.TgZ(27,"button",15),e.NdJ("click",function(){return n.resetToDefaultValue(n.viewModel.localAdminNameFormControl)}),e._UZ(28,"am-icon",14),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(29,"div",7),e.TgZ(30,"div",8),e._uU(31," Local admin password "),e.qZA(),e.TgZ(32,"div",9),e.TgZ(33,"mat-form-field",17),e.TgZ(34,"input",18),e.NdJ("focus",function(){return n.setPasswordValue(!0)})("blur",function(){return n.setPasswordValue(!1)}),e.qZA(),e.YNc(35,Ut,2,0,"mat-error",12),e.TgZ(36,"button",15),e.NdJ("click",function(){return n.resetToDefaultValue(n.viewModel.localAdminPasswordFormControl)}),e._UZ(37,"am-icon",14),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(38,"div",7),e.TgZ(39,"div",8),e._uU(40," Seal command "),e.qZA(),e.TgZ(41,"div",9),e.TgZ(42,"mat-form-field",10),e._UZ(43,"input",19),e.YNc(44,Rt,2,0,"mat-error",12),e.TgZ(45,"button",15),e.NdJ("click",function(){return n.resetToDefaultValue(n.viewModel.imgCaptureSealCommandFormControl)}),e._UZ(46,"am-icon",14),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(47,"div",7),e.TgZ(48,"div",8),e._uU(49," Seal command args "),e.qZA(),e.TgZ(50,"div",9),e.TgZ(51,"mat-form-field",10),e._UZ(52,"input",20),e.YNc(53,Jt,2,0,"mat-error",12),e.TgZ(54,"button",15),e.NdJ("click",function(){return n.resetToDefaultValue(n.viewModel.imgCaptureSealCommandArgsFormControl)}),e._UZ(55,"am-icon",14),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(56,"div",7),e.TgZ(57,"div",8),e._uU(58," Wait for seal command "),e.qZA(),e.TgZ(59,"div",9),e.TgZ(60,"mat-select",21),e.NdJ("selectionChange",function(r){return n.onWaitForSealChanged.next(r)}),e.TgZ(61,"mat-option"),e._uU(62),e.qZA(),e.TgZ(63,"mat-option",22),e._uU(64,"Yes"),e.qZA(),e.TgZ(65,"mat-option",22),e._uU(66,"No"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(67,Qt,11,5,"div",23),e.YNc(68,Vt,11,5,"div",23),e.YNc(69,Lt,13,6,"div",23),e.qZA(),e.qZA()),2&t){const o=e.MAs(1);e.xp6(4),e.Q6J("expanded",o.expanded),e.xp6(9),e.Q6J("floatLabel","never"),e.xp6(1),e.s9C("placeholder",null==n.viewModel.collectionOuPathFormControl.value?n.viewModel.defaultCollectionOuPath:""),e.Q6J("formControl",n.viewModel.collectionOuPathFormControl),e.xp6(1),e.Q6J("ngIf",n.viewModel.collectionOuPathFormControl.hasError("required")),e.xp6(1),e.Q6J("disabled",n.ouVerificationInProgress||!n.viewModel.collectionOuPathFormControl.value&&null!=n.viewModel.collectionOuPathFormControl.value),e.xp6(1),e.Q6J("iconClasses",n.icons.PLUG),e.xp6(1),e.Q6J("disabled",null==n.viewModel.collectionOuPathFormControl.value),e.xp6(1),e.Q6J("iconClasses",n.icons.UNDO),e.xp6(5),e.Q6J("floatLabel","never"),e.xp6(1),e.s9C("placeholder",null==n.viewModel.localAdminNameFormControl.value?n.viewModel.defaultLocalAdminName:""),e.Q6J("formControl",n.viewModel.localAdminNameFormControl),e.xp6(1),e.Q6J("ngIf",n.viewModel.localAdminNameFormControl.hasError("required")),e.xp6(1),e.Q6J("disabled",null==n.viewModel.localAdminNameFormControl.value),e.xp6(1),e.Q6J("iconClasses",n.icons.UNDO),e.xp6(5),e.Q6J("floatLabel","never"),e.xp6(1),e.s9C("placeholder",null==n.viewModel.localAdminPasswordFormControl.value?"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022":""),e.Q6J("formControl",n.viewModel.localAdminPasswordFormControl),e.xp6(1),e.Q6J("ngIf",n.viewModel.localAdminPasswordFormControl.hasError("required")),e.xp6(1),e.Q6J("disabled",null==n.viewModel.localAdminPasswordFormControl.value),e.xp6(1),e.Q6J("iconClasses",n.icons.UNDO),e.xp6(5),e.Q6J("floatLabel","never"),e.xp6(1),e.s9C("placeholder",null==n.viewModel.imgCaptureSealCommandFormControl.value?n.viewModel.defaultSealCommand:""),e.Q6J("formControl",n.viewModel.imgCaptureSealCommandFormControl),e.xp6(1),e.Q6J("ngIf",n.viewModel.imgCaptureSealCommandFormControl.hasError("required")),e.xp6(1),e.Q6J("disabled",null==n.viewModel.imgCaptureSealCommandFormControl.value),e.xp6(1),e.Q6J("iconClasses",n.icons.UNDO),e.xp6(5),e.Q6J("floatLabel","never"),e.xp6(1),e.s9C("placeholder",null==n.viewModel.imgCaptureSealCommandArgsFormControl.value?n.viewModel.defaultSealCommandArgs:""),e.Q6J("formControl",n.viewModel.imgCaptureSealCommandArgsFormControl),e.xp6(1),e.Q6J("ngIf",n.viewModel.imgCaptureSealCommandArgsFormControl.hasError("required")),e.xp6(1),e.Q6J("disabled",null==n.viewModel.imgCaptureSealCommandArgsFormControl.value),e.xp6(1),e.Q6J("iconClasses",n.icons.UNDO),e.xp6(5),e.s9C("placeholder",n.viewModel.defaultWaitForSealCommand?"Yes":"No"),e.Q6J("formControl",n.viewModel.imgCaptureWaitForSealFormControl),e.xp6(2),e.hij("Default: ",n.viewModel.defaultWaitForSealCommand?"Yes":"No",""),e.xp6(1),e.Q6J("value",!0),e.xp6(2),e.Q6J("value",!1),e.xp6(2),e.Q6J("ngIf",!0===n.viewModel.imgCaptureWaitForSealFormControl.value||null==n.viewModel.imgCaptureWaitForSealFormControl.value&&!0===n.viewModel.defaultWaitForSealCommand),e.xp6(1),e.Q6J("ngIf",!0===n.viewModel.imgCaptureWaitForSealFormControl.value||null==n.viewModel.imgCaptureWaitForSealFormControl.value&&!0===n.viewModel.defaultWaitForSealCommand),e.xp6(1),e.Q6J("ngIf",(!0===n.viewModel.imgCaptureWaitForSealFormControl.value||null==n.viewModel.imgCaptureWaitForSealFormControl.value&&!0===n.viewModel.defaultWaitForSealCommand)&&(!0===n.viewModel.shutdownVmFormControl.value||null==n.viewModel.shutdownVmFormControl.value&&!0===n.viewModel.defaultShouldShutdownVm))}},directives:[C.ib,C.yz,q,g.KE,P.Nt,l.Fj,l.JJ,l.oH,u.O5,g.TO,D.lW,g.R9,k.gM,S.b,j.gD,z.ey],styles:["mat-expansion-panel[_ngcontent-%COMP%]{border-radius:0;border-width:0 0 1px 0;border-style:solid;border-color:#0000001f;width:100%}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]{display:inline;padding:0}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]{height:60px;width:100%;padding:0 15px 0 0;display:flex;align-items:center;cursor:pointer}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   am-caret[_ngcontent-%COMP%]{color:#9b9b9b;height:100%;padding:0 8px 0 10px;display:flex;align-items:center;cursor:pointer}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   h4.title[_ngcontent-%COMP%]{font-size:15px;text-transform:uppercase}mat-expansion-panel[_ngcontent-%COMP%]   .bt-1[_ngcontent-%COMP%]{border-top:1px solid rgba(0,0,0,.125)}"]}),i})();var ye=c(87341),m=c(30671),y=c(96308),x=c(78033),Et=c(21324),B=c(75778),Yt=c(9893),$=c.n(Yt),xe=c(66591),re=c(89502),be=c(39261);function Ht(i,a){if(1&i&&e._UZ(0,"am-icon",26),2&i){const t=e.oxw();e.Q6J("iconClasses",t.icons.CARET_RIGHT)}}function Wt(i,a){if(1&i&&e._UZ(0,"am-icon",26),2&i){const t=e.oxw();e.Q6J("iconClasses",t.icons.CARET_DOWN)}}function jt(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"mat-form-field",27),e.NdJ("click",function(o){return o.stopPropagation()}),e.TgZ(1,"span",28),e._UZ(2,"i",29),e.qZA(),e.TgZ(3,"input",30),e.NdJ("keyup",function(o){return e.CHM(t),e.oxw().applyFilter(o.target.value)}),e.qZA(),e.qZA()}}function zt(i,a){1&i&&(e.TgZ(0,"mat-header-cell",31),e._uU(1,"Order "),e.qZA())}function Bt(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Required"),e.qZA())}function $t(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Not number"),e.qZA())}function Gt(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Negative"),e.qZA())}function Kt(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"mat-cell",32),e.TgZ(1,"mat-form-field",33),e.TgZ(2,"input",34),e.NdJ("keyup",function(o){const r=e.CHM(t),s=r.$implicit,d=r.index;return e.oxw().onOrderChanged.next({term:o.target.value,pckg:s,idx:d})}),e.qZA(),e.YNc(3,Bt,2,0,"mat-error",35),e.YNc(4,$t,2,0,"mat-error",35),e.YNc(5,Gt,2,0,"mat-error",35),e.qZA(),e.qZA()}if(2&i){const t=a.$implicit;e.xp6(2),e.Q6J("formControl",t.formControl),e.xp6(1),e.Q6J("ngIf",t.formControl.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.formControl.hasError("number")),e.xp6(1),e.Q6J("ngIf",t.formControl.hasError("negative"))}}function Xt(i,a){1&i&&(e.TgZ(0,"mat-header-cell",36),e._uU(1," Application name "),e.qZA())}function en(i,a){if(1&i&&(e.TgZ(0,"mat-cell",37),e._UZ(1,"div",38),e.ALo(2,"searchhighlight"),e.qZA()),2&i){const t=a.$implicit,n=a.index,o=e.oxw();e.xp6(1),e.Q6J("innerHtml",e.gM2(2,1,t,o.filterValue,"applicationName",n),e.oJD)}}function tn(i,a){1&i&&(e.TgZ(0,"mat-header-cell",39),e._uU(1," Description "),e.qZA())}function nn(i,a){if(1&i&&(e.TgZ(0,"mat-cell",37),e._UZ(1,"div",38),e.ALo(2,"searchhighlight"),e.qZA()),2&i){const t=a.$implicit,n=a.index,o=e.oxw();e.xp6(1),e.Q6J("innerHtml",e.gM2(2,1,t,o.filterValue,"description",n),e.oJD)}}function on(i,a){1&i&&e._UZ(0,"mat-header-cell",40)}function an(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"mat-cell",41),e.TgZ(1,"button",42),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().onDelete.next(r)}),e._UZ(2,"am-icon",43),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("iconClasses",t.icons.TRASH)}}function rn(i,a){1&i&&e._UZ(0,"mat-header-row",44)}function sn(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"mat-row",45),e.NdJ("click",function(o){return e.CHM(t),e.oxw().rowClick(o)}),e.qZA()}if(2&i){const t=a.index,n=e.oxw();e.ekj("matched",t==n.currentMatchIndex),e.Q6J("ngClass","matched-"+t)}}const Ae=c(49870);let Se=(()=>{class i{constructor(t,n){this.dialogController=t,this.imageSubject=n,this.icons=_.R.icons.fontAwesome,this.displayedColumns=["orderNumber","applicationName","description","action"],this.dataSource=new m.by([]),this.packageList=[],this.packageListClone=[],this.totalPackagesCount=0,this.onOrderChanged=new p.xQ,this.onDelete=new p.xQ,this.currentMatchIndex=-1,this.currentMatchPosition=1,this.matchArray=[],this.nextMatch=new p.xQ,this.prevMatch=new p.xQ,this.subscription=new I.w,this.panelOpenState=!1}ngOnInit(){this.subscription.add(this.imageSubject.imageSelected.subscribe(t=>{t&&(this.recipeId=t.recipeSelection.getRecipeId(),this.packageList=[...t.packageList.entityPackages.map(n=>new ye.q(!1,n.name,n.description,n.orderNumber,n.id))],this.finalizeLoadingPackages(),this.packageListClone=$()(this.dataSource.data),this.isDirty=!1)})),this.subscription.add(this.imageSubject.packagesModified.subscribe(t=>{null!=t&&(this.packageList=[...t.map(n=>new ye.q(!1,n.name,n.description,n.orderNumber,n.id))],this.finalizeLoadingPackages(),this.isDirty=this.isDifferent())}))}ngAfterViewInit(){this.subscription.add(this.nextMatch.subscribe(()=>{if(0!==this.matchArray.length){if(this.currentMatchPosition<0)return this.currentMatchPosition=0,void(this.currentMatchIndex=this.matchArray[this.currentMatchPosition]);this.currentMatchPosition++,this.currentMatchPosition===this.matchArray.length&&(this.currentMatchPosition=0),this.currentMatchIndex=this.matchArray[this.currentMatchPosition]}})),this.subscription.add(this.prevMatch.subscribe(()=>{if(0!==this.matchArray.length){if(0===this.currentMatchPosition)return this.currentMatchPosition=this.matchArray.length-1,void(this.currentMatchIndex=this.matchArray[this.currentMatchPosition]);this.currentMatchPosition--,this.currentMatchPosition<0&&(this.currentMatchPosition=this.matchArray.length-1),this.currentMatchIndex=this.matchArray[this.currentMatchPosition]}})),this.subscription.add(this.onDelete.subscribe(t=>{const n=this.packageList.findIndex(o=>o.id===t.id);n>=0&&(this.packageList.splice(n,1),this.dataSource.data=[...this.packageList],this.totalPackagesCount=this.packageList.length,this.isDirty=this.isDifferent(),this.calculateMatches())})),this.subscription.add(this.onOrderChanged.pipe((0,B.x)()).subscribe(t=>{if(t.pckg.orderNumber=t.pckg.formControl.value,t.pckg.formControl.setErrors(null),!t.pckg.formControl.valid)return;if(!t.term.trim())return void t.pckg.formControl.setErrors({required:"required"});let n=Number(t.term.trim());if(isNaN(n))return void t.pckg.formControl.setErrors({number:"number"});if(n<0&&t.pckg.formControl.setErrors({negative:"negative"}),this.dataSource.data[t.idx]){if(this.dataSource.data[t.idx].orderNumber===n)return;this.dataSource.data[t.idx].orderNumber=n,this.dataSource.data[t.idx].formControl.setValue(n)}const o=this.dataSource.data.findIndex(r=>r.id!==t.pckg.id&&r.orderNumber===n);if(o>=0){let r=0;r=o>0?o-1:0===o?0:o,this.dataSource.data.splice(r,0,this.dataSource.data[t.idx]),this.dataSource.data.splice(t.idx+1,1);for(let s=r+1;s<this.dataSource.data.length;s+=1)this.dataSource.data[s].orderNumber=++n,this.dataSource.data[s].formControl.setValue(n)}"orderNumber"===this.sort.active&&(this.dataSource.data=this.dataSource.data.sort((r,s)=>(0,x.WQ)(r.orderNumber,s.orderNumber,"asc"===this.sort.direction))),this.isDirty=this.isDifferent(),this.calculateMatches()}))}expandPanel(){this.panelOpenState=!this.panelOpenState}get description(){return`${this.totalPackagesCount} package${1!==this.totalPackagesCount?"s":""}`}applyFilter(t){this.filterValue=t.trim().toLowerCase()}onAddPackagesClick(t){t.stopPropagation(),this.dialogController.dialogSubject.next({component:Et.d,panelClass:"actions-dialog",data:{environmentId:"",collectionId:this.recipeId,selectedPackages:this.dataSource.data,actionName:"ADD PACKAGE(S)",actionDescription:"Please select package(s) to add to Recipe..."}})}sortData(t){const n=[...this.dataSource.data.slice()];if(!t.active||""===t.direction)return void(this.dataSource.data=n);const o="asc"===t.direction;this.dataSource.data=n.sort((r,s)=>{switch(t.active){case"orderNumber":return(0,x.WQ)(r.orderNumber,s.orderNumber,o);case"applicationName":return(0,x.qu)(r.applicationName,s.applicationName,o);case"description":return(0,x.qu)(r.description,s.description,o);default:return 0}})}rowClick(t){if(t&&t.target){const n=t.target.tagName.toLowerCase().toString();if(["button","am_icon","svg","path"].indexOf(n)>=0)return void t.stopPropagation()}this.isDirtyHash=this.computeHash(this.dataSource.data)}calculateMatches(){this.matchArray.length=0,this.currentMatchIndex=-1,this.currentMatchPosition=-1,this.filterValue&&(this.matchArray=this.dataSource.data.map((t,n)=>{const o=RegExp(this.filterValue,"ig");return o.test(t.applicationName)||o.test(t.description)?n:-1}).filter(t=>t>=0))}isDifferent(){return this.computeHash(this.dataSource.data)!==this.isDirtyHash}get isValid(){return 0===this.dataSource.data.filter(n=>!n.formControl.valid).length}computeHash(t){const n=t.reduce((o,r)=>(o[r.id]=r.formControl.value,o),{});return Ae(n)}finalizeLoadingPackages(){this.dataSource.data=this.packageList.sort((t,n)=>(0,x.WQ)(t.orderNumber,n.orderNumber,!0)),this.totalPackagesCount=this.packageList.length,this.isDirtyHash=Ae(this.dataSource.data)}mapPackageList(){return this.dataSource.data.map(t=>({orderNumber:t.formControl.value,name:t.applicationName,id:t.id,description:t.description}))}get allowSave(){return this.isDirty&&this.isValid}revertChanges(){this.dataSource.data=this.packageList=$()(this.packageListClone),this.totalPackagesCount=this.packageList.length,this.isDirty=!1}ngOnDestroy(){this.subscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(xe.Y),e.Y36(Z.Y))},i.\u0275cmp=e.Xpm({type:i,selectors:[["recipe-package-list"]],viewQuery:function(t,n){if(1&t&&e.Gf(y.YE,5),2&t){let o;e.iGM(o=e.CRH())&&(n.sort=o.first)}},inputs:{savingInProgress:"savingInProgress"},decls:31,vars:12,consts:[["hideToggle","",1,"mat-elevation-z0",3,"expanded"],[3,"click"],[1,"panel-header"],["class","caret",3,"iconClasses",4,"ngIf"],[1,"mb-0","title"],[1,"title"],[1,"description"],[1,"action"],["class","search",3,"click",4,"ngIf"],["mat-raised-button","","color","primary","tabindex","-1",3,"matTooltip","disabled","click"],[3,"iconClasses"],[1,"ps-show-always"],["matSort","","matSortActive","orderNumber","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange"],["matColumnDef","orderNumber"],["style","max-width: 10%; width:10%","class","pl-3 marker-column text-capitalize","mat-sort-header","",4,"matHeaderCellDef"],["style","max-width: 10%; width:10%","class","text-center pl-4 pr-3",4,"matCellDef"],["matColumnDef","applicationName"],["style","max-width: 40%; width:40%","mat-sort-header","",4,"matHeaderCellDef"],["style","max-width: 40%; width:40%",4,"matCellDef"],["matColumnDef","description"],["style","max-width: 40%; width:40%","class","pl-3","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","action"],["style","max-width: 10%; width:10%","class","pl-3","mat-sort-header","",4,"matHeaderCellDef"],["class","text-right","style","max-width: 10%; width:10%",4,"matCellDef"],["class","pl-0",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","pl-0 pr-0 pointer",3,"ngClass","matched","click",4,"matRowDef","matRowDefColumns"],[1,"caret",3,"iconClasses"],[1,"search",3,"click"],["matPrefix","",1,"mr-3"],[1,"far","fa-search"],["matInput","","placeholder","Enter your search term...",3,"keyup"],["mat-sort-header","",1,"pl-3","marker-column","text-capitalize",2,"max-width","10%","width","10%"],[1,"text-center","pl-4","pr-3",2,"max-width","10%","width","10%"],[1,"full-width"],["matInput","","name","orderNumber",3,"formControl","keyup"],[4,"ngIf"],["mat-sort-header","",2,"max-width","40%","width","40%"],[2,"max-width","40%","width","40%"],[1,"highlight",3,"innerHtml"],["mat-sort-header","",1,"pl-3",2,"max-width","40%","width","40%"],["mat-sort-header","",1,"pl-3",2,"max-width","10%","width","10%"],[1,"text-right",2,"max-width","10%","width","10%"],["mat-button","",3,"click"],["title","Remove package",3,"iconClasses"],[1,"pl-0"],[1,"pl-0","pr-0","pointer",3,"ngClass","click"]],template:function(t,n){1&t&&(e.TgZ(0,"mat-expansion-panel",0),e.TgZ(1,"mat-expansion-panel-header",1),e.NdJ("click",function(){return n.expandPanel()}),e.TgZ(2,"div",2),e.YNc(3,Ht,1,1,"am-icon",3),e.YNc(4,Wt,1,1,"am-icon",3),e.TgZ(5,"h4",4),e.TgZ(6,"span",5),e._uU(7,"PACKAGE LIST "),e.qZA(),e.TgZ(8,"span",6),e._uU(9),e.qZA(),e.qZA(),e.TgZ(10,"div",7),e.YNc(11,jt,4,0,"mat-form-field",8),e.TgZ(12,"button",9),e.NdJ("click",function(r){return n.onAddPackagesClick(r)}),e._UZ(13,"am-icon",10),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div"),e.TgZ(15,"perfect-scrollbar",11),e.TgZ(16,"mat-table",12),e.NdJ("matSortChange",function(r){return n.sortData(r)}),e.ynx(17,13),e.YNc(18,zt,2,0,"mat-header-cell",14),e.YNc(19,Kt,6,4,"mat-cell",15),e.BQk(),e.ynx(20,16),e.YNc(21,Xt,2,0,"mat-header-cell",17),e.YNc(22,en,3,6,"mat-cell",18),e.BQk(),e.ynx(23,19),e.YNc(24,tn,2,0,"mat-header-cell",20),e.YNc(25,nn,3,6,"mat-cell",18),e.BQk(),e.ynx(26,21),e.YNc(27,on,1,0,"mat-header-cell",22),e.YNc(28,an,3,1,"mat-cell",23),e.BQk(),e.YNc(29,rn,1,0,"mat-header-row",24),e.YNc(30,sn,1,3,"mat-row",25),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.Q6J("expanded",n.panelOpenState),e.xp6(3),e.Q6J("ngIf",!n.panelOpenState),e.xp6(1),e.Q6J("ngIf",n.panelOpenState),e.xp6(5),e.Oqu(n.description),e.xp6(2),e.Q6J("ngIf",n.panelOpenState),e.xp6(1),e.Q6J("matTooltip","Add packages")("disabled",n.savingInProgress),e.xp6(1),e.Q6J("iconClasses",n.icons.PLUS),e.xp6(3),e.Q6J("dataSource",n.dataSource),e.xp6(13),e.Q6J("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",n.displayedColumns))},directives:[C.ib,C.yz,u.O5,S.b,g.KE,g.qo,P.Nt,D.lW,k.gM,re.Vv,m.BZ,y.YE,m.w1,m.fO,m.ge,y.nU,m.Dz,m.ev,l.Fj,l.JJ,l.oH,g.TO,m.as,m.XQ,m.nj,m.Gk,u.mk],pipes:[be.W],styles:["mat-expansion-panel[_ngcontent-%COMP%]{border-radius:0;border-width:0 0 1px 0;border-style:solid;border-color:#0000001f;width:100%}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]{display:inline;padding:0}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]{height:60px;width:100%;padding:0 15px 0 0;display:flex;align-items:center;cursor:pointer}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{color:#9b9b9b;height:100%;padding:0 8px 0 10px;display:flex;align-items:center;cursor:pointer;width:26px}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   h4.title[_ngcontent-%COMP%]{font-size:15px;text-transform:uppercase}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:12px;font-weight:300;color:#616161;text-transform:none}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{display:inline-flex;align-items:center;font-size:12px;margin-left:auto}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{display:inline-flex}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .mat-raised-button[_ngcontent-%COMP%]{margin-left:12px;padding:2px;line-height:19px;min-width:23px;height:23px;outline:none}"]}),i})();var G=c(80013),N=c(65938);class K{constructor(a,t,n,o){this.isMarked=a,this.applicationName=t,this.orderNumber=n,this.id=o,this.formControl=new l.NI(this.orderNumber,l.kI.compose([]))}}var E=c(53951),X=c(29531),ee=c(71102),ln=c(56709);function cn(i,a){1&i&&e._UZ(0,"mat-header-cell",30)}function dn(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"mat-cell",31),e.TgZ(1,"mat-checkbox",32),e.NdJ("click",function(o){return o.stopPropagation()})("change",function(){const r=e.CHM(t).$implicit;return e.oxw(2).toggleMarked(r)}),e.qZA(),e.qZA()}if(2&i){const t=a.$implicit;e.xp6(1),e.Q6J("checked",t.isMarked)}}function mn(i,a){1&i&&(e.TgZ(0,"mat-header-cell",33),e._uU(1,"Application name"),e.qZA())}function pn(i,a){if(1&i&&(e.TgZ(0,"mat-cell",34),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.hij(" ",t.applicationName,"")}}function un(i,a){1&i&&e._UZ(0,"mat-header-row",35)}function gn(i,a){1&i&&e._UZ(0,"mat-row",35)}function hn(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"mat-table",21),e.NdJ("matSortChange",function(o){return e.CHM(t),e.oxw().sortData(o)}),e.ynx(1,22),e.YNc(2,cn,1,0,"mat-header-cell",23),e.YNc(3,dn,2,1,"mat-cell",24),e.BQk(),e.ynx(4,25),e.YNc(5,mn,2,0,"mat-header-cell",26),e.YNc(6,pn,2,1,"mat-cell",27),e.BQk(),e.YNc(7,un,1,0,"mat-header-row",28),e.YNc(8,gn,1,0,"mat-row",29),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("dataSource",t.dataSource),e.xp6(7),e.Q6J("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns)}}let Cn=(()=>{class i{constructor(t,n,o,r,s){this.data=t,this.imageSubject=n,this.dialog=o,this.imageManagementHttpService=r,this.hotkeysService=s,this.icons=_.R.icons.fontAwesome,this.layerList=[],this.alreadySelectedLayers=[],this.collectionId=O.c.Empty,this.clickDelay=100,this.onCancel=new p.xQ,this.onDone=new p.xQ,this.onSearch=new p.xQ,this.isLoading=!1,this.displayedColumns=["marker","applicationName"],this.dataSource=new m.by([]),this.actionName=t.actionName,this.actionDescription=t.actionDescription,this.alreadySelectedLayers=[...t.selectedLayers]}ngOnInit(){this.hotkeysService.pause(this.hotkeysService.hotkeys.filter(t=>"?"!==t.combo[0])),this.hotkeysService.add(new A.qm("enter",()=>(this.onDone.next(new KeyboardEvent("keydown")),!1),E.C.hotkeysAllowIn)),this.sort=new y.YE,this.sort.direction="asc",this.sort.active="applicationName",this.isLoading=!0,this.collectionId=this.data.collectionId,this.getLayers(this.collectionId)}getLayers(t){this.isLoading=!0,this.imageManagementHttpService.getLayerListDetails(t).subscribe(n=>{this.layerList=[...n.availableLayers.filter(o=>!this.inArray(o.id,this.alreadySelectedLayers)).map((o,r)=>new K(!1,o.name,r,o.id)),...n.entityLayers.filter(o=>!(this.inArray(o.id,this.alreadySelectedLayers)||this.inArray(o.id,n.availableLayers))).map((o,r)=>new K(!1,o.name,r,o.id)),...this.alreadySelectedLayers.map((o,r)=>new K(!0,o.applicationName,r,o.id))],this.dataSource.data=[...this.layerList],this.sort=new y.YE,this.sort.direction="asc",this.sort.active="applicationName",this.sortData(this.sort),this.isLoading=!1},()=>{this.isLoading=!1})}inArray(t,n){for(let o=0;o<n.length;o++)if(n[o].id===t)return!0;return!1}applyFilter(t){t||(this.dataSource.data=[...this.layerList]),this.dataSource.data=[...this.layerList.filter(n=>n.applicationName&&n.applicationName.toUpperCase().indexOf(t.toUpperCase())>=0)]}get SelectedApplications(){const t=this.dataSource.data.filter(n=>n.isMarked);return 0===t.length?"No applications selected":1===t.length?"1 application is selected":`${t.length} applications are selected`}toggleMarked(t){t.isMarked=!t.isMarked}ngAfterViewInit(){this.onSearch.pipe((0,G.b)(400)).pipe((0,B.x)()).subscribe(t=>{this.applyFilter(t)}),this.onCancel.pipe((0,G.b)(this.clickDelay)).subscribe(this.closeDialog.bind(this)),this.onDone.pipe((0,G.b)(this.clickDelay)).subscribe(()=>{const t=this.dataSource.data.filter(r=>r.isMarked&&this.alreadySelectedLayers.findIndex(s=>s.id===r.id)<0).map(r=>({name:r.applicationName,id:r.id})),n=this.dataSource.data.filter(r=>!r.isMarked&&-1!==this.alreadySelectedLayers.findIndex(s=>s.id===r.id));let o=[...this.alreadySelectedLayers.filter(r=>-1===n.findIndex(s=>s.id===r.id)).map(r=>({name:r.applicationName,id:r.id})),...t];o.forEach((r,s)=>r.orderNumber=s+1),this.imageSubject.layersModified.next(o),this.dialog.close()})}closeDialog(){this.dialog.close()}ngOnDestroy(){this.imageSelectedSubscription&&this.imageSelectedSubscription.unsubscribe(),this.windowResizeSubscription&&this.windowResizeSubscription.unsubscribe(),this.hotkeysService.remove(this.hotkeysService.hotkeys.filter(t=>"enter"===t.combo[0])),this.hotkeysService.unpause(this.hotkeysService.pausedHotkeys.filter(t=>null!=t.combo[0]))}sortData(t){const n=[...this.dataSource.data.slice()];if(!t.active||""===t.direction)return void(this.dataSource.data=n);const o="asc"===t.direction;this.dataSource.data=n.sort((r,s)=>"applicationName"===t.active?(0,x.qu)(r.applicationName??"",s.applicationName??"",o):0)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(N.WI),e.Y36(Z.Y),e.Y36(N.so),e.Y36(X.f),e.Y36(A.tm))},i.\u0275cmp=e.Xpm({type:i,selectors:[["add-layer-modal"]],viewQuery:function(t,n){if(1&t&&e.Gf(y.YE,5),2&t){let o;e.iGM(o=e.CRH())&&(n.sort=o.first)}},decls:29,vars:6,consts:[["mat-dialog-title",""],[1,"mat-dialog-actions","border-bottom","mb-0","pb-0"],[1,"container","mt-1"],[1,"row","align-items-center"],[1,"col-lg-7"],[1,"action-title"],[1,"action-description"],[1,"col-lg-5"],[1,"full-width"],["matPrefix","",1,"mr-3"],[1,"far","fa-search"],["matInput","","placeholder","Enter your search term...",3,"keyup"],[3,"loading","loadingText"],["class","dashboard-table","matSort","","matSortActive","applicationName","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange",4,"ngIf"],[1,"mat-dialog-actions","border-top"],[1,"container"],[1,"row","no-gutters","align-items-center"],[1,"col","text-left"],[1,"col","text-right"],["mat-raised-button","",3,"click"],["color","primary","mat-raised-button","",3,"click"],["matSort","","matSortActive","applicationName","matSortDirection","asc","matSortDisableClear","",1,"dashboard-table",3,"dataSource","matSortChange"],["matColumnDef","marker"],["class","marker-column-header text-left pl-3",4,"matHeaderCellDef"],["class","text-left marker-column pl-3",4,"matCellDef"],["matColumnDef","applicationName"],["mat-sort-header","",4,"matHeaderCellDef"],["class","text-left",4,"matCellDef"],["class","pl-0",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","pl-0",4,"matRowDef","matRowDefColumns"],[1,"marker-column-header","text-left","pl-3"],[1,"text-left","marker-column","pl-3"],[3,"checked","click","change"],["mat-sort-header",""],[1,"text-left"],[1,"pl-0"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e._uU(6),e.TgZ(7,"i",6),e._uU(8),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"div",7),e.TgZ(10,"mat-form-field",8),e.TgZ(11,"span",9),e._UZ(12,"i",10),e.qZA(),e.TgZ(13,"input",11),e.NdJ("keyup",function(r){return n.onSearch.next(r.target.value)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div"),e.TgZ(15,"perfect-scrollbar"),e.TgZ(16,"loading-container",12),e.YNc(17,hn,9,4,"mat-table",13),e.qZA(),e.qZA(),e.qZA(),e.TgZ(18,"div",14),e.TgZ(19,"div",15),e.TgZ(20,"div",16),e.TgZ(21,"div",17),e.TgZ(22,"i"),e._uU(23),e.qZA(),e.qZA(),e.TgZ(24,"div",18),e.TgZ(25,"button",19),e.NdJ("click",function(r){return n.onCancel.next(r)}),e._uU(26,"CANCEL"),e.qZA(),e.TgZ(27,"button",20),e.NdJ("click",function(r){return n.onDone.next(r)}),e._uU(28,"DONE"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(6),e.hij("",n.actionName," "),e.xp6(2),e.Oqu(n.actionDescription),e.xp6(8),e.Q6J("loading",n.isLoading)("loadingText","Loading package groups..."),e.xp6(1),e.Q6J("ngIf",n.dataSource.data&&n.dataSource.data.length>0),e.xp6(6),e.Oqu(n.SelectedApplications))},directives:[N.uh,g.KE,g.qo,P.Nt,re.Vv,ee.o,u.O5,m.BZ,y.YE,m.w1,m.fO,m.ge,m.Dz,m.ev,ln.oG,y.nU,m.as,m.XQ,m.nj,m.Gk,D.lW],styles:[".marker-column[_ngcontent-%COMP%], .marker-column-header[_ngcontent-%COMP%]{width:50px;max-width:50px}i[_ngcontent-%COMP%]{font-weight:300;color:#616161}.mat-form-field[_ngcontent-%COMP%]{font-size:12px}  perfect-scrollbar.ps-show-always>.ps.ps--active-x>.ps__rail-x{visibility:hidden}"]}),i})();function fn(i,a){if(1&i&&e._UZ(0,"am-icon",24),2&i){const t=e.oxw();e.Q6J("iconClasses",t.icons.CARET_RIGHT)}}function _n(i,a){if(1&i&&e._UZ(0,"am-icon",24),2&i){const t=e.oxw();e.Q6J("iconClasses",t.icons.CARET_DOWN)}}function vn(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"mat-form-field",25),e.NdJ("click",function(o){return o.stopPropagation()}),e.TgZ(1,"span",26),e._UZ(2,"i",27),e.qZA(),e.TgZ(3,"input",28),e.NdJ("keyup",function(o){return e.CHM(t),e.oxw().applyFilter(o.target.value)}),e.qZA(),e.qZA()}}function Mn(i,a){1&i&&(e.TgZ(0,"mat-header-cell",29),e._uU(1,"Order "),e.qZA())}function wn(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Required"),e.qZA())}function Zn(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Not number"),e.qZA())}function Tn(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Negative"),e.qZA())}function yn(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"mat-cell",30),e.TgZ(1,"mat-form-field",31),e.TgZ(2,"input",32),e.NdJ("keyup",function(o){const r=e.CHM(t),s=r.$implicit,d=r.index;return e.oxw().onOrderChanged.next({term:o.target.value,lr:s,idx:d})}),e.qZA(),e.YNc(3,wn,2,0,"mat-error",33),e.YNc(4,Zn,2,0,"mat-error",33),e.YNc(5,Tn,2,0,"mat-error",33),e.qZA(),e.qZA()}if(2&i){const t=a.$implicit;e.xp6(2),e.Q6J("formControl",t.formControl),e.xp6(1),e.Q6J("ngIf",t.formControl.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.formControl.hasError("number")),e.xp6(1),e.Q6J("ngIf",t.formControl.hasError("negative"))}}function xn(i,a){1&i&&(e.TgZ(0,"mat-header-cell",34),e._uU(1," Application name "),e.qZA())}function bn(i,a){if(1&i&&(e.TgZ(0,"mat-cell",35),e._UZ(1,"div",36),e.ALo(2,"searchhighlight"),e.qZA()),2&i){const t=a.$implicit,n=a.index,o=e.oxw();e.xp6(1),e.Q6J("innerHtml",e.gM2(2,1,t,o.filterValue,"applicationName",n),e.oJD)}}function An(i,a){1&i&&e._UZ(0,"mat-header-cell",37)}function Sn(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"mat-cell",38),e.TgZ(1,"button",39),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().onDelete.next(r)}),e._UZ(2,"am-icon",40),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("iconClasses",t.icons.TRASH)}}function Dn(i,a){1&i&&e._UZ(0,"mat-header-row",41)}function In(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"mat-row",42),e.NdJ("click",function(o){return e.CHM(t),e.oxw().rowClick(o)}),e.qZA()}if(2&i){const t=a.index,n=e.oxw();e.ekj("matched",t==n.currentMatchIndex),e.Q6J("ngClass","matched-"+t)}}const De=c(49870);let Ie=(()=>{class i{constructor(t,n){this.dialogController=t,this.imageSubject=n,this.icons=_.R.icons.fontAwesome,this.displayedColumns=["orderNumber","applicationName","action"],this.dataSource=new m.by([]),this.layerList=[],this.layerListClone=[],this.totalLayersCount=0,this.onOrderChanged=new p.xQ,this.onDelete=new p.xQ,this.currentMatchIndex=-1,this.currentMatchPosition=1,this.matchArray=[],this.nextMatch=new p.xQ,this.prevMatch=new p.xQ,this.subscription=new I.w,this.panelOpenState=!1}ngOnInit(){this.subscription.add(this.imageSubject.imageSelected.subscribe(t=>{t&&(this.recipeId=t.recipeSelection.getRecipeId(),this.layerList=[...t.layerList.entityLayers.map(n=>new K(!1,n.name,n.orderNumber,n.id))],this.finalizeLoadingLayers(),this.layerListClone=$()(this.dataSource.data),this.isDirty=!1)})),this.subscription.add(this.imageSubject.layersModified.subscribe(t=>{null!=t&&(this.layerList=[...t.map(n=>new K(!1,n.name,n.orderNumber,n.id))],this.finalizeLoadingLayers(),this.isDirty=this.isDifferent())}))}ngAfterViewInit(){this.subscription.add(this.nextMatch.subscribe(()=>{if(0!==this.matchArray.length){if(this.currentMatchPosition<0)return this.currentMatchPosition=0,void(this.currentMatchIndex=this.matchArray[this.currentMatchPosition]);this.currentMatchPosition++,this.currentMatchPosition===this.matchArray.length&&(this.currentMatchPosition=0),this.currentMatchIndex=this.matchArray[this.currentMatchPosition]}})),this.subscription.add(this.prevMatch.subscribe(()=>{if(0!==this.matchArray.length){if(0===this.currentMatchPosition)return this.currentMatchPosition=this.matchArray.length-1,void(this.currentMatchIndex=this.matchArray[this.currentMatchPosition]);this.currentMatchPosition--,this.currentMatchPosition<0&&(this.currentMatchPosition=this.matchArray.length-1),this.currentMatchIndex=this.matchArray[this.currentMatchPosition]}})),this.subscription.add(this.onDelete.subscribe(t=>{const n=this.layerList.findIndex(o=>o.id===t.id);n>=0&&(this.layerList.splice(n,1),this.dataSource.data=[...this.layerList],this.totalLayersCount=this.layerList.length,this.isDirty=this.isDifferent(),this.calculateMatches())})),this.subscription.add(this.onOrderChanged.pipe((0,B.x)()).subscribe(t=>{if(t.lr.orderNumber=t.lr.formControl.value,t.lr.formControl.setErrors(null),!t.lr.formControl.valid)return;if(!t.term.trim())return void t.lr.formControl.setErrors({required:"required"});let n=Number(t.term.trim());if(isNaN(n))return void t.lr.formControl.setErrors({number:"number"});if(n<0&&t.lr.formControl.setErrors({negative:"negative"}),this.dataSource.data[t.idx]){if(this.dataSource.data[t.idx].orderNumber===n)return;this.dataSource.data[t.idx].orderNumber=n,this.dataSource.data[t.idx].formControl.setValue(n)}const o=this.dataSource.data.findIndex(r=>r.id!==t.lr.id&&r.orderNumber===n);if(o>=0){let r=0;r=o>0?o-1:0===o?0:o,this.dataSource.data.splice(r,0,this.dataSource.data[t.idx]),this.dataSource.data.splice(t.idx+1,1);for(let s=r+1;s<this.dataSource.data.length;s+=1)this.dataSource.data[s].orderNumber=++n,this.dataSource.data[s].formControl.setValue(n)}"orderNumber"===this.sort.active&&(this.dataSource.data=this.dataSource.data.sort((r,s)=>(0,x.WQ)(r.orderNumber,s.orderNumber,"asc"===this.sort.direction))),this.isDirty=this.isDifferent(),this.calculateMatches()}))}expandPanel(){this.panelOpenState=!this.panelOpenState}get description(){return`${this.totalLayersCount} package group${1!==this.totalLayersCount?"s":""}`}applyFilter(t){this.filterValue=t.trim().toLowerCase()}onAddLayersClick(t){t.stopPropagation(),this.dialogController.dialogSubject.next({component:Cn,panelClass:"actions-dialog",data:{environmentId:"",collectionId:this.recipeId,selectedLayers:this.dataSource.data,actionName:"ADD PACKAGE GROUP(S)",actionDescription:"Please select package group(s) to add to Recipe..."}})}sortData(t){const n=[...this.dataSource.data.slice()];if(!t.active||""===t.direction)return void(this.dataSource.data=n);const o="asc"===t.direction;this.dataSource.data=n.sort((r,s)=>{switch(t.active){case"orderNumber":return(0,x.WQ)(r.orderNumber,s.orderNumber,o);case"applicationName":return(0,x.qu)(r.applicationName,s.applicationName,o);default:return 0}})}rowClick(t){if(t&&t.target){const n=t.target.tagName.toLowerCase().toString();if(["button","am_icon","svg","path"].indexOf(n)>=0)return void t.stopPropagation()}this.isDirtyHash=this.computeHash(this.dataSource.data)}calculateMatches(){this.matchArray.length=0,this.currentMatchIndex=-1,this.currentMatchPosition=-1,this.filterValue&&(this.matchArray=this.dataSource.data.map((t,n)=>RegExp(this.filterValue,"ig").test(t.applicationName)?n:-1).filter(t=>t>=0))}isDifferent(){return this.computeHash(this.dataSource.data)!==this.isDirtyHash}get isValid(){return 0===this.dataSource.data.filter(n=>!n.formControl.valid).length}computeHash(t){const n=t.reduce((o,r)=>(o[r.id]=r.formControl.value,o),{});return De(n)}finalizeLoadingLayers(){this.dataSource.data=this.layerList.sort((t,n)=>(0,x.WQ)(t.orderNumber,n.orderNumber,!0)),this.totalLayersCount=this.layerList.length,this.isDirtyHash=De(this.dataSource.data)}mapLayerList(){return this.dataSource.data.map(t=>({orderNumber:t.formControl.value,name:t.applicationName,id:t.id}))}get allowSave(){return this.isDirty&&this.isValid}revertChanges(){this.dataSource.data=this.layerList=$()(this.layerListClone),this.totalLayersCount=this.layerList.length,this.isDirty=!1}ngOnDestroy(){this.subscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(xe.Y),e.Y36(Z.Y))},i.\u0275cmp=e.Xpm({type:i,selectors:[["recipe-layer-list"]],viewQuery:function(t,n){if(1&t&&e.Gf(y.YE,5),2&t){let o;e.iGM(o=e.CRH())&&(n.sort=o.first)}},inputs:{savingInProgress:"savingInProgress"},decls:28,vars:12,consts:[["hideToggle","",1,"mat-elevation-z0",3,"expanded"],[3,"click"],[1,"panel-header"],["class","caret",3,"iconClasses",4,"ngIf"],[1,"mb-0","title"],[1,"title"],[1,"description"],[1,"action"],["class","search",3,"click",4,"ngIf"],["mat-raised-button","","color","primary","tabindex","-1",3,"matTooltip","disabled","click"],[3,"iconClasses"],[1,"ps-show-always"],["matSort","","matSortActive","orderNumber","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange"],["matColumnDef","orderNumber"],["style","max-width: 10%; width:10%","class","pl-3 marker-column text-capitalize","mat-sort-header","",4,"matHeaderCellDef"],["style","max-width: 10%; width:10%","class","text-center pl-4 pr-3",4,"matCellDef"],["matColumnDef","applicationName"],["style","max-width: 40%; width:40%","mat-sort-header","",4,"matHeaderCellDef"],["style","max-width: 80%; width:80%",4,"matCellDef"],["matColumnDef","action"],["style","max-width: 10%; width:10%","class","pl-3","mat-sort-header","",4,"matHeaderCellDef"],["class","text-right","style","max-width: 10%; width:10%",4,"matCellDef"],["class","pl-0",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","pl-0 pr-0 pointer",3,"ngClass","matched","click",4,"matRowDef","matRowDefColumns"],[1,"caret",3,"iconClasses"],[1,"search",3,"click"],["matPrefix","",1,"mr-3"],[1,"far","fa-search"],["matInput","","placeholder","Enter your search term...",3,"keyup"],["mat-sort-header","",1,"pl-3","marker-column","text-capitalize",2,"max-width","10%","width","10%"],[1,"text-center","pl-4","pr-3",2,"max-width","10%","width","10%"],[1,"full-width"],["matInput","","name","orderNumber",3,"formControl","keyup"],[4,"ngIf"],["mat-sort-header","",2,"max-width","40%","width","40%"],[2,"max-width","80%","width","80%"],[1,"highlight",3,"innerHtml"],["mat-sort-header","",1,"pl-3",2,"max-width","10%","width","10%"],[1,"text-right",2,"max-width","10%","width","10%"],["mat-button","",3,"click"],["title","Remove package group",3,"iconClasses"],[1,"pl-0"],[1,"pl-0","pr-0","pointer",3,"ngClass","click"]],template:function(t,n){1&t&&(e.TgZ(0,"mat-expansion-panel",0),e.TgZ(1,"mat-expansion-panel-header",1),e.NdJ("click",function(){return n.expandPanel()}),e.TgZ(2,"div",2),e.YNc(3,fn,1,1,"am-icon",3),e.YNc(4,_n,1,1,"am-icon",3),e.TgZ(5,"h4",4),e.TgZ(6,"span",5),e._uU(7,"PACKAGE GROUP LIST "),e.qZA(),e.TgZ(8,"span",6),e._uU(9),e.qZA(),e.qZA(),e.TgZ(10,"div",7),e.YNc(11,vn,4,0,"mat-form-field",8),e.TgZ(12,"button",9),e.NdJ("click",function(r){return n.onAddLayersClick(r)}),e._UZ(13,"am-icon",10),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div"),e.TgZ(15,"perfect-scrollbar",11),e.TgZ(16,"mat-table",12),e.NdJ("matSortChange",function(r){return n.sortData(r)}),e.ynx(17,13),e.YNc(18,Mn,2,0,"mat-header-cell",14),e.YNc(19,yn,6,4,"mat-cell",15),e.BQk(),e.ynx(20,16),e.YNc(21,xn,2,0,"mat-header-cell",17),e.YNc(22,bn,3,6,"mat-cell",18),e.BQk(),e.ynx(23,19),e.YNc(24,An,1,0,"mat-header-cell",20),e.YNc(25,Sn,3,1,"mat-cell",21),e.BQk(),e.YNc(26,Dn,1,0,"mat-header-row",22),e.YNc(27,In,1,3,"mat-row",23),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.Q6J("expanded",n.panelOpenState),e.xp6(3),e.Q6J("ngIf",!n.panelOpenState),e.xp6(1),e.Q6J("ngIf",n.panelOpenState),e.xp6(5),e.Oqu(n.description),e.xp6(2),e.Q6J("ngIf",n.panelOpenState),e.xp6(1),e.Q6J("matTooltip","Add package groups")("disabled",n.savingInProgress),e.xp6(1),e.Q6J("iconClasses",n.icons.PLUS),e.xp6(3),e.Q6J("dataSource",n.dataSource),e.xp6(10),e.Q6J("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",n.displayedColumns))},directives:[C.ib,C.yz,u.O5,S.b,g.KE,g.qo,P.Nt,D.lW,k.gM,re.Vv,m.BZ,y.YE,m.w1,m.fO,m.ge,y.nU,m.Dz,m.ev,l.Fj,l.JJ,l.oH,g.TO,m.as,m.XQ,m.nj,m.Gk,u.mk],pipes:[be.W],styles:["mat-expansion-panel[_ngcontent-%COMP%]{border-radius:0;width:100%;border-width:0 0 1px 0;border-style:solid;border-color:#0000001f}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]{display:inline;padding:0}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]{height:60px;width:100%;padding:0 15px 0 0;display:flex;align-items:center;cursor:pointer}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{color:#9b9b9b;height:100%;padding:0 8px 0 10px;display:flex;align-items:center;cursor:pointer;width:26px}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   h4.title[_ngcontent-%COMP%]{font-size:15px;text-transform:uppercase}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:12px;font-weight:300;color:#616161;text-transform:none}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{display:inline-flex;align-items:center;font-size:12px;margin-left:auto}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{display:inline-flex}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .mat-raised-button[_ngcontent-%COMP%]{margin-left:12px;padding:2px;line-height:19px;min-width:23px;height:23px;outline:none}"]}),i})();var M=c(18248);class J{constructor(){this.enabledFormControl=new l.NI,this.startDateFormControl=new l.NI,this.startTimeFormControl=new l.NI,this.regularityFormControl=new l.NI,this.recurrenceFormControl=new l.NI,this.weekDaysFormControl=new l.NI,this.overrideMode=!1,this.model=new ce.i}get isDirty(){return this.enabledFormControl.dirty||this.startDateFormControl.dirty||this.startTimeFormControl.dirty||this.regularityFormControl.dirty||this.recurrenceFormControl.dirty||this.weekDaysFormControl.dirty}get isValid(){return this.overrideMode?(!0!==this.overrideMode||null!=this.defaultConfigurationModel)&&(null!=this.enabledFormControl.value&&!this.enabledFormControl.value||null==this.enabledFormControl.value&&!this.defaultConfigurationModel.schedulingEnabled||(!0===this.enabledFormControl.value||!0===this.defaultConfigurationModel.schedulingEnabled)&&(null!=this.regularityFormControl.value||null!=this.defaultConfigurationModel.regularity)&&(null!=this.startDateFormControl.value&&""!==this.startDateFormControl.value&&null!=this.startTimeFormControl.value&&""!==this.startTimeFormControl.value||null!=this.defaultConfigurationModel.startTime||""!==this.defaultConfigurationModel.startTime)&&(null!=this.recurrenceFormControl.value&&this.recurrenceFormControl.value>0||null!=this.defaultConfigurationModel.buildRecurrence&&this.defaultConfigurationModel.buildRecurrence>0)&&(null!=this.regularityFormControl.value&&(this.regularityFormControl.value===M.z.Daily||this.regularityFormControl.value===M.z.Weekly&&Array.isArray(this.weekDaysFormControl.value)&&this.weekDaysFormControl.value.length>0)||null==this.regularityFormControl.value&&(this.defaultConfigurationModel.regularity===M.z.Daily||this.defaultConfigurationModel.regularity===M.z.Weekly&&Array.isArray(this.defaultConfigurationModel.weekDays)))):!this.enabledFormControl.value||!0===this.enabledFormControl.value&&null!=this.regularityFormControl.value&&null!=this.startDateFormControl.value&&""!==this.startDateFormControl.value&&null!=this.startTimeFormControl.value&&""!==this.startTimeFormControl.value&&null!=this.recurrenceFormControl.value&&this.recurrenceFormControl.value>0&&(this.regularityFormControl.value===M.z.Daily||this.regularityFormControl.value===M.z.Weekly&&Array.isArray(this.weekDaysFormControl.value)&&this.weekDaysFormControl.value.length>0)}static dateNumberToString(a){let t="";return a<10&&(t+="0"),t+=a,t}static getStartDateTimeValues(a){let t=[null,null];if(null!=a.startTime&&""!==a.startTime){const n=new Date(a.startTime);t=[new Date(n.getFullYear(),n.getMonth(),n.getDate()),`${J.dateNumberToString(n.getHours())}:${J.dateNumberToString(n.getMinutes())}`]}return t}setValues(a){this.model=a,this.enabledFormControl.setValue(a.schedulingEnabled);const t=J.getStartDateTimeValues(a);this.startDateFormControl.setValue(t[0]),this.startTimeFormControl.setValue(t[1]),this.regularityFormControl.setValue(a.regularity),this.recurrenceFormControl.setValue(a.buildRecurrence),this.setWeekDaysControlValue(a.weekDays),this.toggleEnable(this.enabledFormControl.value)}setWeekDaysControlValue(a){this.weekDaysFormControl.setValue(this.overrideMode?a??[-1]:a)}setValidators(){if(!this.enabledFormControl.value||this.overrideMode&&!this.defaultConfigurationModel.schedulingEnabled)this.startDateFormControl.clearValidators(),this.startTimeFormControl.clearValidators(),this.regularityFormControl.clearValidators(),this.recurrenceFormControl.clearValidators(),this.weekDaysFormControl.clearValidators();else switch(this.overrideMode||this.startDateFormControl.setValidators(l.kI.required),this.startTimeFormControl.setValidators(this.overrideMode?L.K.timeRequired(this.startDateFormControl):l.kI.required),this.regularityFormControl.value){case M.z.Daily:this.overrideMode||this.recurrenceFormControl.setValidators(l.kI.required),this.weekDaysFormControl.setValidators(null);break;case M.z.Weekly:this.overrideMode||this.recurrenceFormControl.setValidators(l.kI.required),this.weekDaysFormControl.setValidators(l.kI.required);break;default:this.recurrenceFormControl.setValidators(null),this.weekDaysFormControl.setValidators(null)}}toggleEnable(a){const t=a||this.overrideMode&&null==a&&this.defaultConfigurationModel.schedulingEnabled?"enable":"disable";this.startDateFormControl[t](),this.startTimeFormControl[t](),this.regularityFormControl[t](),this.recurrenceFormControl[t](),this.weekDaysFormControl[t](),this.setValidators()}getModel(){let a;if(a=!0===this.enabledFormControl.value?new ce.i:$()(this.model),a.schedulingEnabled=this.enabledFormControl.value,!0===a.schedulingEnabled||this.overrideMode&&this.defaultConfigurationModel.schedulingEnabled){if(null!=this.startDateFormControl.value&&null!=this.startTimeFormControl.value){const n=this.startDateFormControl.value,o=this.startTimeFormControl.value.split(":"),r=new Date(n.getFullYear(),n.getMonth(),n.getDate(),o[0],o[1]);a.startTime=r.toISOString()}else null==this.startDateFormControl.value&&(a.startTime=null);a.regularity=this.regularityFormControl.value;const t=this.overrideMode&&null==a.regularity?this.defaultConfigurationModel.regularity:a.regularity;(t===M.z.Daily||t===M.z.Weekly)&&(a.buildRecurrence=this.recurrenceFormControl.value),t===M.z.Weekly&&(a.weekDays=this.overrideMode&&-1!==this.weekDaysFormControl.value.findIndex(n=>-1===n)?null:this.weekDaysFormControl.value)}return a}resetControls(){this.enabledFormControl.reset(this.model.schedulingEnabled);const a=J.getStartDateTimeValues(this.model);this.startDateFormControl.reset(a[0]),this.startTimeFormControl.reset(a[1]),this.regularityFormControl.reset(this.model.regularity),this.recurrenceFormControl.reset(this.model.buildRecurrence),this.setWeekDaysControlValue(this.model.weekDays),this.toggleEnable(this.model.schedulingEnabled)}resetDirty(){this.enabledFormControl.markAsPristine(),this.startDateFormControl.markAsPristine(),this.startTimeFormControl.markAsPristine(),this.regularityFormControl.markAsPristine(),this.recurrenceFormControl.markAsPristine(),this.weekDaysFormControl.markAsPristine()}}var de=c(70072),Y=c(99602);function kn(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Date is required "),e.qZA())}function Fn(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Invalid date format "),e.qZA())}function On(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Time is required "),e.qZA())}function Pn(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Recurrence is required "),e.qZA())}function Nn(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Select one or more week days "),e.qZA())}function qn(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",3),e.TgZ(1,"div",22),e.TgZ(2,"label",23),e.NdJ("click",function(){return e.CHM(t),e.MAs(7).focus()}),e._uU(3,"Recur on"),e.qZA(),e.qZA(),e.TgZ(4,"div",5),e.TgZ(5,"mat-form-field",31),e.TgZ(6,"mat-select",32,33),e.TgZ(8,"mat-option",34),e.NdJ("click",function(){return e.CHM(t),e.oxw().onWeekDaysSelectionChange(-1)}),e._uU(9),e.qZA(),e.TgZ(10,"mat-option",34),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return o.onWeekDaysSelectionChange(o.WeekDay.Monday)}),e._uU(11,"Monday"),e.qZA(),e.TgZ(12,"mat-option",34),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return o.onWeekDaysSelectionChange(o.WeekDay.Tuesday)}),e._uU(13,"Tuesday"),e.qZA(),e.TgZ(14,"mat-option",34),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return o.onWeekDaysSelectionChange(o.WeekDay.Wednesday)}),e._uU(15,"Wednesday"),e.qZA(),e.TgZ(16,"mat-option",34),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return o.onWeekDaysSelectionChange(o.WeekDay.Thursday)}),e._uU(17,"Thursday"),e.qZA(),e.TgZ(18,"mat-option",34),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return o.onWeekDaysSelectionChange(o.WeekDay.Friday)}),e._uU(19,"Friday"),e.qZA(),e.TgZ(20,"mat-option",34),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return o.onWeekDaysSelectionChange(o.WeekDay.Saturday)}),e._uU(21,"Saturday"),e.qZA(),e.TgZ(22,"mat-option",34),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return o.onWeekDaysSelectionChange(o.WeekDay.Sunday)}),e._uU(23,"Sunday"),e.qZA(),e.qZA(),e.YNc(24,Nn,2,0,"mat-error",16),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("formControl",t.viewModel.weekDaysFormControl),e.xp6(2),e.Q6J("value",-1),e.xp6(1),e.Oqu(t.weekDaysDefaultValueLabel),e.xp6(1),e.Q6J("value",t.WeekDay.Monday),e.xp6(2),e.Q6J("value",t.WeekDay.Tuesday),e.xp6(2),e.Q6J("value",t.WeekDay.Wednesday),e.xp6(2),e.Q6J("value",t.WeekDay.Thursday),e.xp6(2),e.Q6J("value",t.WeekDay.Friday),e.xp6(2),e.Q6J("value",t.WeekDay.Saturday),e.xp6(2),e.Q6J("value",t.WeekDay.Sunday),e.xp6(2),e.Q6J("ngIf",t.viewModel.weekDaysFormControl.hasError("required"))}}let ke=(()=>{class i{constructor(t){this.recipeMediator=t,this.icons=_.R.icons.fontAwesome,this.TaskRegularity=M.z,this.WeekDay=de.V,this.subscription=new I.w,this.viewModel=new J,this.viewModel.overrideMode=!0}get allowSave(){return this.viewModel.isDirty&&this.viewModel.isValid}static setValueToDefault(t){t?.setValue(null),t?.markAsDirty()}ngOnInit(){this.subscription.add(this.recipeMediator.imageSelected.pipe((0,V.h)(t=>null!=t)).subscribe(t=>{if(this.modelClone=W.G.cloneDeep(t),this.defaultConfigurationModel=t.defaultImageSchedulingConfiguration,this.viewModel.defaultConfigurationModel=this.defaultConfigurationModel,this.viewModel.setValues(t.imageSchedulingConfiguration),this.viewModel.resetDirty(),null!=this.defaultConfigurationModel.startTime&&""!==this.defaultConfigurationModel.startTime)try{this.startDateDefaultValueLabel=`Default value: ${new Date(this.defaultConfigurationModel.startTime).toString()}`}catch{}this.regularityDefaultValueLabel=`Default: ${null==this.defaultConfigurationModel?.regularity?M.z.Daily:M.z[this.defaultConfigurationModel.regularity]}`,this.recurrenceDefaultValueLabel=`Default: ${null==this.defaultConfigurationModel?.buildRecurrence?0:this.defaultConfigurationModel.buildRecurrence}`,this.weekDaysDefaultValueLabel=`Default: ${this.defaultConfigurationModel?.weekDays.map(n=>de.V[n]).join(", ")}`}))}setControlValueToDefault(t,...n){if(i.setValueToDefault(t),null!=n)for(let o=0;o<n.length;o++)i.setValueToDefault(n[o])}scheduledBuildsEnabledValueChanged(t){this.viewModel.toggleEnable(t.value)}onWeekDaysSelectionChange(t){const n=this.viewModel.weekDaysFormControl.value,o=n.findIndex(r=>-1===r);-1===t&&-1!==o?this.viewModel.weekDaysFormControl.setValue([-1]):-1!==t&&-1!==o&&(n.splice(o,1),this.viewModel.weekDaysFormControl.setValue(n))}ngOnDestroy(){this.subscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Z.Y))},i.\u0275cmp=e.Xpm({type:i,selectors:[["am-recipe-image-scheduling-configuration"]],decls:63,vars:32,consts:[["hideToggle","",1,"mat-elevation-z0"],["schedulingPanel",""],[3,"expanded"],[1,"setting","bt-1"],[1,"setting-label","br-1",3,"click"],[1,"setting-value"],["floatLabel","never"],[3,"formControl","placeholder","selectionChange"],["schedulingEnabledSelect",""],[3,"value"],["for","buildStartDate",1,"setting-label","br-1"],[1,"setting-value","start-date"],["floatLabel","never",1,"start-date-form-field"],["id","buildStartDate","matInput","","placeholder","Default",3,"formControl","matDatepicker"],["matSuffix","",3,"for"],["buildStartDatePicker",""],[4,"ngIf"],["floatLabel","never",1,"start-time-form-field"],["matInput","","type","time",3,"formControl","blur"],["mat-icon-button","","matTooltip","Reset to default value",1,"reset-default-button",3,"disabled","click"],[3,"iconClasses"],[1,"time-zone-label"],[1,"setting-label","br-1"],[3,"click"],["id","taskRegularity",3,"formControl","placeholder"],["taskRegularitySelect",""],["for","taskRecurrence"],["floatLabel","never",1,"recurrence-form-field"],["id","taskRecurrence","matInput","","maxlength","3","type","number",3,"formControl","max","min","placeholder"],["mat-icon-button","","matSuffix","","matTooltip","Reset to default value",1,"reset-default-suffix-button",3,"disabled","click"],["class","setting bt-1",4,"ngIf"],["floatLabel","never",1,"week-days-form-field","full-width"],["multiple","",3,"formControl"],["weekDaysSelect",""],[3,"value","click"]],template:function(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"mat-expansion-panel",0,1),e.TgZ(2,"mat-expansion-panel-header"),e.TgZ(3,"mat-panel-title"),e._UZ(4,"am-caret",2),e._uU(5," Image Scheduling "),e.qZA(),e.qZA(),e.TgZ(6,"div",3),e.TgZ(7,"label",4),e.NdJ("click",function(){return e.CHM(o),e.MAs(12).focus()}),e._uU(8,"Enable scheduled builds"),e.qZA(),e.TgZ(9,"div",5),e.TgZ(10,"mat-form-field",6),e.TgZ(11,"mat-select",7,8),e.NdJ("selectionChange",function(s){return n.scheduledBuildsEnabledValueChanged(s)}),e.TgZ(13,"mat-option",9),e._uU(14),e.qZA(),e.TgZ(15,"mat-option",9),e._uU(16,"Yes"),e.qZA(),e.TgZ(17,"mat-option",9),e._uU(18,"No"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"div",3),e.TgZ(20,"label",10),e._uU(21,"Build start time"),e.qZA(),e.TgZ(22,"div",11),e.TgZ(23,"mat-form-field",12),e._UZ(24,"input",13),e._UZ(25,"mat-datepicker-toggle",14),e._UZ(26,"mat-datepicker",null,15),e.YNc(28,kn,2,0,"mat-error",16),e.YNc(29,Fn,2,0,"mat-error",16),e.qZA(),e.TgZ(30,"mat-form-field",17),e.TgZ(31,"input",18),e.NdJ("blur",function(){return n.viewModel.startTimeFormControl.updateValueAndValidity()}),e.qZA(),e.YNc(32,On,2,0,"mat-error",16),e.qZA(),e.TgZ(33,"button",19),e.NdJ("click",function(){return n.setControlValueToDefault(n.viewModel.startDateFormControl,n.viewModel.startTimeFormControl)}),e._UZ(34,"am-icon",20),e.qZA(),e.TgZ(35,"p",21),e._uU(36),e.qZA(),e.qZA(),e.qZA(),e.TgZ(37,"div",3),e.TgZ(38,"div",22),e.TgZ(39,"label",23),e.NdJ("click",function(){return e.CHM(o),e.MAs(44).focus()}),e._uU(40,"Regularity"),e.qZA(),e.qZA(),e.TgZ(41,"div",5),e.TgZ(42,"mat-form-field",6),e.TgZ(43,"mat-select",24,25),e.TgZ(45,"mat-option",9),e._uU(46),e.qZA(),e.TgZ(47,"mat-option",9),e._uU(48,"Daily"),e.qZA(),e.TgZ(49,"mat-option",9),e._uU(50,"Weekly"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(51,"div",3),e.TgZ(52,"div",22),e.TgZ(53,"label",26),e._uU(54,"Recur every"),e.qZA(),e.qZA(),e.TgZ(55,"div",5),e.TgZ(56,"mat-form-field",27),e._UZ(57,"input",28),e.TgZ(58,"button",29),e.NdJ("click",function(){return n.setControlValueToDefault(n.viewModel.recurrenceFormControl)}),e._UZ(59,"am-icon",20),e.qZA(),e.YNc(60,Pn,2,0,"mat-error",16),e.qZA(),e._uU(61),e.qZA(),e.qZA(),e.YNc(62,qn,25,11,"div",30),e.qZA()}if(2&t){const o=e.MAs(1),r=e.MAs(27);e.xp6(4),e.Q6J("expanded",o.expanded),e.xp6(7),e.MGl("placeholder","Default: ",!0===(null==n.modelClone||null==n.modelClone.defaultImageSchedulingConfiguration?null:n.modelClone.defaultImageSchedulingConfiguration.schedulingEnabled)?"Yes":"No",""),e.Q6J("formControl",n.viewModel.enabledFormControl),e.xp6(2),e.Q6J("value",null),e.xp6(1),e.hij(" Default: ",!0===(null==n.modelClone||null==n.modelClone.defaultImageSchedulingConfiguration?null:n.modelClone.defaultImageSchedulingConfiguration.schedulingEnabled)?"Yes":"No"," "),e.xp6(1),e.Q6J("value",!0),e.xp6(2),e.Q6J("value",!1),e.xp6(7),e.Q6J("formControl",n.viewModel.startDateFormControl)("matDatepicker",r),e.xp6(1),e.Q6J("for",r),e.xp6(3),e.Q6J("ngIf",n.viewModel.startDateFormControl.hasError("required")),e.xp6(1),e.Q6J("ngIf",n.viewModel.startDateFormControl.hasError("matDatepickerParse")),e.xp6(2),e.Q6J("formControl",n.viewModel.startTimeFormControl),e.xp6(1),e.Q6J("ngIf",n.viewModel.startTimeFormControl.hasError("required")||n.viewModel.startTimeFormControl.hasError("timeRequired")),e.xp6(1),e.Q6J("disabled",null==n.viewModel.startDateFormControl.value&&null==n.viewModel.startTimeFormControl.value),e.xp6(1),e.Q6J("iconClasses",n.icons.UNDO),e.xp6(2),e.Oqu(n.startDateDefaultValueLabel),e.xp6(7),e.Q6J("formControl",n.viewModel.regularityFormControl)("placeholder",n.regularityDefaultValueLabel),e.xp6(2),e.Q6J("value",null),e.xp6(1),e.Oqu(n.regularityDefaultValueLabel),e.xp6(1),e.Q6J("value",n.TaskRegularity.Daily),e.xp6(2),e.Q6J("value",n.TaskRegularity.Weekly),e.xp6(8),e.Q6J("formControl",n.viewModel.recurrenceFormControl)("max",999)("min",1)("placeholder",n.recurrenceDefaultValueLabel),e.xp6(1),e.Q6J("disabled",null==n.viewModel.recurrenceFormControl.value),e.xp6(1),e.Q6J("iconClasses",n.icons.UNDO),e.xp6(1),e.Q6J("ngIf",n.viewModel.recurrenceFormControl.hasError("required")),e.xp6(1),e.hij(" ",n.viewModel.regularityFormControl.value===n.TaskRegularity.Daily||n.viewModel.overrideMode&&null==n.viewModel.regularityFormControl.value&&(null==n.viewModel.defaultConfigurationModel?null:n.viewModel.defaultConfigurationModel.regularity)===n.TaskRegularity.Daily?"days":"weeks"," "),e.xp6(1),e.Q6J("ngIf",n.viewModel.regularityFormControl.value===n.TaskRegularity.Weekly||null==n.viewModel.regularityFormControl.value&&(null==n.defaultConfigurationModel?null:n.defaultConfigurationModel.regularity)===n.TaskRegularity.Weekly)}},directives:[C.ib,C.yz,C.yK,q,g.KE,j.gD,l.JJ,l.oH,z.ey,P.Nt,l.Fj,Y.hl,Y.nW,g.R9,Y.Mq,u.O5,g.TO,D.lW,k.gM,S.b,l.wV,l.Fd,l.qQ,l.nD],styles:["mat-expansion-panel[_ngcontent-%COMP%]{border-radius:0}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]{display:inline;padding:0}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   mat-panel-title[_ngcontent-%COMP%]{height:60px;width:100%;padding:0 15px 0 0;display:flex;align-items:center;cursor:pointer;font-size:15px;text-transform:uppercase;color:#565656;font-weight:500}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   mat-panel-title[_ngcontent-%COMP%]   am-caret[_ngcontent-%COMP%]{color:#9b9b9b;padding:0 8px 0 10px;width:26px}.setting[_ngcontent-%COMP%]{display:flex;flex-direction:row;font-size:.8rem;padding-left:15px;padding-right:15px;align-items:stretch}.setting[_ngcontent-%COMP%]   .setting-label[_ngcontent-%COMP%]{flex:0 0 25%;padding-top:1rem;padding-bottom:1rem;margin-bottom:0}.setting[_ngcontent-%COMP%]   .setting-value[_ngcontent-%COMP%]{flex-grow:1;padding-left:15px;align-self:center}.setting[_ngcontent-%COMP%]:nth-child(odd){background-color:#fbfbfb}.setting[_ngcontent-%COMP%]:nth-child(even){background-color:#fff}.br-1[_ngcontent-%COMP%]{border-right:1px solid rgba(0,0,0,.125)}.bt-1[_ngcontent-%COMP%]{border-top:1px solid rgba(0,0,0,.125)}.reset-default-button[_ngcontent-%COMP%]{outline:none;color:#616161}.reset-default-suffix-button[_ngcontent-%COMP%]{color:#616161}.start-date-form-field[_ngcontent-%COMP%]{width:110px}.start-time-form-field[_ngcontent-%COMP%]{margin-left:15px;width:100px}.time-zone-label[_ngcontent-%COMP%]{font-size:.85em;color:#424242}.recurrence-form-field[_ngcontent-%COMP%]{width:100px}"]}),i})();var Un=c(57435);class Rn{constructor(){this.autoinstallWindowsUpdatesFormControl=new l.NI(this.autoinstallWindowsUpdates),this.manageWindowsUpdatesServiceFormControl=new l.NI(this.manageWindowsUpdatesService),this.includeRecommendedUpdatesFormControl=new l.NI(this.includeRecommendedUpdates),this.includeOtherUpdatesFormControl=new l.NI(this.includeOtherUpdates),this.enableMicrosoftUpdateFormControl=new l.NI(this.enableMicrosoftUpdate)}resetDirty(){this.autoinstallWindowsUpdatesFormControl.reset(this.autoinstallWindowsUpdates),this.manageWindowsUpdatesServiceFormControl.reset(this.manageWindowsUpdatesService),this.includeRecommendedUpdatesFormControl.reset(this.includeRecommendedUpdates),this.includeOtherUpdatesFormControl.reset(this.includeOtherUpdates),this.enableMicrosoftUpdateFormControl.reset(this.enableMicrosoftUpdate)}get isDirty(){return this.autoinstallWindowsUpdatesFormControl.dirty||this.manageWindowsUpdatesServiceFormControl.dirty||this.includeRecommendedUpdatesFormControl.dirty||this.includeOtherUpdatesFormControl.dirty||this.enableMicrosoftUpdateFormControl.dirty}}let Fe=(()=>{class i{constructor(t){this.imageSubject=t,this.icons=_.R.icons.fontAwesome,this.onAutoinstallWindowsUpdatesChanged=new p.xQ,this.onManageWindowsUpdatesServiceChanged=new p.xQ,this.onIncludeRecommendedUpdatesChanged=new p.xQ,this.onIncludeOtherUpdatesChanged=new p.xQ,this.onEnableMicrosoftUpdateChanged=new p.xQ,this.subscription=new I.w,this.viewModel=new Rn}ngOnInit(){this.subscription.add(this.imageSubject.imageSelected.subscribe(t=>{t&&(this.modelClone=W.G.cloneDeep(t),this.mapModelToForm(t),this.viewModel.resetDirty(),this.mapFormControlValuesToDataModel())}))}ngAfterViewInit(){this.subscription.add(this.onAutoinstallWindowsUpdatesChanged.subscribe(t=>{this.viewModel.autoinstallWindowsUpdates=t.value,this.onInputChange()})),this.subscription.add(this.onManageWindowsUpdatesServiceChanged.subscribe(t=>{this.viewModel.manageWindowsUpdatesService=t.value,this.onInputChange()})),this.subscription.add(this.onIncludeRecommendedUpdatesChanged.subscribe(t=>{this.viewModel.includeRecommendedUpdates=t.value,this.onInputChange()})),this.subscription.add(this.onIncludeOtherUpdatesChanged.subscribe(t=>{this.viewModel.includeOtherUpdates=t.value,this.onInputChange()})),this.subscription.add(this.onEnableMicrosoftUpdateChanged.subscribe(t=>{this.viewModel.enableMicrosoftUpdate=t.value,this.onInputChange()}))}mapModelToForm(t){this.viewModel.defaultAutoinstallWindowsUpdates=t.defaultWindowsUpdatesConfiguration.autoinstallWindowsUpdates,this.viewModel.autoinstallWindowsUpdates=t.windowsUpdatesConfiguration.autoinstallWindowsUpdates,this.viewModel.autoinstallWindowsUpdatesFormControl.setValue(this.viewModel.autoinstallWindowsUpdates),this.viewModel.defaultManageWindowsUpdatesService=t.defaultWindowsUpdatesConfiguration.manageWindowsUpdatesService,this.viewModel.manageWindowsUpdatesService=t.windowsUpdatesConfiguration.manageWindowsUpdatesService,this.viewModel.manageWindowsUpdatesServiceFormControl.setValue(this.viewModel.manageWindowsUpdatesService),this.viewModel.defaultIncludeRecommendedUpdates=t.defaultWindowsUpdatesConfiguration.includeRecommendedUpdates,this.viewModel.includeRecommendedUpdates=t.windowsUpdatesConfiguration.includeRecommendedUpdates,this.viewModel.includeRecommendedUpdatesFormControl.setValue(this.viewModel.includeRecommendedUpdates),this.viewModel.defaultIncludeOtherUpdates=t.defaultWindowsUpdatesConfiguration.includeOtherUpdates,this.viewModel.includeOtherUpdates=t.windowsUpdatesConfiguration.includeOtherUpdates,this.viewModel.includeOtherUpdatesFormControl.setValue(this.viewModel.includeOtherUpdates),this.viewModel.defaultEnableMicrosoftUpdate=t.defaultWindowsUpdatesConfiguration.enableMicrosoftUpdate,this.viewModel.enableMicrosoftUpdate=t.windowsUpdatesConfiguration.enableMicrosoftUpdate,this.viewModel.enableMicrosoftUpdateFormControl.setValue(this.viewModel.enableMicrosoftUpdate)}mapFormControlValuesToDataModel(){null!=this.modelClone&&(this.model={autoinstallWindowsUpdates:this.viewModel.autoinstallWindowsUpdatesFormControl.value,manageWindowsUpdatesService:this.viewModel.manageWindowsUpdatesServiceFormControl.value,includeRecommendedUpdates:this.viewModel.includeRecommendedUpdatesFormControl.value,includeOtherUpdates:this.viewModel.includeOtherUpdatesFormControl.value,enableMicrosoftUpdate:this.viewModel.enableMicrosoftUpdateFormControl.value})}onInputChange(){null!=this.modelClone&&this.mapFormControlValuesToDataModel()}get allowSave(){return this.viewModel.isDirty}revertChanges(){this.mapModelToForm(this.modelClone),this.viewModel.resetDirty()}ngOnDestroy(){this.subscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Z.Y))},i.\u0275cmp=e.Xpm({type:i,selectors:[["windows-updates-configuration"]],decls:64,vars:26,consts:[["hideToggle","",1,"mat-elevation-z0"],["panel",""],[1,"panel-header"],[3,"expanded"],[1,"mb-0","title"],[1,"title"],[1,"container","striped",2,"background","#FFF"],[1,"row","mt-0","pointer","read-only","align-items-center","bt-1"],[1,"col-lg-3","pt-3","pb-3","br-1"],[1,"col","pt-0","pb-0"],[3,"formControl","placeholder","selectionChange"],[3,"value"]],template:function(t,n){if(1&t&&(e.TgZ(0,"mat-expansion-panel",0,1),e.TgZ(2,"mat-expansion-panel-header"),e.TgZ(3,"div",2),e._UZ(4,"am-caret",3),e.TgZ(5,"h4",4),e.TgZ(6,"span",5),e._uU(7,"WINDOWS UPDATES"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"div",6),e.TgZ(9,"div",7),e.TgZ(10,"div",8),e._uU(11," Autoinstall windows updates "),e.qZA(),e.TgZ(12,"div",9),e.TgZ(13,"mat-select",10),e.NdJ("selectionChange",function(r){return n.onAutoinstallWindowsUpdatesChanged.next(r)}),e.TgZ(14,"mat-option"),e._uU(15),e.qZA(),e.TgZ(16,"mat-option",11),e._uU(17,"Yes"),e.qZA(),e.TgZ(18,"mat-option",11),e._uU(19,"No"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(20,"div",7),e.TgZ(21,"div",8),e._uU(22," Manage Windows updates service "),e.qZA(),e.TgZ(23,"div",9),e.TgZ(24,"mat-select",10),e.NdJ("selectionChange",function(r){return n.onManageWindowsUpdatesServiceChanged.next(r)}),e.TgZ(25,"mat-option"),e._uU(26),e.qZA(),e.TgZ(27,"mat-option",11),e._uU(28,"Yes"),e.qZA(),e.TgZ(29,"mat-option",11),e._uU(30,"No"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(31,"div",7),e.TgZ(32,"div",8),e._uU(33," Include recommended updates "),e.qZA(),e.TgZ(34,"div",9),e.TgZ(35,"mat-select",10),e.NdJ("selectionChange",function(r){return n.onIncludeRecommendedUpdatesChanged.next(r)}),e.TgZ(36,"mat-option"),e._uU(37),e.qZA(),e.TgZ(38,"mat-option",11),e._uU(39,"Yes"),e.qZA(),e.TgZ(40,"mat-option",11),e._uU(41,"No"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(42,"div",7),e.TgZ(43,"div",8),e._uU(44," Include other updates "),e.qZA(),e.TgZ(45,"div",9),e.TgZ(46,"mat-select",10),e.NdJ("selectionChange",function(r){return n.onIncludeOtherUpdatesChanged.next(r)}),e.TgZ(47,"mat-option"),e._uU(48),e.qZA(),e.TgZ(49,"mat-option",11),e._uU(50,"Yes"),e.qZA(),e.TgZ(51,"mat-option",11),e._uU(52,"No"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(53,"div",7),e.TgZ(54,"div",8),e._uU(55," Enable Microsoft updates "),e.qZA(),e.TgZ(56,"div",9),e.TgZ(57,"mat-select",10),e.NdJ("selectionChange",function(r){return n.onEnableMicrosoftUpdateChanged.next(r)}),e.TgZ(58,"mat-option"),e._uU(59),e.qZA(),e.TgZ(60,"mat-option",11),e._uU(61,"Yes"),e.qZA(),e.TgZ(62,"mat-option",11),e._uU(63,"No"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t){const o=e.MAs(1);e.xp6(4),e.Q6J("expanded",o.expanded),e.xp6(9),e.s9C("placeholder",n.viewModel.defaultAutoinstallWindowsUpdates?"Yes":"No"),e.Q6J("formControl",n.viewModel.autoinstallWindowsUpdatesFormControl),e.xp6(2),e.hij("Default: ",n.viewModel.defaultAutoinstallWindowsUpdates?"Yes":"No",""),e.xp6(1),e.Q6J("value",!0),e.xp6(2),e.Q6J("value",!1),e.xp6(6),e.s9C("placeholder",n.viewModel.defaultManageWindowsUpdatesService?"Yes":"No"),e.Q6J("formControl",n.viewModel.manageWindowsUpdatesServiceFormControl),e.xp6(2),e.hij("Default: ",n.viewModel.defaultManageWindowsUpdatesService?"Yes":"No",""),e.xp6(1),e.Q6J("value",!0),e.xp6(2),e.Q6J("value",!1),e.xp6(6),e.s9C("placeholder",n.viewModel.defaultIncludeRecommendedUpdates?"Yes":"No"),e.Q6J("formControl",n.viewModel.includeRecommendedUpdatesFormControl),e.xp6(2),e.hij("Default: ",n.viewModel.defaultIncludeRecommendedUpdates?"Yes":"No",""),e.xp6(1),e.Q6J("value",!0),e.xp6(2),e.Q6J("value",!1),e.xp6(6),e.s9C("placeholder",n.viewModel.defaultIncludeOtherUpdates?"Yes":"No"),e.Q6J("formControl",n.viewModel.includeOtherUpdatesFormControl),e.xp6(2),e.hij("Default: ",n.viewModel.defaultIncludeOtherUpdates?"Yes":"No",""),e.xp6(1),e.Q6J("value",!0),e.xp6(2),e.Q6J("value",!1),e.xp6(6),e.s9C("placeholder",n.viewModel.defaultEnableMicrosoftUpdate?"Yes":"No"),e.Q6J("formControl",n.viewModel.enableMicrosoftUpdateFormControl),e.xp6(2),e.hij("Default: ",n.viewModel.defaultEnableMicrosoftUpdate?"Yes":"No",""),e.xp6(1),e.Q6J("value",!0),e.xp6(2),e.Q6J("value",!1)}},directives:[C.ib,C.yz,q,j.gD,l.JJ,l.oH,z.ey],styles:["mat-expansion-panel[_ngcontent-%COMP%]{border-radius:0;border-width:0 0 1px 0;border-style:solid;border-color:#0000001f;width:100%}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]{display:inline;padding:0}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]{height:60px;width:100%;padding:0 15px 0 0;display:flex;align-items:center;cursor:pointer}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   am-caret[_ngcontent-%COMP%]{color:#9b9b9b;height:100%;padding:0 8px 0 10px;display:flex;align-items:center;cursor:pointer}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .panel-header[_ngcontent-%COMP%]   h4.title[_ngcontent-%COMP%]{font-size:15px;text-transform:uppercase}mat-expansion-panel[_ngcontent-%COMP%]   .bt-1[_ngcontent-%COMP%]{border-top:1px solid rgba(0,0,0,.125)}"]}),i})();var Oe=c(12333),me=c(17974),Pe=c(31491),Jn=c(57196);function Qn(i,a){if(1&i&&(e.TgZ(0,"a",6),e._uU(1,"Recipe Details"),e.qZA()),2&i){const t=e.oxw();e.Q6J("routerLink",t.imageSubject.getRecipeUrl(t.recipeId))("active",!0)}}function Vn(i,a){if(1&i&&(e.TgZ(0,"am-spinner-label"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.savingSpinnerLabel)}}function Ln(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"loading-container",7),e.TgZ(1,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().navigateToRecipeList()}),e._UZ(2,"am-icon",9),e._uU(3," BACK TO RECIPES "),e.qZA(),e.TgZ(4,"form-section",10),e.TgZ(5,"div",11),e.TgZ(6,"mat-accordion",12),e.TgZ(7,"recipe-head",13),e.NdJ("kickOffDeploy",function(){return e.CHM(t),e.oxw().onDeployRequested()}),e.qZA(),e._UZ(8,"virtual-machine-details"),e._UZ(9,"recipe-configuration"),e._UZ(10,"windows-updates-configuration"),e._UZ(11,"recipe-layer-list",14),e._UZ(12,"recipe-package-list",14),e._UZ(13,"am-recipe-image-scheduling-configuration"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div",15),e.TgZ(15,"div",16),e.YNc(16,Vn,2,1,"am-spinner-label",17),e.qZA(),e.TgZ(17,"div",18),e.TgZ(18,"button",19),e.NdJ("click",function(){return e.CHM(t),e.oxw().revertChanges()}),e._uU(19,"REVERT"),e.qZA(),e.TgZ(20,"button",20),e.NdJ("click",function(){return e.CHM(t),e.oxw().commitChanges()}),e._uU(21,"SAVE"),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("loading",t.recipeLoading)("loadingText","Loading vCenter resources"),e.xp6(2),e.Q6J("iconClasses",t.icons.fontAwesome.CHEVRON_LEFT)("title","Back"),e.xp6(2),e.Q6J("icon",t.icons.fontAwesome.INFO_CIRCLE)("title","RECIPE DETAILS"),e.xp6(3),e.Q6J("recipeIsDirty",t.allowRevert||t.savingInProgress),e.xp6(4),e.Q6J("savingInProgress",t.savingInProgress),e.xp6(1),e.Q6J("savingInProgress",t.savingInProgress),e.xp6(4),e.Q6J("ngIf",t.savingInProgress),e.xp6(2),e.Q6J("disabled",!t.allowRevert),e.xp6(2),e.Q6J("disabled",!t.allowSave)}}let En=(()=>{class i{constructor(t,n,o,r,s,d,h,w,f,te,Eo,Yo){this.imageSubject=t,this.router=n,this.route=o,this.imageManagementHttpService=r,this.dataRepositoryService=s,this.hypervisorResourcesService=d,this.messagingService=h,this.tristateService=w,this.messageDialogService=f,this.matDialog=te,this.hotkeysService=Eo,this.changeDetector=Yo,this.icons=_.R.icons,this.subscription=new I.w,this.savingInProgress=!1,this.savingSpinnerLabel="Saving...",this.resolveRecipeIdFromUrl()}ngOnInit(){this.hotkeysService.add(new A.qm("esc",()=>(this.navigateToRecipeList(),!1),E.C.hotkeysAllowIn,"Back to recipes")),this.hotkeysService.add(new A.qm("alt+b",()=>(!this.allowRevert&&!this.recipeHeadComponent?.modelClone?.recipeSelection.isNew&&this.recipeHeadComponent.onDeployClick(),!1),E.C.hotkeysAllowIn,this.recipeId!==O.c.Empty?"Build image":null)),this.hotkeysService.add(new A.qm("alt+r",()=>(this.allowRevert&&this.revertChanges(),!1),E.C.hotkeysAllowIn,"Revert changes")),this.hotkeysService.add(new A.qm("ctrl+s",()=>(this.allowSave&&this.commitChanges(),!1),E.C.hotkeysAllowIn,"Save changes")),this.subscription.add(this.dataRepositoryService.currentEnvironmentSubject.subscribe(t=>{this.selectedEnvironment=t,this.subscription.add(this.imageSubject.configurationLoaded.subscribe(n=>{null!=n&&n!==this.imageSubject.emptyGlobalConfiguration&&(this.isConfigOk=this.imageSubject.checkInitialConfiguration(n,!1),this.globalConfigLoaded=!0,this.checkConfig(t.id))}))}))}ngAfterViewInit(){this.changeDetector.detectChanges()}resolveRecipeIdFromUrl(){if(this.recipeId=null,this.router.url.startsWith(`${v.l.recipesUrl}/`)){const n=this.route.snapshot.paramMap.get("id");O.c.isGuidFormat(n)&&(this.recipeId=n)}}checkConfig(t){this.recipeLoading=!0,this.isConfigOk?this.hypervisorResourcesService.finishedInitialLoading.value?this.readHypervisorResourcesIfNeeded(t):this.subscription.add(this.hypervisorResourcesService.finishedInitialLoading.subscribe(n=>{n&&this.readHypervisorResourcesIfNeeded(t)})):(this.recipeLoading=!1,this.messagingService.sendErrorMessage("Please enter valid details in the configuration tab",!0),this.router.navigate([v.l.configurationUrl]))}readHypervisorResourcesIfNeeded(t){0!==this.hypervisorResourcesService.hypervisorResources?.value?.errors.length?this.subscription.add(this.hypervisorResourcesService.readHypervisorResources(t).subscribe(n=>{this.hypervisorResourcesService.hypervisorResources.next(n)},n=>{const o=new Un.v;o.errors=[n.message.toString()],this.hypervisorResourcesService.hypervisorResources.next(o)},()=>{this.openRecipe()})):this.openRecipe()}openRecipe(){this.subscription.add(this.imageSubject.imageSelected.subscribe(t=>{t&&O.c.isEmpty(this.recipeId)&&this.recipeId!==t.recipeSelection.getRecipeId()&&(this.recipeId=t.recipeSelection.getRecipeId()),null==t||t.recipeSelection.getRecipeId()!==this.recipeId?this.subscription.add((0,Ce.$R)(this.hypervisorResourcesService.hypervisorResources.pipe((0,V.h)(n=>null!=n)),this.imageManagementHttpService.getVirtualDisks(this.selectedEnvironment.id,this.recipeId)).subscribe(n=>{this.setVirtualDisks(n[1]),this.imageManagementHttpService.getRecipe(this.recipeId,this.selectedEnvironment.id).subscribe(o=>{this.recipeLoading=!1,o.id&&(this.model=this.imageSubject.mapImageModel(o),this.imageSubject.imageSelected.next(this.model))},o=>{console.log(o),this.recipeLoading=!1,this.navigateToRecipeList()})})):this.imageSubject.previousRouteUrl?.value===v.l.recipesUrl?this.imageManagementHttpService.getVirtualDisks(this.selectedEnvironment.id,this.recipeId).subscribe(n=>{this.setVirtualDisks(n),this.model=t,this.recipeLoading=!1}):(this.model=t,this.recipeLoading=!1)}))}setVirtualDisks(t){const n=this.hypervisorResourcesService.hypervisorResources.value;n.virtualDisks=t,this.hypervisorResourcesService.hypervisorResources.next(n)}navigateToRecipeList(){this.router.navigate([v.l.recipesUrl])}onDeployRequested(){null!=this.model&&this.messageDialogService.openConfirmationDialog(`Do you want to deploy "${this.model.recipeSelection.name}" recipe?`).subscribe(t=>{if("Confirmed"===t){const n=new _e.S;n.id=this.model.recipeSelection.getRecipeId(),n.name=this.model.recipeSelection.name,this.imageSubject.startDeployment(n,this.selectedEnvironment.id)}})}revertChanges(){this.recipeHeadComponent.revertChanges(),this.virtualMachineDetailsComponent.revertChanges(),this.recipeConfigurationComponent.revertChanges(),this.windowsUpdatesConfigurationComponent.revertChanges(),this.recipePackageListComponent.revertChanges(),this.recipeLayerListComponent.revertChanges(),this.recipeImageSchedulingConfigurationComponent.viewModel.resetControls(),this.messagingService.sendInfoMessage(`Recipe ${this.recipeHeadComponent.model.recipeSelection.name} changes have been reverted.`)}commitChanges(){this.savingInProgress=!0;const t=this.getRecipeCreationModel();this.imageSubject.saveRecipe(t).subscribe(n=>{n.succeeded&&(t.recipeSelection.isNew?(this.router.navigate([v.l.getRecipeUrl(n.id)]),this.messagingService.sendInfoMessage(`Recipe ${t.recipeSelection.name} has been created.`)):this.messagingService.sendInfoMessage(`Recipe ${t.recipeSelection.name} has been edited.`)),this.savingInProgress=!1},()=>{this.revertChanges(),this.savingInProgress=!1},()=>{this.savingInProgress=!1})}getRecipeCreationModel(){const t=new Xe;return t.recipeSelection=this.recipeHeadComponent.model.recipeSelection,t.virtualMachine=this.virtualMachineDetailsComponent.model.virtualMachine,t.collectionOuPath=this.recipeConfigurationComponent.model.collectionOuPath,t.targetPlatform=this.virtualMachineDetailsComponent.model.targetPlatform,t.credentials=this.recipeConfigurationComponent.model.credentials,t.imageCapture=this.recipeConfigurationComponent.model.imageCapture,t.windowsUpdatesConfiguration=this.windowsUpdatesConfigurationComponent.model,t.packageList=this.recipePackageListComponent.mapPackageList(),t.layerList=this.recipeLayerListComponent.mapLayerList(),t.imageSchedulingConfiguration=this.recipeImageSchedulingConfigurationComponent.viewModel.getModel(),t}get allowRevert(){return!this.savingInProgress&&(this.recipeHeadComponent?.viewModel.isDirty||this.virtualMachineDetailsComponent?.viewModel.isDirty||this.recipeConfigurationComponent?.viewModel.isDirty||this.windowsUpdatesConfigurationComponent?.viewModel.isDirty||this.recipePackageListComponent?.isDirty||this.recipeLayerListComponent?.isDirty||this.recipeImageSchedulingConfigurationComponent?.viewModel.isDirty)}get allowSave(){return this.recipeHeadComponent?.modelClone?.recipeSelection.isNew?!this.savingInProgress&&this.recipeHeadComponent?.allowSave&&this.virtualMachineDetailsComponent?.viewModel.isValid&&this.recipeConfigurationComponent?.viewModel.isValid&&this.recipePackageListComponent?.isValid&&this.recipeLayerListComponent?.isValid:!this.savingInProgress&&(this.recipeHeadComponent?.allowSave&&this.virtualMachineDetailsComponent?.viewModel.isValid&&this.recipeConfigurationComponent?.viewModel.isValid&&this.recipePackageListComponent?.isValid&&this.recipeLayerListComponent?.isValid&&this.recipeImageSchedulingConfigurationComponent?.viewModel?.isValid||this.virtualMachineDetailsComponent?.allowSave&&this.recipeHeadComponent?.viewModel.isValid&&this.recipeConfigurationComponent?.viewModel.isValid&&this.recipePackageListComponent?.isValid&&this.recipeLayerListComponent?.isValid&&this.recipeImageSchedulingConfigurationComponent?.viewModel?.isValid||this.recipeConfigurationComponent?.allowSave&&this.recipeHeadComponent?.viewModel.isValid&&this.virtualMachineDetailsComponent?.viewModel.isValid&&this.recipePackageListComponent?.isValid&&this.recipeLayerListComponent?.isValid&&this.recipeImageSchedulingConfigurationComponent?.viewModel?.isValid||this.windowsUpdatesConfigurationComponent?.allowSave&&this.recipeHeadComponent?.viewModel.isValid&&this.virtualMachineDetailsComponent?.viewModel.isValid&&this.recipeConfigurationComponent?.viewModel.isValid&&this.recipePackageListComponent?.isValid&&this.recipeLayerListComponent?.isValid&&this.recipeImageSchedulingConfigurationComponent?.viewModel?.isValid||this.recipePackageListComponent?.allowSave&&this.recipeHeadComponent?.viewModel.isValid&&this.virtualMachineDetailsComponent?.viewModel.isValid&&this.recipeConfigurationComponent?.viewModel.isValid&&this.recipeLayerListComponent.isValid&&this.recipeImageSchedulingConfigurationComponent?.viewModel?.isValid||this.recipeLayerListComponent?.allowSave&&this.recipeHeadComponent?.viewModel.isValid&&this.virtualMachineDetailsComponent?.viewModel.isValid&&this.recipeConfigurationComponent?.viewModel.isValid&&this.recipePackageListComponent?.isValid&&this.recipeImageSchedulingConfigurationComponent?.viewModel?.isValid||this.recipeImageSchedulingConfigurationComponent?.allowSave&&this.recipeHeadComponent?.viewModel.isValid&&this.virtualMachineDetailsComponent?.viewModel.isValid&&this.recipeConfigurationComponent?.viewModel.isValid&&this.recipePackageListComponent?.isValid&&this.recipeLayerListComponent?.isValid)}canDeactivate(){if(this.allowRevert){const t=new p.xQ;return this.tristateService.openDialog("Do you want to save changes?","Your changes will be lost if you don't save them.",this.allowSave).subscribe(n=>{"Confirmed"===n?this.saveUnsavedChanges().subscribe(o=>{t.next(o)}):"UnConfirmed"===n?t.next(!0):"Canceled"===n&&t.next(!1)}),t.asObservable()}return!0}saveUnsavedChanges(){return this.imageSubject.saveRecipe(this.getRecipeCreationModel()).pipe((0,fe.U)(t=>t.succeeded))}ngOnDestroy(){this.subscription.unsubscribe(),this.imageSubject.imageSelected.next(null),this.hotkeysService.remove(this.hotkeysService.hotkeys.filter(t=>"alt+b"===t.combo[0]||"esc"===t.combo[0]||"alt+r"===t.combo[0]||"ctrl+s"===t.combo[0]))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Z.Y),e.Y36(b.F0),e.Y36(b.gz),e.Y36(X.f),e.Y36(H.Y),e.Y36(we.N),e.Y36(R.w),e.Y36(Oe.S),e.Y36(me.T),e.Y36(N.uw),e.Y36(A.tm),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["recipe-details"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Me,5),e.Gf(Ze,5),e.Gf(Te,5),e.Gf(Fe,5),e.Gf(Se,5),e.Gf(Ie,5),e.Gf(ke,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.recipeHeadComponent=o.first),e.iGM(o=e.CRH())&&(n.virtualMachineDetailsComponent=o.first),e.iGM(o=e.CRH())&&(n.recipeConfigurationComponent=o.first),e.iGM(o=e.CRH())&&(n.windowsUpdatesConfigurationComponent=o.first),e.iGM(o=e.CRH())&&(n.recipePackageListComponent=o.first),e.iGM(o=e.CRH())&&(n.recipeLayerListComponent=o.first),e.iGM(o=e.CRH())&&(n.recipeImageSchedulingConfigurationComponent=o.first)}},decls:6,vars:2,consts:[["body","","autocomplete","off"],[1,"container"],[1,"col-lg-11","offset-lg-1"],["mat-tab-nav-bar","",1,"recipe-tabs"],["mat-tab-link","","routerLinkActive","",3,"routerLink","active",4,"ngIf"],[3,"ngIf"],["mat-tab-link","","routerLinkActive","",3,"routerLink","active"],[3,"loading","loadingText"],["mat-button","",1,"mt-1",3,"click"],[3,"iconClasses","title"],[3,"icon","title"],["body",""],["multi",""],[3,"recipeIsDirty","kickOffDeploy"],[3,"savingInProgress"],[1,"table-actions"],[1,"operation-spinner-label"],[4,"ngIf"],[1,"align-right"],["mat-raised-button","",3,"disabled","click"],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"nav",3),e.YNc(4,Qn,2,2,"a",4),e.qZA(),e.YNc(5,Ln,22,12,"ng-template",5),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(4),e.Q6J("ngIf",null!=n.recipeId),e.xp6(1),e.Q6J("ngIf",null!=n.recipeId))},directives:[ne.BU,u.O5,b.yS,ne.Nj,b.Od,ee.o,D.lW,S.b,Pe.A,C.pp,Me,Ze,Te,Fe,Ie,Se,ke,Jn.i],styles:["[_nghost-%COMP%]{padding:0!important}nav.recipe-tabs[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-transform:uppercase}nav.recipe-tabs[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:none;color:#424242}.operation-spinner-label[_ngcontent-%COMP%]{display:flex;align-items:center;margin:6px}.align-right[_ngcontent-%COMP%]{margin-left:auto}"]}),i})();var Yn=c(47861),Hn=c(8096);class Wn{}class jn{}class zn{constructor(){this.activeDirectoryConfiguration=new jn,this.vCenterConfiguration=new Wn}}class Bn{}class $n{}var pe=c(34645);class Ne{}var qe=c(57561),ue=c(67339),Ue=c(80529);let Re=(()=>{class i extends qe.q{constructor(t,n){super(t,n)}getDirectories(t){const n=JSON.stringify(t);return this.post(ue.f.getVmWareDirectories(),n)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(Ue.eN),e.LFG(R.w))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var se=(()=>{return(i=se||(se={}))[i.Root=0]="Root",i[i.Directory=1]="Directory",i[i.File=2]="File",se;var i})();function Gn(i,a){1&i&&e._UZ(0,"img",5)}function Kn(i,a){1&i&&e._UZ(0,"img",6)}function Xn(i,a){1&i&&e._UZ(0,"img",7)}function ei(i,a){1&i&&e._UZ(0,"img",8)}function ti(i,a){1&i&&e._UZ(0,"span",17)}function ni(i,a){if(1&i&&e._UZ(0,"am-icon",18),2&i){const t=e.oxw(2);e.Q6J("iconClasses",t.icons.SPINNER)}}function ii(i,a){1&i&&e._UZ(0,"span")}function oi(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"span",19),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().toggleExpand(o)}),e.YNc(1,ii,1,0,"span",15),e.qZA()}if(2&i){const t=e.oxw().$implicit;e.oxw();const n=e.MAs(5),o=e.MAs(7);e.xp6(1),e.Q6J("ngIf",t.expanded)("ngIfThen",n)("ngIfElse",o)}}function ai(i,a){1&i&&e._UZ(0,"span")}function ri(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"am-storage-directory-tree",20),e.NdJ("pathSelected",function(o){return e.CHM(t),e.oxw(2).onPathSelected(o)}),e.qZA()}if(2&i){const t=e.oxw().$implicit,n=e.oxw();e.ekj("hidden",!t.expanded),e.Q6J("credentials",n.credentials)("directories",t.children)("environmentId",n.environmentId)}}function si(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"li"),e.TgZ(1,"div",9),e.YNc(2,ti,1,0,"span",10),e.YNc(3,ni,1,1,"am-icon",11),e.YNc(4,oi,2,3,"span",12),e.TgZ(5,"span",13),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().onNodeClick(r)}),e.TgZ(6,"span",14),e.YNc(7,ai,1,0,"span",15),e._uU(8),e.qZA(),e.qZA(),e.qZA(),e.YNc(9,ri,1,5,"am-storage-directory-tree",16),e.qZA()}if(2&i){const t=a.$implicit,n=e.oxw(),o=e.MAs(1),r=e.MAs(3);e.xp6(2),e.Q6J("ngIf",!t.loading&&!t.children),e.xp6(1),e.Q6J("ngIf",t.loading),e.xp6(1),e.Q6J("ngIf",t.children),e.xp6(1),e.ekj("selected-node",t.dataStorePath===n.selectedPath),e.xp6(2),e.Q6J("ngIf",t.fileType===n.DataStoreFileType.Root)("ngIfThen",o)("ngIfElse",r),e.xp6(1),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",t.children)}}let li=(()=>{class i{constructor(t){this.fileService=t,this.pathSelected=new e.vpe,this.DataStoreFileType=se,this.icons=_.R.icons.fontAwesome}ngOnInit(){}onNodeClick(t){const n=this.selectedPath===t.dataStorePath||!this.selectedPath?.startsWith(t.dataStorePath);this.onPathSelected(t.dataStorePath),n&&this.toggleExpand(t),t.loaded||(t.loading=!0,this.getDirectories(t.dataStorePath).subscribe(o=>{t.loaded=!0,t.children=o,t.expanded=!!t.children,t.loading=!1},()=>{t.loading=!1}))}toggleExpand(t){t.expanded=(!!t.loaded&&t.children||!t.loaded)&&!t.expanded}getDirectories(t){const n=new Ne;return n.connectionInfo=this.credentials,n.environmentId=this.environmentId,n.path=t,this.fileService.getDirectories(n)}onPathSelected(t){this.setPath(t),this.pathSelected.emit(t)}setPath(t){this.selectedPath=t,this.childTreeComponents?.forEach(n=>{n.setPath(t)})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Re))},i.\u0275cmp=e.Xpm({type:i,selectors:[["am-storage-directory-tree"]],viewQuery:function(t,n){if(1&t&&e.Gf(i,5),2&t){let o;e.iGM(o=e.CRH())&&(n.childTreeComponents=o)}},inputs:{directories:"directories",environmentId:"environmentId",credentials:"credentials"},outputs:{pathSelected:"pathSelected"},decls:10,vars:1,consts:[["dataStoreIcon",""],["directoryIcon",""],["expandedIcon",""],["collapsedIcon",""],[4,"ngFor","ngForOf"],["alt","Folder","src","assets/images/icons/database.svg",1,"directory-icon"],["alt","Data store","src","assets/images/icons/folder.svg",1,"directory-icon"],["alt","Expanded toggle","src","assets/images/icons/caret-down-solid.svg",1,"expander"],["alt","Collapsed toggle","src","assets/images/icons/caret-right-solid.svg",1,"expander"],[1,"node-item"],["class","not-expandable",4,"ngIf"],["class","loading-icon",3,"iconClasses",4,"ngIf"],[3,"click",4,"ngIf"],[2,"display","inline-block",3,"click"],[1,"node-item-button"],[4,"ngIf","ngIfThen","ngIfElse"],[3,"hidden","credentials","directories","environmentId","pathSelected",4,"ngIf"],[1,"not-expandable"],[1,"loading-icon",3,"iconClasses"],[3,"click"],[3,"credentials","directories","environmentId","pathSelected"]],template:function(t,n){1&t&&(e.YNc(0,Gn,1,0,"ng-template",null,0,e.W1O),e.YNc(2,Kn,1,0,"ng-template",null,1,e.W1O),e.YNc(4,Xn,1,0,"ng-template",null,2,e.W1O),e.YNc(6,ei,1,0,"ng-template",null,3,e.W1O),e.TgZ(8,"ul"),e.YNc(9,si,10,10,"li",4),e.qZA()),2&t&&(e.xp6(9),e.Q6J("ngForOf",n.directories))},directives:[u.sg,u.O5,S.b,i],styles:["ul[_ngcontent-%COMP%]{list-style-type:none;padding-left:15px;margin-bottom:0}li[_ngcontent-%COMP%]{line-height:28px}.node-item[_ngcontent-%COMP%]{display:flex;align-items:center}.directory-icon[_ngcontent-%COMP%]{height:16px;margin-right:5px;line-height:28px;width:20px}.node-item-button[_ngcontent-%COMP%]{font-weight:400;text-transform:none;text-align:left;padding:0 8px;line-height:28px;outline:none;font-size:14px;cursor:pointer}.collapsed[_ngcontent-%COMP%], .hidden[_ngcontent-%COMP%]{display:none}.selected-node[_ngcontent-%COMP%]{background-color:#eee}.loading-icon[_ngcontent-%COMP%]{padding-right:5px;width:20px}.not-expandable[_ngcontent-%COMP%]{display:inline-block;width:20px;height:16px}.expander[_ngcontent-%COMP%]{height:16px;line-height:28px;width:20px;cursor:pointer}"]}),i})();function ci(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"am-storage-directory-tree",4),e.NdJ("pathSelected",function(o){return e.CHM(t),e.oxw().onPathSelected(o)}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("credentials",t.credentials)("directories",t.directories)("environmentId",t.environmentId)}}let di=(()=>{class i{constructor(t){this.fileService=t,this.pathSelected=new e.vpe,this.icons=_.R.icons.fontAwesome,this.hasChild=(n,o)=>!!o.children&&o.children.length>0}ngOnInit(){this.initialLoading=!0,this.getDirectories().subscribe(t=>{this.directories=t,this.initialLoading=!1},()=>{this.initialLoading=!1})}getDirectories(t){const n=new Ne;return n.connectionInfo=this.credentials,n.environmentId=this.environmentId,n.path=t,this.fileService.getDirectories(n)}onPathSelected(t){this.selectedPath=t,this.pathSelected.emit(t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Re))},i.\u0275cmp=e.Xpm({type:i,selectors:[["storage-file-explorer"]],inputs:{environmentId:"environmentId",credentials:"credentials"},outputs:{pathSelected:"pathSelected"},decls:5,vars:3,consts:[[1,"component-container"],[3,"loading"],[3,"credentials","directories","environmentId","pathSelected",4,"ngIf"],[1,"selected-path"],[3,"credentials","directories","environmentId","pathSelected"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"loading-container",1),e.YNc(2,ci,1,3,"am-storage-directory-tree",2),e.qZA(),e.TgZ(3,"div",3),e._uU(4),e.qZA()),2&t&&(e.xp6(1),e.Q6J("loading",n.initialLoading),e.xp6(1),e.Q6J("ngIf",n.directories),e.xp6(2),e.Oqu(n.selectedPath))},directives:[ee.o,u.O5,li],styles:[".component-container[_ngcontent-%COMP%]{max-height:490px;overflow-y:auto}.selected-node[_ngcontent-%COMP%]{background-color:#eee}.selected-path[_ngcontent-%COMP%]{padding:5px;background-color:#eee;border-top:1px solid #D1D2D3;border-bottom:1px solid #D1D2D3;font-size:12px;font-weight:500;min-height:30px}"]}),i})(),mi=(()=>{class i{constructor(t,n){this.dialog=t,this.options=n,this.closeAction=new pe.r,this.icons=_.R.icons.fontAwesome,this.closeAction.title="Close",this.closeAction.tooltipTitle="Close",this.closeAction.icon=this.icons.TIMES_REGULAR,this.closeAction.action=this.closeDialog.bind(this)}ngOnInit(){}onPathSelected(t){this.path=t}closeDialog(){this.dialog.close()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(N.so),e.Y36(N.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["storage-file-explorer-dialog"]],decls:8,vars:7,consts:[[3,"action","title","showFooter"],["body",""],[3,"credentials","environmentId","pathSelected"],["align","end",1,"mat-dialog-actions","action-buttons"],["mat-raised-button","",3,"click"],["color","primary","mat-raised-button","",3,"mat-dialog-close","disabled"]],template:function(t,n){1&t&&(e.TgZ(0,"form-section",0),e.TgZ(1,"div",1),e.TgZ(2,"storage-file-explorer",2),e.NdJ("pathSelected",function(r){return n.onPathSelected(r)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(3,"div",3),e.TgZ(4,"button",4),e.NdJ("click",function(){return n.closeDialog()}),e._uU(5,"Cancel"),e.qZA(),e.TgZ(6,"button",5),e._uU(7,"Select"),e.qZA(),e.qZA()),2&t&&(e.Q6J("action",n.closeAction)("title",null==n.options?null:n.options.title)("showFooter",!1),e.xp6(2),e.Q6J("credentials",n.options.credentials)("environmentId",n.options.environmentId),e.xp6(4),e.Q6J("mat-dialog-close",n.path)("disabled",null==n.path||""===n.path))},directives:[Pe.A,di,D.lW,N.ZT],styles:[""]}),i})();var pi=c(88552),ui=c(90455);function gi(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Incorrect username format "),e.qZA())}function hi(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter a valid FQDN "),e.qZA())}function Ci(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Incorrect username format "),e.qZA())}function fi(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter a valid secure url! "),e.qZA())}function _i(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Incorrect image store path format "),e.qZA())}function vi(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Date is required "),e.qZA())}function Mi(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Invalid date format "),e.qZA())}function wi(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Time is required "),e.qZA())}function Zi(i,a){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Recurrence is required "),e.qZA())}function Ti(i,a){if(1&i&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e.TgZ(2,"label",47),e._uU(3,"Recur every"),e.qZA(),e.qZA(),e.TgZ(4,"td"),e.TgZ(5,"mat-form-field",48),e._UZ(6,"input",49),e.YNc(7,Zi,2,0,"mat-error",11),e.qZA(),e._uU(8),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(6),e.Q6J("formControl",t.imageSchedulingViewModel.recurrenceFormControl)("min",1)("max",999),e.xp6(1),e.Q6J("ngIf",t.imageSchedulingViewModel.recurrenceFormControl.hasError("required")),e.xp6(1),e.hij(" ",t.imageSchedulingViewModel.regularityFormControl.value===t.taskRegularity.Daily?"days":"weeks"," ")}}function yi(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e.TgZ(2,"label",50),e.NdJ("click",function(){return e.CHM(t),e.MAs(7).focus()}),e._uU(3,"Recur on"),e.qZA(),e.qZA(),e.TgZ(4,"td"),e.TgZ(5,"mat-form-field",51),e.TgZ(6,"mat-select",52,53),e.TgZ(8,"mat-option",42),e._uU(9,"Monday"),e.qZA(),e.TgZ(10,"mat-option",42),e._uU(11,"Tuesday"),e.qZA(),e.TgZ(12,"mat-option",42),e._uU(13,"Wednesday"),e.qZA(),e.TgZ(14,"mat-option",42),e._uU(15,"Thursday"),e.qZA(),e.TgZ(16,"mat-option",42),e._uU(17,"Friday"),e.qZA(),e.TgZ(18,"mat-option",42),e._uU(19,"Saturday"),e.qZA(),e.TgZ(20,"mat-option",42),e._uU(21,"Sunday"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("formControl",t.imageSchedulingViewModel.weekDaysFormControl),e.xp6(2),e.Q6J("value",t.WeekDay.Monday),e.xp6(2),e.Q6J("value",t.WeekDay.Tuesday),e.xp6(2),e.Q6J("value",t.WeekDay.Wednesday),e.xp6(2),e.Q6J("value",t.WeekDay.Thursday),e.xp6(2),e.Q6J("value",t.WeekDay.Friday),e.xp6(2),e.Q6J("value",t.WeekDay.Saturday),e.xp6(2),e.Q6J("value",t.WeekDay.Sunday)}}let xi=(()=>{class i{constructor(t,n,o,r,s,d,h){this.recipeService=t,this.dataRepositoryService=n,this.uiNotificationsService=o,this.tristateDialogService=r,this.imageManagementHttpService=s,this.hotkeysService=d,this.dialog=h,this.adModel=new Yn.v,this.vCenterModel=new Hn.m,this.imageSchedulingViewModel=new J,this.subscription=new I.w,this.dummyPassword="password",this.icons=_.R.icons.fontAwesome,this.expandOnLoad=!0,this.taskRegularity=M.z,this.WeekDay=de.V,this.timeZoneLabel=(new Date).toTimeString().slice(9)}get isSaveAllowed(){return(this.adModel.isDirty||this.vCenterModel.isDirty||this.imageSchedulingViewModel.isDirty)&&this.adModel.isValid&&this.vCenterModel.isValid&&this.imageSchedulingViewModel.isValid}ngOnInit(){this.subscription.add(this.dataRepositoryService.currentEnvironmentSubject.pipe((0,V.h)(t=>null!=t)).subscribe(t=>{this.environmentId=t.id})),this.subscription.add(this.recipeService.configurationLoaded.subscribe(t=>{this.initActiveDirectoryModel(t),this.initVCenterModel(t),this.initImageSchedulingModel(t)})),this.hotkeysService.remove(this.hotkeysService.hotkeys.filter(t=>"?"!==t.combo[0])),this.hotkeysService.add(new A.qm("ctrl+s",()=>(this.save(),!1),E.C.hotkeysAllowIn,"Save changes"))}initActiveDirectoryModel(t){this.adModel.setServiceAccount(t.serviceAccount),this.adModel.setServiceAccountPassword(!0!==t.isServiceAccountPasswordSet?t.serviceAccountPassword:this.dummyPassword),this.adModel.setFqdn(t.domainFqdn),this.adModel.resetControls(),this.adModel.resetDirty(),this.isServiceAccountPasswordSet=t.isServiceAccountPasswordSet}initVCenterModel(t){this.vCenterModel.setServiceAccount(t.vCenterUser),this.vCenterModel.setServiceAccountPassword(!0!==t.isVCenterPasswordSet?t.vCenterPassword:this.dummyPassword),this.vCenterModel.setServer(t.vCenterServer),this.vCenterModel.setAcceptAllCertificates(t.vCenterAcceptAllCertificates),this.vCenterModel.setImageLocation(t.imageLocationPath),this.vCenterModel.resetControls(),this.vCenterModel.resetDirty(),this.isVCenterPasswordSet=t.isVCenterPasswordSet}initImageSchedulingModel(t){this.imageSchedulingViewModel.setValues(t.imageSchedulingConfiguration),this.imageSchedulingViewModel.resetControls()}setPasswordValue(t,n,o){t.setServiceAccountPassword(!0===o?t.passwordFormControl.dirty?t.password:"":t.passwordFormControl.dirty||!n?t.password:this.dummyPassword)}onInputChange(){this.adModel.password=this.adModel.passwordFormControl.value,this.vCenterModel.password=this.vCenterModel.passwordFormControl.value}saveChanges(){const t=new zn;return t.activeDirectoryConfiguration.serviceAccount=this.adModel.serviceAccountFormControl.value,t.activeDirectoryConfiguration.serviceAccountPassword=this.adModel.passwordFormControl.dirty?this.adModel.passwordFormControl.value:"",t.activeDirectoryConfiguration.domainFqdn=this.adModel.fqdnFormControl.value,t.vCenterConfiguration.serviceAccount=this.vCenterModel.serviceAccountFormControl.value,t.vCenterConfiguration.serviceAccountPassword=this.vCenterModel.passwordFormControl.dirty?this.vCenterModel.passwordFormControl.value:"",t.vCenterConfiguration.server=this.vCenterModel.urlFormControl.value,t.vCenterConfiguration.acceptAllCertificates=this.vCenterModel.acceptAllCertificates,t.vCenterConfiguration.imageLocation=this.vCenterModel.imageLocationFormControl.value,t.imageSchedulingConfiguration=this.imageSchedulingViewModel.getModel(),this.recipeService.saveConfiguration(t,this.environmentId)}save(){!this.isSaveAllowed||(this.isSaving=!0,this.saveChanges().subscribe(t=>{this.isSaving=!1,t&&this.uiNotificationsService.sendInfoMessage("Configuration has been successfully saved.")}))}resetForm(){this.adModel.resetControls(),this.adModel.resetDirty(),this.setPasswordValue(this.adModel,this.isServiceAccountPasswordSet,!1),this.vCenterModel.resetControls(),this.vCenterModel.resetDirty(),this.setPasswordValue(this.vCenterModel,this.isVCenterPasswordSet,!1),this.imageSchedulingViewModel.resetControls()}canDeactivate(){if(this.isSaveAllowed){const t=new p.xQ;return this.tristateDialogService.openDialog("Do you want to save changes?","Your changes will be lost if you don't save them.").subscribe(n=>{"Confirmed"===n?this.saveChanges().subscribe(o=>{t.next(o)}):"UnConfirmed"===n?t.next(!0):"Canceled"===n&&t.next(!1)}),t.asObservable()}return!0}testAdCredentials(t){t.stopPropagation(),this.isActiveDirectoryTestRunning=!0,this.adModel.testConnectionProgress("Testing connection to AD");const n=new Bn;n.username=this.adModel.serviceAccountFormControl.value,n.password=this.adModel.passwordFormControl.dirty?this.adModel.passwordFormControl.value:"",n.domain=this.adModel.fqdnFormControl.value,this.imageManagementHttpService.testAccountConfiguration(this.environmentId,n).subscribe(o=>{this.isActiveDirectoryTestRunning=!1,!0===o?this.uiNotificationsService.sendInfoMessage("Test connection succeeded"):this.uiNotificationsService.sendWarningMessage("Service account is not valid.",!0,5e3,!0)},()=>{this.isActiveDirectoryTestRunning=!1})}testVCenterConnection(t){t.stopPropagation(),this.isVCenterTestRunning=!0,this.vCenterModel.testConnectionProgress("Testing connection to vCenter");const n=this.getVCenterCredentialsModel();this.imageManagementHttpService.testVCenterAccountConfiguration(this.environmentId,n).subscribe(o=>{o||(this.isVCenterTestRunning=!1,this.uiNotificationsService.sendInfoMessage("Test connection succeeded"))},o=>{this.isVCenterTestRunning=!1,this.uiNotificationsService.sendWarningMessage(o,!0,5e3,!0)})}getVCenterCredentialsModel(){const t=new $n;return t.user=this.vCenterModel.serviceAccountFormControl.value,t.password=this.vCenterModel.passwordFormControl.dirty?this.vCenterModel.passwordFormControl.value:"",t.server=this.vCenterModel.urlFormControl.value,t.ignoreCertificateErrors=this.vCenterModel.acceptAllCertificates,t}scheduledBuildsEnabledTriggerChanged(t){this.imageSchedulingViewModel.toggleEnable(t.checked)}openLocationSelectionDialog(){const t={title:"Select Folder",credentials:this.getVCenterCredentialsModel(),environmentId:this.environmentId};this.dialog.open(mi,{panelClass:"actions-dialog",data:t}).afterClosed().subscribe(o=>{null!=o&&(this.vCenterModel.imageLocationFormControl.setValue(o),this.vCenterModel.imageLocationFormControl.markAsDirty())})}ngOnDestroy(){this.subscription.unsubscribe(),this.hotkeysService.remove(this.hotkeysService.hotkeys.filter(t=>"?"!==t.combo[0]))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Z.Y),e.Y36(H.Y),e.Y36(R.w),e.Y36(Oe.S),e.Y36(X.f),e.Y36(A.tm),e.Y36(N.uw))},i.\u0275cmp=e.Xpm({type:i,selectors:[["image-management-configuration"]],decls:140,vars:59,consts:[["autocomplete","off"],["multi",""],[1,"mat-elevation-z1",3,"expanded","hideToggle"],["activeDirectoryPanel",""],[3,"expanded"],["amSpinnerButton","","color","primary","mat-raised-button","","matTooltip","Test Active Directory credentials",1,"action-button",3,"amShowSpinner","click"],[3,"iconClasses"],[1,"am-table"],["for","adUsername"],[1,"full-width",3,"floatLabel"],["id","adUsername","matInput","","placeholder","Username",3,"formControl","maxlength","ngModelChange"],[4,"ngIf"],["for","adPassword"],["id","adPassword","matInput","","name","model.password","placeholder","Password","type","password",3,"formControl","blur","focus","ngModelChange"],["for","adFqdn"],["id","adFqdn","matInput","","placeholder","Domain FQDN",3,"formControl","ngModelChange"],["vCenterPanel",""],["amSpinnerButton","","color","primary","mat-raised-button","","matTooltip","Test vCenter connection",1,"action-button",3,"amShowSpinner","click"],["for","vCenterUsername"],["id","vCenterUsername","matInput","","placeholder","Username",3,"formControl","maxlength","ngModelChange"],["for","vCenterPassword"],["id","vCenterPassword","matInput","","placeholder","Password","type","password",3,"formControl","blur","focus","ngModelChange"],["for","vCenterUrl"],["id","vCenterUrl","matInput","","placeholder","Url",3,"formControl","ngModelChange"],["for","imageStore"],["id","imageStore","matInput","","placeholder","Image Store",3,"formControl","ngModelChange"],["matSuffix","","mat-icon-button","","matTooltip","Datastore explorer",3,"click"],["schedulingPanel",""],[3,"formControl","change"],["for","buildStartTime"],[1,"start-time"],[1,"start-date-form-field",3,"floatLabel"],["id","buildStartTime","matInput","",3,"formControl","matDatepicker"],["matSuffix","",3,"for"],["buildStartDatePicker",""],["floatLabel","never",1,"start-time-form-field"],["matInput","","type","time",3,"formControl"],[1,"time-zone-label"],["for","taskRegularity",3,"click"],["floatLabel","never"],["id","taskRegularity",3,"formControl"],["taskRegularitySelect",""],[3,"value"],[1,"footer"],[1,"pt-2","pb-2","text-right"],["mat-raised-button","",3,"disabled","click"],["amSpinnerButton","","color","primary","mat-raised-button","",3,"amShowSpinner","disabled","click"],["for","taskRecurrence"],["floatLabel","never",1,"recurrence-form-field"],["id","taskRecurrence","matInput","","maxlength","3","type","number",3,"formControl","min","max"],[3,"click"],[1,"week-days-form-field"],["multiple","",3,"formControl"],["weekDaysSelect",""]],template:function(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"form",0),e.TgZ(1,"mat-accordion",1),e.TgZ(2,"mat-expansion-panel",2,3),e.TgZ(4,"mat-expansion-panel-header"),e.TgZ(5,"mat-panel-title"),e._UZ(6,"am-caret",4),e._uU(7," Active Directory "),e.qZA(),e.TgZ(8,"button",5),e.NdJ("click",function(s){return n.testAdCredentials(s)}),e._UZ(9,"am-icon",6),e.qZA(),e.qZA(),e.TgZ(10,"table",7),e.TgZ(11,"tr"),e.TgZ(12,"td"),e.TgZ(13,"label",8),e._uU(14,"Username"),e.qZA(),e.qZA(),e.TgZ(15,"td"),e.TgZ(16,"mat-form-field",9),e.TgZ(17,"input",10),e.NdJ("ngModelChange",function(){return n.onInputChange()}),e.qZA(),e.TgZ(18,"mat-hint"),e._uU(19,"Example: loginvsi.com\\administrator"),e.qZA(),e.YNc(20,gi,2,0,"mat-error",11),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"tr"),e.TgZ(22,"td"),e.TgZ(23,"label",12),e._uU(24,"Password"),e.qZA(),e.qZA(),e.TgZ(25,"td"),e.TgZ(26,"mat-form-field",9),e.TgZ(27,"input",13),e.NdJ("blur",function(){return n.setPasswordValue(n.adModel,n.isServiceAccountPasswordSet,!1)})("focus",function(){return n.setPasswordValue(n.adModel,n.isServiceAccountPasswordSet,!0)})("ngModelChange",function(){return n.onInputChange()}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(28,"tr"),e.TgZ(29,"td"),e.TgZ(30,"label",14),e._uU(31,"Domain FQDN"),e.qZA(),e.qZA(),e.TgZ(32,"td"),e.TgZ(33,"mat-form-field",9),e.TgZ(34,"input",15),e.NdJ("ngModelChange",function(){return n.onInputChange()}),e.qZA(),e.TgZ(35,"mat-hint"),e._uU(36,"Example: loginvsi.com"),e.qZA(),e.YNc(37,hi,2,0,"mat-error",11),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(38,"mat-expansion-panel",2,16),e.TgZ(40,"mat-expansion-panel-header"),e.TgZ(41,"mat-panel-title"),e._UZ(42,"am-caret",4),e._uU(43," vCenter Integration "),e.qZA(),e.TgZ(44,"button",17),e.NdJ("click",function(s){return n.testVCenterConnection(s)}),e._UZ(45,"am-icon",6),e.qZA(),e.qZA(),e.TgZ(46,"table",7),e.TgZ(47,"tr"),e.TgZ(48,"td"),e.TgZ(49,"label",18),e._uU(50,"Username"),e.qZA(),e.qZA(),e.TgZ(51,"td"),e.TgZ(52,"mat-form-field",9),e.TgZ(53,"input",19),e.NdJ("ngModelChange",function(){return n.onInputChange()}),e.qZA(),e.TgZ(54,"mat-hint"),e._uU(55,"Example: loginvsi.com\\administrator"),e.qZA(),e.YNc(56,Ci,2,0,"mat-error",11),e.qZA(),e.qZA(),e.qZA(),e.TgZ(57,"tr"),e.TgZ(58,"td"),e.TgZ(59,"label",20),e._uU(60,"Password"),e.qZA(),e.qZA(),e.TgZ(61,"td"),e.TgZ(62,"mat-form-field",9),e.TgZ(63,"input",21),e.NdJ("blur",function(){return n.setPasswordValue(n.vCenterModel,n.isVCenterPasswordSet,!1)})("focus",function(){return n.setPasswordValue(n.vCenterModel,n.isVCenterPasswordSet,!0)})("ngModelChange",function(){return n.onInputChange()}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(64,"tr"),e.TgZ(65,"td"),e.TgZ(66,"label",22),e._uU(67,"VMware vCenter URL"),e.qZA(),e.qZA(),e.TgZ(68,"td"),e.TgZ(69,"mat-form-field",9),e.TgZ(70,"input",23),e.NdJ("ngModelChange",function(){return n.onInputChange()}),e.qZA(),e.TgZ(71,"mat-hint"),e._uU(72,"Example: https://vcenter.loginvsi.com"),e.qZA(),e.YNc(73,fi,2,0,"mat-error",11),e.qZA(),e.qZA(),e.qZA(),e.TgZ(74,"tr"),e.TgZ(75,"td"),e.TgZ(76,"label",24),e._uU(77,"Image Store"),e.qZA(),e.qZA(),e.TgZ(78,"td"),e.TgZ(79,"mat-form-field",9),e.TgZ(80,"input",25),e.NdJ("ngModelChange",function(){return n.onInputChange()}),e.qZA(),e.TgZ(81,"button",26),e.NdJ("click",function(){return n.openLocationSelectionDialog()}),e._UZ(82,"am-icon",6),e.qZA(),e.TgZ(83,"mat-hint"),e._uU(84,"Example: [datastore] path/to/folder"),e.qZA(),e.YNc(85,_i,2,0,"mat-error",11),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(86,"mat-expansion-panel",2,27),e.TgZ(88,"mat-expansion-panel-header"),e.TgZ(89,"mat-panel-title"),e._UZ(90,"am-caret",4),e._uU(91," Scheduling "),e.qZA(),e.qZA(),e.TgZ(92,"table",7),e.TgZ(93,"tr"),e.TgZ(94,"td"),e.TgZ(95,"label"),e._uU(96,"Enable scheduled builds"),e.qZA(),e.qZA(),e.TgZ(97,"td"),e.TgZ(98,"mat-slide-toggle",28),e.NdJ("change",function(s){return n.scheduledBuildsEnabledTriggerChanged(s)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(99,"tr"),e.TgZ(100,"td"),e.TgZ(101,"label",29),e._uU(102,"Build start time"),e.qZA(),e.qZA(),e.TgZ(103,"td",30),e.TgZ(104,"mat-form-field",31),e._UZ(105,"input",32),e._UZ(106,"mat-datepicker-toggle",33),e._UZ(107,"mat-datepicker",null,34),e.YNc(109,vi,2,0,"mat-error",11),e.YNc(110,Mi,2,0,"mat-error",11),e.qZA(),e.TgZ(111,"mat-form-field",35),e._UZ(112,"input",36),e.YNc(113,wi,2,0,"mat-error",11),e.qZA(),e.TgZ(114,"span",37),e._uU(115),e.qZA(),e.qZA(),e.qZA(),e.TgZ(116,"tr"),e.TgZ(117,"td"),e.TgZ(118,"label",38),e.NdJ("click",function(){return e.CHM(o),e.MAs(125).focus()}),e._uU(119,"Regularity"),e.qZA(),e.qZA(),e.TgZ(120,"td"),e.TgZ(121,"mat-form-field",39),e.TgZ(122,"mat-label"),e._uU(123,"Regularity"),e.qZA(),e.TgZ(124,"mat-select",40,41),e.TgZ(126,"mat-option",42),e._uU(127,"Daily"),e.qZA(),e.TgZ(128,"mat-option",42),e._uU(129,"Weekly"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(130,Ti,9,5,"tr",11),e.YNc(131,yi,22,8,"tr",11),e.qZA(),e.qZA(),e.qZA(),e.TgZ(132,"div",43),e.TgZ(133,"div",44),e.TgZ(134,"button",45),e.NdJ("click",function(){return n.resetForm()}),e._UZ(135,"am-icon",6),e._uU(136," Reset "),e.qZA(),e.TgZ(137,"button",46),e.NdJ("click",function(){return n.save()}),e._UZ(138,"am-icon",6),e._uU(139," Save "),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&t){const o=e.MAs(3),r=e.MAs(39),s=e.MAs(87),d=e.MAs(108);e.xp6(2),e.Q6J("expanded",n.expandOnLoad)("hideToggle",!0),e.xp6(4),e.Q6J("expanded",o.expanded),e.xp6(2),e.ekj("hidden",!o.expanded),e.Q6J("amShowSpinner",n.isActiveDirectoryTestRunning),e.xp6(1),e.Q6J("iconClasses",n.icons.PLUG),e.xp6(7),e.Q6J("floatLabel","never"),e.xp6(1),e.s9C("maxlength",n.adModel.serviceAccountMaxLength),e.Q6J("formControl",n.adModel.serviceAccountFormControl),e.xp6(3),e.Q6J("ngIf",n.adModel.serviceAccountFormControl.hasError("pattern")),e.xp6(6),e.Q6J("floatLabel","never"),e.xp6(1),e.Q6J("formControl",n.adModel.passwordFormControl),e.xp6(6),e.Q6J("floatLabel","never"),e.xp6(1),e.Q6J("formControl",n.adModel.fqdnFormControl),e.xp6(3),e.Q6J("ngIf",n.adModel.fqdnFormControl.hasError("isFQDN")),e.xp6(1),e.Q6J("expanded",n.expandOnLoad)("hideToggle",!0),e.xp6(4),e.Q6J("expanded",r.expanded),e.xp6(2),e.ekj("hidden",!r.expanded),e.Q6J("amShowSpinner",n.isVCenterTestRunning),e.xp6(1),e.Q6J("iconClasses",n.icons.PLUG),e.xp6(7),e.Q6J("floatLabel","never"),e.xp6(1),e.s9C("maxlength",n.vCenterModel.serviceAccountMaxLength),e.Q6J("formControl",n.vCenterModel.serviceAccountFormControl),e.xp6(3),e.Q6J("ngIf",n.vCenterModel.serviceAccountFormControl.hasError("pattern")),e.xp6(6),e.Q6J("floatLabel","never"),e.xp6(1),e.Q6J("formControl",n.vCenterModel.passwordFormControl),e.xp6(6),e.Q6J("floatLabel","never"),e.xp6(1),e.Q6J("formControl",n.vCenterModel.urlFormControl),e.xp6(3),e.Q6J("ngIf",n.vCenterModel.urlFormControl.hasError("isSecureUrl")),e.xp6(6),e.Q6J("floatLabel","never"),e.xp6(1),e.Q6J("formControl",n.vCenterModel.imageLocationFormControl),e.xp6(2),e.Q6J("iconClasses",n.icons.FOLDER_OPEN),e.xp6(3),e.Q6J("ngIf",n.vCenterModel.imageLocationFormControl.hasError("pattern")),e.xp6(1),e.Q6J("expanded",n.expandOnLoad)("hideToggle",!0),e.xp6(4),e.Q6J("expanded",s.expanded),e.xp6(8),e.Q6J("formControl",n.imageSchedulingViewModel.enabledFormControl),e.xp6(6),e.Q6J("floatLabel","never"),e.xp6(1),e.Q6J("formControl",n.imageSchedulingViewModel.startDateFormControl)("matDatepicker",d),e.xp6(1),e.Q6J("for",d),e.xp6(3),e.Q6J("ngIf",n.imageSchedulingViewModel.startDateFormControl.hasError("required")),e.xp6(1),e.Q6J("ngIf",n.imageSchedulingViewModel.startDateFormControl.hasError("matDatepickerParse")),e.xp6(2),e.Q6J("formControl",n.imageSchedulingViewModel.startTimeFormControl),e.xp6(1),e.Q6J("ngIf",n.imageSchedulingViewModel.startTimeFormControl.hasError("required")),e.xp6(2),e.Oqu(n.timeZoneLabel),e.xp6(9),e.Q6J("formControl",n.imageSchedulingViewModel.regularityFormControl),e.xp6(2),e.Q6J("value",n.taskRegularity.Daily),e.xp6(2),e.Q6J("value",n.taskRegularity.Weekly),e.xp6(2),e.Q6J("ngIf",n.imageSchedulingViewModel.regularityFormControl.value===n.taskRegularity.Daily||n.imageSchedulingViewModel.regularityFormControl.value===n.taskRegularity.Weekly),e.xp6(1),e.Q6J("ngIf",n.imageSchedulingViewModel.regularityFormControl.value===n.taskRegularity.Weekly),e.xp6(3),e.Q6J("disabled",!n.adModel.isDirty&&!n.vCenterModel.isDirty&&!n.imageSchedulingViewModel.isDirty),e.xp6(1),e.Q6J("iconClasses",n.icons.UNDO),e.xp6(2),e.Q6J("amShowSpinner",n.isSaving)("disabled",!n.isSaveAllowed),e.xp6(1),e.Q6J("iconClasses",n.icons.FLOPPY_O)}},directives:[l._Y,l.JL,l.F,C.pp,C.ib,C.yz,C.yK,q,D.lW,pi.W,k.gM,S.b,g.KE,P.Nt,l.Fj,l.JJ,l.oH,l.nD,g.bx,u.O5,g.TO,g.R9,ui.Rr,Y.hl,Y.nW,Y.Mq,g.hX,j.gD,z.ey,l.wV,l.qQ,l.Fd],styles:["mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   mat-panel-title[_ngcontent-%COMP%]{text-transform:uppercase;font-weight:500}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .caret[_ngcontent-%COMP%]{color:#616161;padding-right:.75rem}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   button.action-button[_ngcontent-%COMP%]{margin-left:12px;padding:2px;line-height:19px;min-width:23px;height:23px;outline:none}table[_ngcontent-%COMP%]{width:100%;margin-bottom:.25rem}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{height:3rem}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child, table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{width:10rem;min-width:10rem;max-width:10rem}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   am-icon[_ngcontent-%COMP%]{padding-right:.15rem}am-caret[_ngcontent-%COMP%]{padding-right:.5rem}.start-time[_ngcontent-%COMP%]   .start-date-form-field[_ngcontent-%COMP%]{width:110px}.start-time[_ngcontent-%COMP%]   .start-time-form-field[_ngcontent-%COMP%]{margin-left:15px;width:100px}.recurrence-form-field[_ngcontent-%COMP%]{width:60px}.week-days-form-field[_ngcontent-%COMP%]{width:450px}.time-zone-label[_ngcontent-%COMP%]{font-size:.9em;color:#616161;margin-left:10px}"]}),i})();var Je=c(87545),F=c(37340),le=(()=>{return(i=le||(le={}))[i.Loading=0]="Loading",i[i.Exists=1]="Exists",i[i.NotExists=2]="NotExists",i[i.Unknown=3]="Unknown",le;var i})(),bi=c(21086);class Ai{}class Si{constructor(a,t){this.imageName=a,this.state=t}}let Di=(()=>{class i extends qe.q{constructor(t,n){super(t,n)}getAllRecipeImages(t){return this.get(ue.f.getRecipeImages(t))}getRecipeImagesStatus(t){return this.get(ue.f.getRecipeImagesStatus(t))}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(Ue.eN),e.LFG(R.w))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var Qe=c(81285);const Ii=["recipeTable"],ki=["imagesTable"];function Fi(i,a){1&i&&e._UZ(0,"th",21)}function Oi(i,a){if(1&i&&(e.TgZ(0,"td",22),e._UZ(1,"am-caret",23),e.qZA()),2&i){const t=a.$implicit,n=e.oxw(2);e.xp6(1),e.Q6J("expanded",null!=n.expandedRecipeId&&n.expandedRecipeId===t.id)}}function Pi(i,a){1&i&&(e.TgZ(0,"th",24),e._uU(1," Recipe"),e.qZA())}function Ni(i,a){if(1&i&&(e.TgZ(0,"td",22),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function qi(i,a){1&i&&(e.TgZ(0,"th",24),e._uU(1," Description"),e.qZA())}function Ui(i,a){if(1&i&&(e.TgZ(0,"td",22),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.hij(" ",t.description," ")}}function Ri(i,a){1&i&&(e.TgZ(0,"th",24),e._uU(1," Image count"),e.qZA())}function Ji(i,a){if(1&i&&(e.TgZ(0,"td",22),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.hij(" ",t.images?t.images.length:0," ")}}function Qi(i,a){1&i&&e._UZ(0,"th",21)}const Vi=function(i){return{"disabled-icon":i}};function Li(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"td",25),e.TgZ(1,"button",26),e.NdJ("click",function(o){const s=e.CHM(t).$implicit;return e.oxw(2).onRecipeEditButtonClicked(o,s)}),e._UZ(2,"am-icon",27),e.qZA(),e.TgZ(3,"button",26),e.NdJ("click",function(o){const s=e.CHM(t).$implicit;return e.oxw(2).onRecipeDeleteButtonClicked(o,s)}),e._UZ(4,"am-icon",27),e.qZA(),e.TgZ(5,"button",28),e.NdJ("click",function(o){const s=e.CHM(t).$implicit;return e.oxw(2).onRecipeDeployButtonClicked(o,s)}),e._UZ(6,"am-icon",29),e.qZA(),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("matTooltip","Edit recipe"),e.xp6(1),e.Q6J("iconClasses",t.icons.fontAwesome.PENCIL),e.xp6(1),e.Q6J("matTooltip","Delete recipe"),e.xp6(1),e.Q6J("iconClasses",t.icons.fontAwesome.TRASH),e.xp6(1),e.s9C("title",t.isConfigOk?null:"Missing configuration details"),e.Q6J("matTooltip","Build Image")("disabled",!t.isConfigOk),e.xp6(1),e.Q6J("iconClasses",t.icons.customIcons.DEPLOY)("ngClass",e.VKq(9,Vi,!t.isConfigOk))}}function Ei(i,a){1&i&&(e.TgZ(0,"th",21),e._uU(1," Image"),e.qZA())}function Yi(i,a){if(1&i&&(e.TgZ(0,"td",22),e.TgZ(1,"span",40),e._uU(2),e.qZA(),e.qZA()),2&i){const t=a.$implicit,n=e.oxw(4);e.xp6(1),e.ekj("strikethrough",t.status==n.imageStatus.NotExists),e.Q6J("matTooltip",t.imagePath),e.xp6(1),e.hij(" ",t.imageName," ")}}function Hi(i,a){1&i&&(e.TgZ(0,"th",21),e._uU(1," Creation date"),e.qZA())}function Wi(i,a){if(1&i&&(e.TgZ(0,"td",22),e._uU(1),e.ALo(2,"date"),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,t.creationDate,"medium")," ")}}function ji(i,a){1&i&&(e.TgZ(0,"th",21),e._uU(1," Status"),e.qZA())}function zi(i,a){1&i&&(e.TgZ(0,"span"),e._uU(1,"Loading"),e.qZA())}function Bi(i,a){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit,n=e.oxw(4);e.xp6(1),e.Oqu(n.imageStatus[t.status])}}function $i(i,a){if(1&i&&(e.TgZ(0,"td",22),e.YNc(1,zi,2,0,"span",41),e.YNc(2,Bi,2,1,"span",41),e.qZA()),2&i){const t=a.$implicit,n=e.oxw(4);e.xp6(1),e.Q6J("ngIf",null==t.status||t.status===n.imageStatus.Loading),e.xp6(1),e.Q6J("ngIf",null!=t.status&&t.status!==n.imageStatus.Loading)}}function Gi(i,a){1&i&&e._UZ(0,"th",21)}function Ki(i,a){if(1&i&&e._UZ(0,"am-icon",46),2&i){const t=e.oxw(5);e.Q6J("iconClasses",t.icons.fontAwesome.SPINNER)}}function Xi(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",47),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit,s=e.oxw(2).$implicit;return e.oxw(2).onImageDeleteButtonClicked(o,s,r)}),e._UZ(1,"am-icon",48),e.qZA()}if(2&i){const t=e.oxw(5);e.xp6(1),e.Q6J("iconClasses",t.icons.fontAwesome.TRASH)}}function eo(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",49),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit,s=e.oxw(2).$implicit;return e.oxw(2).onImageDeployButtonClicked(o,s,r)}),e._UZ(1,"am-icon",50),e.qZA()}if(2&i){const t=e.oxw(5);e.xp6(1),e.Q6J("iconClasses",t.icons.customIcons.DEPLOY)}}function to(i,a){if(1&i&&(e.TgZ(0,"td",22),e.TgZ(1,"div",42),e.YNc(2,Ki,1,1,"am-icon",43),e.YNc(3,Xi,2,1,"button",44),e.YNc(4,eo,2,1,"button",45),e.qZA(),e.qZA()),2&i){const t=a.$implicit,n=e.oxw(4);e.xp6(2),e.Q6J("ngIf",n.checkImageDeletionState(t)),e.xp6(1),e.Q6J("ngIf",!n.checkImageDeletionState(t)),e.xp6(1),e.Q6J("ngIf",!n.checkImageDeletionState(t))}}function no(i,a){1&i&&e._UZ(0,"tr",51)}function io(i,a){1&i&&e._UZ(0,"tr",52)}function oo(i,a){if(1&i&&(e.TgZ(0,"table",34,35),e.ynx(2,36),e.YNc(3,Ei,2,0,"th",8),e.YNc(4,Yi,3,4,"td",9),e.BQk(),e.ynx(5,37),e.YNc(6,Hi,2,0,"th",8),e.YNc(7,Wi,3,4,"td",9),e.BQk(),e.ynx(8,38),e.YNc(9,ji,2,0,"th",8),e.YNc(10,$i,3,2,"td",9),e.BQk(),e.ynx(11,14),e.YNc(12,Gi,1,0,"th",8),e.YNc(13,to,5,3,"td",9),e.BQk(),e.YNc(14,no,1,0,"tr",18),e.YNc(15,io,1,0,"tr",39),e.qZA()),2&i){const t=e.oxw().$implicit,n=e.oxw(2);e.Q6J("dataSource",t.images),e.xp6(14),e.Q6J("matHeaderRowDef",n.imageColumnsToDisplay),e.xp6(1),e.Q6J("matRowDefColumns",n.imageColumnsToDisplay)}}function ao(i,a){1&i&&(e.TgZ(0,"p",53),e._uU(1," The recipe doesn't have any associated images. "),e.qZA())}function ro(i,a){if(1&i&&(e.TgZ(0,"td",30),e.TgZ(1,"div",31),e.YNc(2,oo,16,3,"table",32),e.YNc(3,ao,2,0,"p",33),e.qZA(),e.qZA()),2&i){const t=a.$implicit,n=e.oxw(2);e.ekj("expanded-details-cell",null!=n.expandedRecipeId&&n.expandedRecipeId===t.id),e.uIk("colspan",n.columnsToDisplay.length),e.xp6(1),e.Q6J("@detailExpand",null!=n.expandedRecipeId&&n.expandedRecipeId===t.id?"expanded":"collapsed"),e.xp6(1),e.Q6J("ngIf",null!=t.images&&t.images.length>0),e.xp6(1),e.Q6J("ngIf",null==t.images||0===t.images.length)}}function so(i,a){1&i&&e._UZ(0,"tr",51)}function lo(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"tr",54),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).expandRow(r.id)}),e.qZA()}if(2&i){const t=a.$implicit,n=e.oxw(2);e.ekj("recipe-row-expanded",n.expandedRecipeId===t.id)}}function co(i,a){1&i&&e._UZ(0,"tr",55)}const mo=function(){return["expandedDetail"]};function po(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"table",5,6),e.NdJ("matSortChange",function(o){return e.CHM(t),e.oxw().sortData(o)}),e.ynx(2,7),e.YNc(3,Fi,1,0,"th",8),e.YNc(4,Oi,2,1,"td",9),e.BQk(),e.ynx(5,10),e.YNc(6,Pi,2,0,"th",11),e.YNc(7,Ni,2,1,"td",9),e.BQk(),e.ynx(8,12),e.YNc(9,qi,2,0,"th",11),e.YNc(10,Ui,2,1,"td",9),e.BQk(),e.ynx(11,13),e.YNc(12,Ri,2,0,"th",11),e.YNc(13,Ji,2,1,"td",9),e.BQk(),e.ynx(14,14),e.YNc(15,Qi,1,0,"th",8),e.YNc(16,Li,7,11,"td",15),e.BQk(),e.ynx(17,16),e.YNc(18,ro,4,6,"td",17),e.BQk(),e.YNc(19,so,1,0,"tr",18),e.YNc(20,lo,1,2,"tr",19),e.YNc(21,co,1,0,"tr",20),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("dataSource",t.recipeImagesDataSource),e.xp6(19),e.Q6J("matHeaderRowDef",t.columnsToDisplay),e.xp6(1),e.Q6J("matRowDefColumns",t.columnsToDisplay),e.xp6(1),e.Q6J("matRowDefColumns",e.DdM(4,mo))}}let uo=(()=>{class i{constructor(t,n,o,r,s,d,h,w,f){this.recipeImageService=t,this.dataRepositoryService=n,this.messageDialogService=o,this.recipeService=r,this.imageManagementHttpService=s,this.messagingService=d,this.router=h,this.hotkeysService=w,this.imageSubject=f,this.recipeImagesDataSource=new m.by([]),this.columnsToDisplay=["caret","recipeName","recipeDescription","imageCount","actions"],this.imageColumnsToDisplay=["imageName","creationDate","actions"],this.imageStatus=le,this.subscription=new I.w,this.icons=_.R.icons,this.imageDeletionStates=[]}get recipeTableDescription(){return this.recipeImagesDataSource.data?1===this.recipeImagesDataSource.data.length?` ${this.recipeImagesDataSource.data.length} recipe `:` ${this.recipeImagesDataSource.data.length} recipes `:""}ngOnInit(){this.subscription.add(this.imageSubject.configurationLoaded.subscribe(n=>{null!=n&&n!==this.imageSubject.emptyGlobalConfiguration&&(this.isConfigOk=this.imageSubject.checkInitialConfiguration(n,!0))})),this.isLoading=!0;const t=this.recipeService.recipes.pipe((0,V.h)(n=>null!=n),(0,Je.w)(n=>(0,bi.of)(n.map(o=>o))));this.subscription.add(t.subscribe(n=>{this.isLoading=!1,this.recipeImagesDataSource.data=n,this.sortData({active:"recipeName",direction:"asc"})},()=>{this.isLoading=!1})),this.subscription.add((0,Ce.$R)(t,this.dataRepositoryService.currentEnvironmentSubject.pipe((0,V.h)(n=>null!=n),(0,Je.w)(n=>(this.environmentId=n.id,this.recipeService.recipes.pipe((0,V.h)(o=>null!=o)),this.recipeImageService.getAllRecipeImages(n.id))))).subscribe(n=>{const o=n[0],r=n[1];for(let s=0;s<o.length;s++){let d=r.find(h=>h.id===o[s].id);null!=d&&(o[s].images=d.images)}r.forEach(s=>s.images.forEach(d=>this.imageDeletionStates.push(new Si(d.imageName,!1)))),this.recipeImageService.getRecipeImagesStatus(this.environmentId).subscribe(s=>{for(let d of s){let h=r.find(w=>w.id===d.recipeId);for(let w of d.imageStatuses){const f=h.images.find(te=>te.imagePath.toUpperCase()===w.imagePath.toUpperCase());null!=f&&(f.status=w.imageStatus)}}})})),this.setupNewRecipeAction(),this.hotkeysService.remove(this.hotkeysService.hotkeys.filter(n=>"?"!==n.combo[0])),this.hotkeysService.add(new A.qm("alt+n",()=>(null!=this.environmentId&&!O.c.isEmpty(this.environmentId)&&this.navigateToNewRecipePage(),!1),[],"Add a new recipe"))}setupNewRecipeAction(){this.newRecipeAction=new pe.r,this.newRecipeAction.description="Add a new recipe",this.newRecipeAction.title="Add a new recipe",this.newRecipeAction.tooltipTitle="Add a new recipe",this.newRecipeAction.icon=this.icons.fontAwesome.PLUS,this.newRecipeAction.action=()=>{null==this.environmentId||O.c.isEmpty(this.environmentId)?this.messagingService.sendInfoMessage("Please select an environment first"):this.navigateToNewRecipePage()}}navigateToNewRecipePage(){this.router.navigate([v.l.getRecipeUrl(O.c.Empty)])}expandRow(t){this.expandedRecipeId=this.expandedRecipeId===t?null:t}onRecipeEditButtonClicked(t,n){t.stopPropagation(),this.router.navigate([`/${v.l.imageManagementPath}/${v.l.recipesPath}/${n.id}`])}onRecipeDeleteButtonClicked(t,n){t.stopPropagation(),this.messageDialogService.openConfirmationDialog(`Do you want to delete "${n.name}" recipe?`).subscribe(o=>{"Confirmed"===o&&this.imageManagementHttpService.deleteCollection(this.environmentId,n.id).subscribe(r=>{if(r){this.messagingService.sendInfoMessage(`Recipe ${n.name} has been deleted.`);const s=this.recipeImagesDataSource.data.findIndex(d=>d.id===n.id);this.recipeImagesDataSource.data.splice(s,1),this.recipeTable.renderRows(),this.recipeService.removeRecipeFromList(n.id)}},r=>{console.log(r)})})}onRecipeDeployButtonClicked(t,n){t.stopPropagation(),this.messageDialogService.openConfirmationDialog(`Do you want to deploy "${n.name}" recipe?`).subscribe(o=>{"Confirmed"===o&&this.recipeService.startDeployment(n,this.environmentId)})}onImageDeleteButtonClicked(t,n,o){t.stopPropagation(),this.messageDialogService.openConfirmationDialog(`Do you want to delete "${o.imageName}" image?`,`Delete "${o.imageName}" file`).subscribe(r=>{"Confirmed"===r.confirmed&&(this.imageDeletionStates.find(s=>s.imageName=o.imageName).state=!0,this.imageManagementHttpService.deleteImage(o,r.checkboxChecked).subscribe(()=>{const s=n.images.findIndex(h=>h===o);s>=0&&n.images.splice(s,1),this.imagesTable.renderRows();const d=this.imageDeletionStates.findIndex(h=>h.imageName===o.imageName);d>=0&&this.imageDeletionStates.splice(d,1)}))})}checkImageDeletionState(t){let n=this.imageDeletionStates.find(o=>o.imageName===t.imageName);if(null!=n)return n.state}onImageDeployButtonClicked(t,n,o){t.stopPropagation();const r=new Ai;r.id=n.id,r.name=n.name,r.imageName=o.imageName,this.deployImageFromDisk(r)}deployImageFromDisk(t){this.messageDialogService.openConfirmationDialog(`Do you want to deploy "${t.name}" recipe using "${t.imageName}" image?`).subscribe(n=>{"Confirmed"===n&&this.recipeService.startDeployment(t,this.environmentId)})}sortData(t){const n=[...this.recipeImagesDataSource.data.slice()];if(!t.active||""===t.direction)return void(this.recipeImagesDataSource.data=n);const o="asc"===t.direction;this.recipeImagesDataSource.data=n.sort((r,s)=>{switch(t.active){case"recipeName":return(0,x.qu)(r.name,s.name,o);case"recipeDescription":return(0,x.qu)(r.description??"",s.description??"",o);case"imageCount":return(0,x.WQ)(null==r.images?0:r.images.length,null==s.images?0:s.images.length,o);default:return 0}})}ngOnDestroy(){this.subscription.unsubscribe(),this.hotkeysService.remove(this.hotkeysService.hotkeys.filter(t=>"?"!==t.combo[0]))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Di),e.Y36(H.Y),e.Y36(me.T),e.Y36(Z.Y),e.Y36(X.f),e.Y36(R.w),e.Y36(b.F0),e.Y36(A.tm),e.Y36(Z.Y))},i.\u0275cmp=e.Xpm({type:i,selectors:[["am-images"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Ii,5),e.Gf(ki,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.recipeTable=o.first),e.iGM(o=e.CRH())&&(n.imagesTable=o.first)}},decls:5,vars:4,consts:[[1,"mat-elevation-z1"],["title","Recipes",3,"action","description"],["loadingText","Loading recipes...",3,"loading"],["class","recipe-table","mat-table","","matSort","","multiTemplateDataRows","",3,"dataSource","matSortChange",4,"ngIf"],[1,"table-pre-footer"],["mat-table","","matSort","","multiTemplateDataRows","",1,"recipe-table",3,"dataSource","matSortChange"],["recipeTable",""],["matColumnDef","caret"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","recipeName"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","recipeDescription"],["matColumnDef","imageCount"],["matColumnDef","actions"],["class","align-right","mat-cell","",4,"matCellDef"],["matColumnDef","expandedDetail"],["class","details-cell","mat-cell","",3,"expanded-details-cell",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","recipe-row","mat-row","",3,"recipe-row-expanded","click",4,"matRowDef","matRowDefColumns"],["class","images-row","mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"expanded"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"align-right"],["mat-icon-button","",3,"matTooltip","click"],[3,"iconClasses"],["mat-icon-button","",1,"img-deploy-button","float-right",3,"title","matTooltip","disabled","click"],[3,"iconClasses","ngClass"],["mat-cell","",1,"details-cell"],[1,"recipe-images"],["class","images-table","mat-table","","multiTemplateDataRows","",3,"dataSource",4,"ngIf"],["class","cell-message",4,"ngIf"],["mat-table","","multiTemplateDataRows","",1,"images-table",3,"dataSource"],["imagesTable",""],["matColumnDef","imageName"],["matColumnDef","creationDate"],["matColumnDef","status"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"matTooltip"],[4,"ngIf"],[1,"float-right"],["class","spinner",3,"iconClasses",4,"ngIf"],["class","img-delete-button","mat-button","",3,"click",4,"ngIf"],["class","img-deploy-button","mat-button","",3,"click",4,"ngIf"],[1,"spinner",3,"iconClasses"],["mat-button","",1,"img-delete-button",3,"click"],["title","Delete Image",3,"iconClasses"],["mat-button","",1,"img-deploy-button",3,"click"],["title","Build Image",3,"iconClasses"],["mat-header-row",""],["mat-row",""],[1,"cell-message"],["mat-row","",1,"recipe-row",3,"click"],["mat-row","",1,"images-row"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"table-header",1),e._UZ(2,"loading-container",2),e.YNc(3,po,22,5,"table",3),e._UZ(4,"div",4),e.qZA()),2&t&&(e.xp6(1),e.Q6J("action",n.newRecipeAction)("description",n.recipeTableDescription),e.xp6(1),e.Q6J("loading",n.isLoading),e.xp6(1),e.Q6J("ngIf",!n.isLoading))},directives:[Qe.a,ee.o,u.O5,m.BZ,y.YE,m.w1,m.fO,m.ge,m.Dz,m.ev,q,y.nU,D.lW,k.gM,S.b,u.mk,m.as,m.XQ,m.nj,m.Gk],pipes:[u.uU],styles:["table[_ngcontent-%COMP%]{width:100%;border-collapse:separate}table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{font-size:13px}.recipe-table[_ngcontent-%COMP%]{border-left:none;border-right:none}.recipe-images[_ngcontent-%COMP%]{display:flex;overflow:hidden}tr.images-row[_ngcontent-%COMP%]{height:0}.strikethrough[_ngcontent-%COMP%]{text-decoration:line-through}.image-loading[_ngcontent-%COMP%]{color:#b9b9b9}.images-table[_ngcontent-%COMP%]{width:100%;margin:1em 0}tr.recipe-row-expanded[_ngcontent-%COMP%]{background-color:#eee}.details-cell[_ngcontent-%COMP%]{border-bottom-width:0;border-bottom-color:#d1d1d1}td.expanded-details-cell[_ngcontent-%COMP%]{border-bottom-width:1px}tr.recipe-row[_ngcontent-%COMP%]{cursor:pointer}tr.recipe-row[_ngcontent-%COMP%]:not(.recipe-row-expanded):hover{background:whitesmoke}tr.recipe-element-row[_ngcontent-%COMP%]:not(.recipe-row-expanded):active{background:#efefef}p.cell-message[_ngcontent-%COMP%]{padding:1em .5em 0;font-style:italic}.mat-row[_ngcontent-%COMP%]   .mat-column-caret[_ngcontent-%COMP%], .mat-header-row[_ngcontent-%COMP%]   .mat-column-caret[_ngcontent-%COMP%]{width:35px;padding-left:20px}.mat-row[_ngcontent-%COMP%]   .mat-column-recipeName[_ngcontent-%COMP%], .mat-header-row[_ngcontent-%COMP%]   .mat-column-recipeName[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%]   .mat-column-recipeDescription[_ngcontent-%COMP%], .mat-header-row[_ngcontent-%COMP%]   .mat-column-recipeDescription[_ngcontent-%COMP%]{width:30%}.mat-row[_ngcontent-%COMP%]   .mat-column-imageCount[_ngcontent-%COMP%], .mat-header-row[_ngcontent-%COMP%]   .mat-column-imageCount[_ngcontent-%COMP%]{width:12%}.mat-row[_ngcontent-%COMP%]   .mat-column-imageName[_ngcontent-%COMP%], .mat-header-row[_ngcontent-%COMP%]   .mat-column-imageName[_ngcontent-%COMP%]{width:40%;padding-left:24px}.mat-row[_ngcontent-%COMP%]   .mat-column-creationDate[_ngcontent-%COMP%], .mat-header-row[_ngcontent-%COMP%]   .mat-column-creationDate[_ngcontent-%COMP%]{width:40%}.mat-row[_ngcontent-%COMP%]   .mat-column-actions[_ngcontent-%COMP%], .mat-header-row[_ngcontent-%COMP%]   .mat-column-actions[_ngcontent-%COMP%]{flex:20%;padding-right:14px}.img-delete-button[_ngcontent-%COMP%]{outline:none}.spinner[_ngcontent-%COMP%]{padding:0 15px}.mat-icon-button[_ngcontent-%COMP%]{outline:none}.img-deploy-button[_ngcontent-%COMP%]   am-icon[_ngcontent-%COMP%]{width:21px;height:24px;line-height:17px}.disabled-icon[_ngcontent-%COMP%]{color:#00000042}"],data:{animation:[(0,F.X$)("detailExpand",[(0,F.SB)("collapsed, void",(0,F.oB)({height:"0px",minHeight:"0"})),(0,F.SB)("expanded",(0,F.oB)({height:"*"})),(0,F.eR)("expanded <=> collapsed",(0,F.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)")),(0,F.eR)("expanded <=> void",(0,F.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),i})();var go=c(28588),T=c(97315),Q=c(89526),ho=c(72285),Co=c(53913),fo=c(64234);function _o(i,a){1&i&&(e.TgZ(0,"div"),e._UZ(1,"img",10),e.qZA())}function vo(i,a){1&i&&(e.TgZ(0,"div"),e._UZ(1,"img",11),e.qZA())}function Mo(i,a){1&i&&(e.TgZ(0,"div"),e._UZ(1,"img",12),e.qZA())}function wo(i,a){1&i&&(e.TgZ(0,"div"),e._uU(1," \xa0 "),e.qZA())}function Zo(i,a){1&i&&(e.TgZ(0,"span"),e._UZ(1,"img",13),e.qZA())}function To(i,a){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.message," ")}}function yo(i,a){if(1&i&&(e.TgZ(0,"tr",5),e.TgZ(1,"td",1),e.TgZ(2,"div",6),e.TgZ(3,"div",7),e.YNc(4,_o,2,0,"div",8),e.YNc(5,vo,2,0,"div",8),e.YNc(6,Mo,2,0,"div",8),e.YNc(7,wo,2,0,"div",8),e.qZA(),e.TgZ(8,"span",9),e._uU(9),e.qZA(),e.qZA(),e.qZA(),e.TgZ(10,"td",2),e._uU(11),e.YNc(12,Zo,2,0,"span",8),e.YNc(13,To,2,1,"span",8),e.qZA(),e.TgZ(14,"td",3),e._uU(15),e.ALo(16,"duration"),e.qZA(),e.qZA()),2&i){const t=a.$implicit,n=e.oxw();e.s9C("matTooltip",n.getMessage(t)),e.xp6(4),e.Q6J("ngIf",t.status==n.notificationStatusEnum.Started),e.xp6(1),e.Q6J("ngIf",t.status==n.notificationStatusEnum.Succeeded),e.xp6(1),e.Q6J("ngIf",t.status==n.notificationStatusEnum.Failed),e.xp6(1),e.Q6J("ngIf",t.status==n.notificationStatusEnum.Unstarted),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.hij(" ",t.taskStatus," "),e.xp6(1),e.Q6J("ngIf",t.status==n.notificationStatusEnum.Failed),e.xp6(1),e.Q6J("ngIf",t.status==n.notificationStatusEnum.Started),e.xp6(2),e.hij(" ",e.xi3(16,10,t,t)," ")}}let xo=(()=>{class i{constructor(){this.notificationStatusEnum=T.I,this.icons=_.R.icons}ngOnInit(){}getMessage(t){return 3===t?.status?t.message:""}onClick(t){t.stopPropagation()}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["deployment-tasks"]],hostBindings:function(t,n){1&t&&e.NdJ("click",function(r){return n.onClick(r)})},inputs:{tasks:"tasks"},decls:9,vars:1,consts:[[1,"header-row"],[1,"column-taskName"],[1,"column-taskStatus"],[1,"column-duration"],["class","task-row",3,"matTooltip",4,"ngFor","ngForOf"],[1,"task-row",3,"matTooltip"],[1,"flex-layout"],[1,"status"],[4,"ngIf"],[1,"name"],["src","assets/images/icons/spinner.svg",1,"fa-spin"],["src","assets/images/icons/check.svg"],["src","assets/images/icons/times-circle.svg"],["src","assets/images/icons/exclamation-triangle.svg"]],template:function(t,n){1&t&&(e.TgZ(0,"table"),e.TgZ(1,"tr",0),e.TgZ(2,"th",1),e._uU(3,"Task name"),e.qZA(),e.TgZ(4,"th",2),e._uU(5,"Task status"),e.qZA(),e.TgZ(6,"th",3),e._uU(7,"Duration"),e.qZA(),e.qZA(),e.YNc(8,yo,17,13,"tr",4),e.qZA()),2&t&&(e.xp6(8),e.Q6J("ngForOf",n.tasks))},directives:[u.sg,k.gM,u.O5],pipes:[fo.u],styles:["table[_ngcontent-%COMP%]{margin-top:10px;width:100%;border:0}.header-row[_ngcontent-%COMP%]{color:#626263;font-size:.8rem}.header-row[_ngcontent-%COMP%]   .column-taskName[_ngcontent-%COMP%]{width:39%;padding:0 24px}.header-row[_ngcontent-%COMP%]   .column-taskStatus[_ngcontent-%COMP%]{width:28%;padding:0 24px}.header-row[_ngcontent-%COMP%]   .column-duration[_ngcontent-%COMP%]{width:30%;padding:0 24px}.task-row[_ngcontent-%COMP%]:nth-child(odd){background-color:#fbfbfb}.task-row[_ngcontent-%COMP%]{background-color:#fff;height:30px;font-size:.8rem}.task-row[_ngcontent-%COMP%]   .column-taskName[_ngcontent-%COMP%]{width:39%;padding:0 24px;border:1px solid;border-color:#d1d1d1}.task-row[_ngcontent-%COMP%]   .column-taskName[_ngcontent-%COMP%]   .flex-layout[_ngcontent-%COMP%]{display:flex}.task-row[_ngcontent-%COMP%]   .column-taskName[_ngcontent-%COMP%]   .flex-layout[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{font-size:18px;width:8%}.task-row[_ngcontent-%COMP%]   .column-taskName[_ngcontent-%COMP%]   .flex-layout[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{padding-left:10px}.task-row[_ngcontent-%COMP%]   .column-taskStatus[_ngcontent-%COMP%]{width:28%;padding:0 24px;border:1px solid;border-color:#d1d1d1}.task-row[_ngcontent-%COMP%]   .column-duration[_ngcontent-%COMP%]{width:30%;padding:0 24px;border:1px solid;border-color:#d1d1d1;border-right:none}img[_ngcontent-%COMP%]{margin-bottom:2.5px;width:14px}"]}),i})();function bo(i,a){1&i&&(e.TgZ(0,"div"),e._UZ(1,"img",10),e.qZA())}function Ao(i,a){1&i&&(e.TgZ(0,"div"),e._UZ(1,"img",11),e.qZA())}function So(i,a){1&i&&(e.TgZ(0,"div"),e._UZ(1,"img",12),e.qZA())}function Do(i,a){1&i&&(e.TgZ(0,"div"),e._UZ(1,"img",13),e.qZA())}function Io(i,a){1&i&&(e.TgZ(0,"div"),e._UZ(1,"img",14),e.qZA())}function ko(i,a){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.deployment.name," ")}}function Fo(i,a){1&i&&(e.TgZ(0,"span"),e._uU(1," \xa0 "),e.qZA())}function Oo(i,a){if(1&i&&(e.TgZ(0,"span"),e.TgZ(1,"span",15),e._uU(2),e.ALo(3,"date"),e.qZA(),e._UZ(4,"br"),e.TgZ(5,"span",16),e._uU(6),e.ALo(7,"date"),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(e.xi3(3,2,t.deployment.startTime,"dd/MM/yy")),e.xp6(4),e.Oqu(e.xi3(7,5,t.deployment.startTime,"hh:mm:ss"))}}function Po(i,a){1&i&&(e.TgZ(0,"span"),e._uU(1," \xa0\xa0\xa0 "),e.qZA())}let No=(()=>{class i{constructor(){this.onDelete=new e.vpe,this.notificationStatusEnum=T.I,this.icons=_.R.icons.fontAwesome}ngOnInit(){this.initialized||(this.initialized=!0)}get isDeploymentTaskQueued(){const t=this.deployment.tasks.find(n=>n.Key===Q.S.WAIT_IN_QUEUE);return this.deployment.status===T.I.Unstarted&&null!=t&&null!=t.startTime&&null==t.finishTime}onDeleteDeploymentClick(t,n){n.stopPropagation(),this.onDelete&&this.onDelete.emit(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["image-deployment"]],inputs:{deployment:"deployment"},outputs:{onDelete:"onDelete"},decls:20,vars:13,consts:[["hideToggle","","xmlns","http://www.w3.org/1999/html",1,"mat-elevation-z0"],[1,"status"],[4,"ngIf"],[1,"taskName"],[1,"completedTasks"],[1,"startTime"],[1,"action"],["mat-button","",3,"click"],["title","Delete deployment",3,"iconClasses"],[3,"tasks"],["src","assets/images/icons/spinner.svg",1,"fa-spin"],["src","assets/images/icons/check.svg"],["src","assets/images/icons/times-circle.svg"],["src","assets/images/icons/clock.svg"],["src","assets/images/icons/times-circle-dark.svg"],[1,"start-date"],[1,"start-time"]],template:function(t,n){1&t&&(e.TgZ(0,"mat-expansion-panel",0),e.TgZ(1,"mat-expansion-panel-header"),e.TgZ(2,"div",1),e.YNc(3,bo,2,0,"div",2),e.YNc(4,Ao,2,0,"div",2),e.YNc(5,So,2,0,"div",2),e.YNc(6,Do,2,0,"div",2),e.YNc(7,Io,2,0,"div",2),e.qZA(),e.TgZ(8,"div",3),e.YNc(9,ko,2,1,"span",2),e.YNc(10,Fo,2,0,"span",2),e.qZA(),e.TgZ(11,"span",4),e._uU(12),e.qZA(),e.TgZ(13,"div",5),e.YNc(14,Oo,8,8,"span",2),e.YNc(15,Po,2,0,"span",2),e.qZA(),e.TgZ(16,"div",6),e.TgZ(17,"button",7),e.NdJ("click",function(r){return n.onDeleteDeploymentClick(n.deployment,r)}),e._UZ(18,"am-icon",8),e.qZA(),e.qZA(),e.qZA(),e._UZ(19,"deployment-tasks",9),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",n.deployment.status==n.notificationStatusEnum.Started),e.xp6(1),e.Q6J("ngIf",n.deployment.status==n.notificationStatusEnum.Succeeded),e.xp6(1),e.Q6J("ngIf",n.deployment.status==n.notificationStatusEnum.Failed),e.xp6(1),e.Q6J("ngIf",n.deployment.status==n.notificationStatusEnum.Unstarted&&n.isDeploymentTaskQueued),e.xp6(1),e.Q6J("ngIf",n.deployment.status==n.notificationStatusEnum.Unstarted&&!n.isDeploymentTaskQueued),e.xp6(2),e.Q6J("ngIf",n.deployment.name),e.xp6(1),e.Q6J("ngIf",!n.deployment.name),e.xp6(2),e.AsE(" ",n.deployment.CompletedTasks,"/",n.deployment.TotalTasks," "),e.xp6(2),e.Q6J("ngIf",n.deployment.startTime),e.xp6(1),e.Q6J("ngIf",!n.deployment.startTime),e.xp6(3),e.Q6J("iconClasses",n.icons.TRASH),e.xp6(1),e.Q6J("tasks",n.deployment.tasks))},directives:[C.ib,C.yz,u.O5,D.lW,S.b,xo],pipes:[u.uU],styles:["mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]{display:inline;line-height:48px;padding:0}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{font-size:18px;width:5%;padding:0 15px 0 24px}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .taskName[_ngcontent-%COMP%]{width:37%;padding:0 24px 0 1%;border-right:1px solid;border-color:#d1d1d1}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .completedTasks[_ngcontent-%COMP%]{width:28%;padding:0 24px;border-right:1px solid;border-color:#d1d1d1}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .startTime[_ngcontent-%COMP%]{width:20%;line-height:20px;padding:0 24px}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{width:10%;padding:0 12px}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{outline:none;min-width:initial;margin:0 auto}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]   am-icon[_ngcontent-%COMP%]{color:#616161}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .taskName[_ngcontent-%COMP%], mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .completedTasks[_ngcontent-%COMP%], mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .startTime[_ngcontent-%COMP%], mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{display:flex;font-size:.8rem;height:48px;align-items:center}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-bottom:3px;width:17px}"]}),i})();function qo(i,a){1&i&&(e.TgZ(0,"div",7),e._uU(1," You haven't built any images yet\n"),e.qZA())}function Uo(i,a){1&i&&(e.TgZ(0,"table",8),e.TgZ(1,"tr",9),e.TgZ(2,"th",10),e._uU(3,"Queue"),e.qZA(),e.TgZ(4,"th",11),e._uU(5,"Completed tasks"),e.qZA(),e.TgZ(6,"th",12),e._uU(7,"Start time"),e.qZA(),e.qZA(),e.qZA())}function Ro(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"li",13),e.NdJ("click",function(o){const s=e.CHM(t).$implicit;return e.oxw().deploymentDetailsClick.next({evt:o,deployment:s})}),e.TgZ(1,"image-deployment",14),e.NdJ("onDelete",function(o){return e.CHM(t),e.oxw().onDeleteDeploymentConfirmed(o)}),e.qZA(),e.qZA()}if(2&i){const t=a.$implicit;e.xp6(1),e.Q6J("deployment",t)}}const Qo=[{path:"",pathMatch:"full",redirectTo:v.l.recipesPath},{path:"",component:ze,children:[{path:v.l.recipesPath,canActivate:[ie.q],component:uo},{path:v.l.configurationPath,canActivate:[ie.q],component:xi,canDeactivate:[he.I]},{path:v.l.buildsPath,canActivate:[ie.q],component:(()=>{class i{constructor(t,n,o,r,s,d,h,w,f){this.changeDetector=t,this.imageManagementHttpService=n,this.messagingService=o,this.messageDialogService=r,this.imageSubject=s,this.imageDeploymentService=d,this.dataRepositoryService=h,this.reconnectService=w,this.hotkeysService=f,this.deployments=[],this.icons=_.R.icons.fontAwesome,this.deploymentDetailsClick=new p.xQ,this.connectionLost="Connection to server was lost",this.inactiveDeploymentsCount=0}ngOnInit(){this.isLoading=!0,this.getDeployments(),this.hotkeysService.remove(this.hotkeysService.hotkeys.filter(t=>"?"!==t.combo[0])),this.reconnectService.reconnectMessage.subscribe(t=>{"Connection lost"===t&&this.deployments.forEach(n=>{n.status!==T.I.Succeeded&&(n.status=T.I.Failed,n.tasks.forEach(o=>{o.status===T.I.Started&&(o.status=T.I.Failed,o.message=this.connectionLost,o.taskStatus=this.connectionLost)}))})})}getDeployments(){this.deployments=[],this.imageDeploymentService.getDeployments().pipe((0,fe.U)(t=>this.newImageDeploymentModel(t))).subscribe(t=>{this.deployments.unshift(t)},()=>{this.isLoading=!1},()=>{this.receiveDeployments(),this.sortDeploymentsByStartTime(),this.setupDeleteAllDeplymentsAction(),this.isLoading=!1})}setupDeleteAllDeplymentsAction(){this.inactiveDeploymentsCount=this.getInactiveDeploymentsCount(),this.deployments.length>0&&(this.deleteAllDeplymentsAction=new pe.r,this.deleteAllDeplymentsAction.isDisabled=!1,this.deleteAllDeplymentsAction.icon=this.icons.TRASH,this.deleteAllDeplymentsAction.title="Clear inactive build logs",this.deleteAllDeplymentsAction.tooltipTitle="Clear inactive build logs",this.inactiveDeploymentsCount>0?this.deleteAllDeplymentsAction.action=()=>{this.onDeleteAllDeploymentsConfirmed()}:(this.deleteAllDeplymentsAction.action=()=>{},this.deleteAllDeplymentsAction.tooltipTitle="All builds are active"))}getInactiveDeploymentsCount(){let t=new Array;return t=[],this.deployments.forEach(n=>{n.status!==T.I.Started&&t.push(n.id)}),t.length}onDeleteAllDeploymentsConfirmed(){this.messageDialogService.openConfirmationDialog("Do you want to delete all inactive build logs?").pipe((0,G.b)(300)).pipe((0,B.x)()).subscribe(t=>{"Confirmed"===t&&this.inactiveDeploymentsCount>0&&(this.deleteAllDeplymentsAction.isDisabled=!0,this.imageManagementHttpService.deleteMultipleDeployments(this.dataRepositoryService.currentEnvironmentId).subscribe(()=>{this.getDeployments(),this.deleteAllDeplymentsAction=null,this.setupDeleteAllDeplymentsAction()}))})}ngAfterViewInit(){}onDeleteDeploymentConfirmed(t){this.messageDialogService.openConfirmationDialog(`Do you want to delete "${t.name}" build log?`).pipe((0,G.b)(300)).pipe((0,B.x)()).subscribe(n=>{"Confirmed"===n&&this.imageManagementHttpService.deleteDeployment(this.dataRepositoryService.currentEnvironmentId,t.id).subscribe(o=>{o&&(this.deployments.splice(this.deployments.indexOf(t),1),this.messagingService.sendInfoMessage(`Deployment ${t.name} has been deleted.`),this.imageDeploymentService.expandDeployment(t.id,!1),this.deleteAllDeplymentsAction=null,this.setupDeleteAllDeplymentsAction())},o=>{console.log(o)})})}newImageDeploymentModel(t){const n=new go.c(t.recipeName,t.taskId);return n.startTime=t.startingTime,n.status=t.state,[Q.S.COPY_VIRTUAL_DISK_TASK,Q.S.MOVE_VIRTUAL_DISK_TASK,Q.S.CREATE_VM_SNAPSHOT_TASK,Q.S.DETACH_VIRTUAL_DISK_FROM_VM_TASK,Q.S.DELETE_VM_TASK,Q.S.CONVERT_VM_TO_TEMPLATE].forEach(r=>{if(!(r in t.tasks)){const s=n.tasks.findIndex(d=>d.Key===r);-1!==s&&n.tasks.splice(s,1)}}),this.wireUpDeployments(n,t),n.detailed=this.imageDeploymentService.isDeploymentExpanded(n.id),n}wireUpDeployments(t,n){Object.keys(n.tasks).forEach(r=>{const s=t.tasks.findIndex(te=>te.Key===r),d=n.tasks[r],h=d.text?d.text:"",w=d.details?d.details:"",f=t.tasks[s];s>=0&&(d.completed&&(f.taskStatus="done"),f.status=T.I.Unstarted,f.message=h+" "+w,d.completed&&d.progress>=100&&(f.status=T.I.Succeeded),(null!=d.startingTime&&null==d.finishingTime||!d.completed&&d.progress>0&&d.progress<100)&&(f.status=T.I.Started),d.failed&&(f.status=T.I.Failed,f.message=w,f.taskStatus="failed"),d.startingTime&&(f.startTime=d.startingTime),d.finishingTime&&(f.finishTime=d.finishingTime))})}receiveDeployments(){this.imageDeploymentService.receiveDeployments(this.dataRepositoryService.currentEnvironmentId).subscribe(t=>{const n=this.newImageDeploymentModel(t),o=this.deployments.find(r=>r.id===t.taskId);if(null==o&&t.state!==T.I.Canceled)this.deployments.unshift(n);else if(t.state===T.I.Canceled){const r=this.deployments.findIndex(s=>s.id===t.taskId);-1!==r&&this.deployments.splice(r,1)}else o.name=n.name,o.startTime=n.startTime,o.finishTime=n.finishTime,o.status=n.status,o.taskId=n.taskId,o.tasks=n.tasks,this.wireUpDeployments(n,t);this.sortDeploymentsByStartTime()})}sortDeploymentsByStartTime(){this.deployments=this.deployments.sort((t,n)=>new Date(n.startTime).getTime()-new Date(t.startTime).getTime())}ngOnDestroy(){this.deploymentDetailsSubscription&&this.deploymentDetailsSubscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.sBO),e.Y36(X.f),e.Y36(R.w),e.Y36(me.T),e.Y36(Z.Y),e.Y36(ho.o),e.Y36(H.Y),e.Y36(Co.h),e.Y36(A.tm))},i.\u0275cmp=e.Xpm({type:i,selectors:[["image-deployments"]],decls:8,vars:6,consts:[[3,"action","title"],[3,"loading"],["class","pt-4 pl-2 mb-0",4,"ngIf"],["class","dashboard-table",4,"ngIf"],[1,"list-group","list-group-flush","outer"],["class","list-group-item head pl-0 pr-0 pt-0 pb-0 pointer ",3,"click",4,"ngFor","ngForOf"],[1,"pre-footer","mb-1","mt-1","pt-1","pb-0","pl-2","pr-2"],[1,"pt-4","pl-2","mb-0"],[1,"dashboard-table"],[1,"header-row"],[1,"column-id"],[1,"column-completedTasks"],[1,"column-startTime"],[1,"list-group-item","head","pl-0","pr-0","pt-0","pb-0","pointer",3,"click"],[3,"deployment","onDelete"]],template:function(t,n){1&t&&(e._UZ(0,"table-header",0),e._UZ(1,"loading-container",1),e.YNc(2,qo,2,0,"div",2),e.YNc(3,Uo,8,0,"table",3),e.TgZ(4,"ul",4),e.YNc(5,Ro,2,1,"li",5),e.qZA(),e.TgZ(6,"p",6),e._uU(7,"\xa0\n"),e.qZA()),2&t&&(e.Q6J("action",n.deleteAllDeplymentsAction)("title","BUILD LOGS"),e.xp6(1),e.Q6J("loading",n.isLoading),e.xp6(1),e.Q6J("ngIf",!(n.isLoading||n.deployments&&0!=n.deployments.length)),e.xp6(1),e.Q6J("ngIf",n.deployments&&n.deployments.length>0),e.xp6(2),e.Q6J("ngForOf",n.deployments))},directives:[Qe.a,ee.o,u.O5,u.sg,No],styles:["table[_ngcontent-%COMP%]{width:100%;border:1px solid #d1d1d1}.header-row[_ngcontent-%COMP%]{color:#626263;font-size:.83rem}.header-row[_ngcontent-%COMP%]   .column-id[_ngcontent-%COMP%]{width:27.5%;padding:0 24px}.header-row[_ngcontent-%COMP%]   .column-completedTasks[_ngcontent-%COMP%]{width:18.5%;padding:0 24px}.header-row[_ngcontent-%COMP%]   .column-startTime[_ngcontent-%COMP%]{width:20%;padding:0 24px}.list-group-item.head[_ngcontent-%COMP%]:nth-child(odd){background-color:#fbfbfb}.list-group-item[_ngcontent-%COMP%]:first-child{border-top:none!important}.list-group-item[_ngcontent-%COMP%] > .row[_ngcontent-%COMP%]{line-height:42px;vertical-align:middle}.list-group.outer[_ngcontent-%COMP%]{border-right:1px solid rgba(0,0,0,.12);border-left:1px solid rgba(0,0,0,.12)}"]}),i})()}]},{path:`${v.l.recipesPath}/:id`,component:En,canActivate:[ie.q],canDeactivate:[he.I]}];let Vo=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[b.Bz.forChild(Qo)],b.Bz]}),i})(),Lo=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[u.ez,Ve.U,Le.b,Ee.q,l.u5,l.UX,Vo,re.Xd]]}),i})()}}]);